<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"><meta charset="utf-8">
<meta name="pluto-insertion-spot-meta">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#2a2928"><meta name="color-scheme" content="light dark"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/favicon-16x16.267aebbe.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/favicon-32x32.1b9d3e70.png"><link rel="icon" type="image/png" sizes="96x96" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/favicon-96x96.26e08763.png"><link rel="pluto-external-source" id="pluto-logo-big" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/logo.49a14041.svg"><link rel="pluto-external-source" id="pluto-logo-small" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/favicon_unsaturated.c11d4d33.svg"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.f5de63b3.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.69b60e77.css"><script type="module" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/index.183d291c.js"></script><script type="module" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.runtime.2bebe4ef.js"></script><script defer>console.log("Pluto.jl, by Fons van der Plas (https://github.com/fonsp), Miko≈Çaj Bochenski (https://github.com/malyvsen), Michiel Dral (https://github.com/dralletje) and friends \uD83C\uDF08");</script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.21e3b1fd.js" defer></script><link rel="pluto-external-source" id="vmsg-wasm" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/vmsg.56bb9389.wasm"><link rel="pluto-external-source" id="arrow_up_circle_icon" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/arrow-up-circle-outline.3f146ffe.svg"><link rel="pluto-external-source" id="document_text_icon" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/document-text-outline.8d1e2333.svg"><link rel="pluto-external-source" id="help_circle_icon" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/help-circle-outline.a023036a.svg"><link rel="pluto-external-source" id="open_icon" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/open-outline.87533923.svg"><script id="iframe-resizer-content-window-script" src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.69996afe.js" crossorigin defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.a19283c8.css" type="text/css"><script data-pluto-file="launch-parameters">
window.pluto_notebook_id = undefined;
window.pluto_isolated_cell_ids = undefined;
window.pluto_notebookfile = "data:text/julia;charset=utf-8;base64,IyMjIEEgUGx1dG8uamwgbm90ZWJvb2sgIyMjCiMgdjAuMjAuMTcKCiM+IGN1c3RvbV9hdHRycyA9IFsiaGlkZS1lbmFibGVkIl0KCnVzaW5nIE1hcmtkb3duCnVzaW5nIEludGVyYWN0aXZlVXRpbHMKCiMgVGhpcyBQbHV0byBub3RlYm9vayB1c2VzIEBiaW5kIGZvciBpbnRlcmFjdGl2aXR5LiBXaGVuIHJ1bm5pbmcgdGhpcyBub3RlYm9vayBvdXRzaWRlIG9mIFBsdXRvLCB0aGUgZm9sbG93aW5nICdtb2NrIHZlcnNpb24nIG9mIEBiaW5kIGdpdmVzIGJvdW5kIHZhcmlhYmxlcyBhIGRlZmF1bHQgdmFsdWUgKGluc3RlYWQgb2YgYW4gZXJyb3IpLgptYWNybyBiaW5kKGRlZiwgZWxlbWVudCkKICAgICMhIGZvcm1hdDogb2ZmCiAgICByZXR1cm4gcXVvdGUKICAgICAgICBsb2NhbCBpdiA9IHRyeSBCYXNlLmxvYWRlZF9tb2R1bGVzW0Jhc2UuUGtnSWQoQmFzZS5VVUlEKCI2ZTY5NmM3Mi02NTQyLTIwNjctNzI2NS00MjIwNmM3NTYxNTAiKSwgIkFic3RyYWN0UGx1dG9EaW5nZXRqZXMiKV0uQm9uZHMuaW5pdGlhbF92YWx1ZSBjYXRjaDsgYiAtPiBtaXNzaW5nOyBlbmQKICAgICAgICBsb2NhbCBlbCA9ICQoZXNjKGVsZW1lbnQpKQogICAgICAgIGdsb2JhbCAkKGVzYyhkZWYpKSA9IENvcmUuYXBwbGljYWJsZShCYXNlLmdldCwgZWwpID8gQmFzZS5nZXQoZWwpIDogaXYoZWwpCiAgICAgICAgZWwKICAgIGVuZAogICAgIyEgZm9ybWF0OiBvbgplbmQKCiMg4pWU4pWQ4pWhIDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZgpiZWdpbgoJdXNpbmcgUGx1dG9EZXZNYWNyb3MKCXVzaW5nIExhVGVYU3RyaW5ncwplbmQKCiMg4pWU4pWQ4pWhIDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwMwpAZnJvbXBhY2thZ2UgIi4uLy4uIiBiZWdpbgoJdXNpbmcgXi5TdHJ1Y3RCb25kTW9kdWxlCgl1c2luZyBeOiBFeHRlbmRlZFRhYmxlT2ZDb250ZW50cywgRWRpdGFibGUsIHNob3dfb3V0cHV0X3doZW5faGlkZGVuCgl1c2luZyA+Lkh5cGVydGV4dExpdGVyYWwKCXVzaW5nID4uUGx1dG9VSQplbmQKCiMg4pWU4pWQ4pWhIDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YQptZCIiIgojIFBhY2thZ2VzCiIiIgoKIyDilZTilZDilaEgNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzCkV4dGVuZGVkVGFibGVPZkNvbnRlbnRzKCkKCiMg4pWU4pWQ4pWhIGNiZmM2ZWVjLTg5OTEtNGE5Yy1hZGEwLTI5NWM4MDUyODU0ZAojIGh0bWwiIiIKIyA8c3R5bGU+CiMgbWFpbiB7CiMgCW1hcmdpbi1yaWdodDogMzUwcHggIWltcG9ydGFudDsKIyB9CiMgPC9zdHlsZT4KIyAiIiIKCiMg4pWU4pWQ4pWhIDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MAptZCIiIgojIFN0cnVjdEJvbmQKIiIiCgojIOKVlOKVkOKVoSBhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTAKbWQiIiIKR2VuZXJhdGluZyBhdXRvbWF0aWMgd2lkZ2V0cyBmb3IgY3VzdG9tIHN0cnVjdHMgaXMgcXVpdGUgc3RyYWlnaHRmb3J3YXJkIHdpdGggdGhlIGFpZCBvZiB0aGUgYEBmaWVsZGRhdGFgIG1hY3JvIGFuZCB0aGUgYFN0cnVjdEJvbmRgIHR5cGUuCgpUaGUgdG9wLWxlZnQgYXJyb3cgY2FuIGJlIHVzZWQgdG8gc2hvdy1oaWRlIHRoZSBmaWVsZCBlbGVtZW50cyAodXNlZnVsIGluc2lkZSBhIGBCb25kVGFibGVgLCBzaG93biBiZWxvdyksIHdoaWxlIHRoZSBncmVlbiB0b2dnbGUgb24gdGhlIHRvcC1yaWdodCBjYW4gYmUgdXNlZCB0byBkaXNhYmxlIHRlbXBvcmFyaWx5IHRoZSBzeW5jaCBiZXR3ZWVuIHRoZSBKUyB3aWRnZXRzIGFuZCB0aGUgYm9uZCB2YWx1ZXMgaW4gUGx1dG8uCiIiIgoKIyDilZTilZDilaEgOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2NmCmJlZ2luCiIiIgoJc3RydWN0IEFTRAoiIiIKQmFzZS5Aa3dkZWYgc3RydWN0IEFTRAoJYTo6SW50IAoJYjo6SW50CgljOjpTdHJpbmcKCSJUaGlzIGZpZWxkIGlzIF9zcGVjaWFsXyIKCWQ6OlN0cmluZwoJZTo6SW50CmVuZApAdHlwZWFzZmllbGQgU3RyaW5nID0gVGV4dEZpZWxkKCkgIyBTdHJpbmcgZmllbGRzIHdpdGggbm8gc3RydWN0LXNwZWNpZmljIGRlZmF1bHQgd2lsbCB1c2UgdGhpcyAKQGZpZWxkZGF0YSBBU0QgYmVnaW4KCWEgPSAobWQiTWFya2Rvd24gZGVzY3JpcHRpb24sIGluY2x1ZGluZyBgYExhVGVYYGAiLCBTbGlkZXIoMToxMCkpCgliID0gKEBodGwoIjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+IiksIFNjcnViYmFibGUoMToxMCkpCgljID0gKCJOb3JtYWwgU3RyaW5nIERlc2NyaXB0aW9uIiwgVGV4dEZpZWxkKCkpCgkjIGQgaGFzIG5vIEFTRC1zcGVjaWZpYyBjdXN0b20gYm9uZCwgc28gaXQgd2lsbCB1c2UgdGhlIGZpZWxkIGRvY3N0cmluZyBhcyBkZXNjcmlwdGlvbiBhbmQgdGhlIGRlZmF1bHQgU3RyaW5nIHdpZGdldCBhcyB3aWRnZXQKCWUgPSBTbGlkZXIoMjA6MjUpICMgTm8gZGVzY3JpcHRpb24sIGRlZmF1bHRzIHRvIHRoZSBmaWVsZG5hbWUgYXMgbm8gZG9jc3RyaW5nIGlzIHByZXNlbnQKZW5kCmFzZF9ib25kID0gQGJpbmQgYXNkIFN0cnVjdEJvbmQoQVNEOyBkZXNjcmlwdGlvbiA9ICJDdXN0b20gRGVzY3JpcHRpb24iKQplbmQKCiMg4pWU4pWQ4pWhIGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3Ngphc2QKCiMg4pWU4pWQ4pWhIGZlODkxYjRlLWY0NDAtNDgyMy1iNDNiLTcyNTcyZjZhNmMxMgptZCIiIgojIyBEZWZhdWx0IFR5cGUgV2lkZ2V0cwoiIiIKCiMg4pWU4pWQ4pWhIDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOApiZWdpbgoJQGt3ZGVmIHN0cnVjdCBNQUgKCQlhOjpJbnQKCWVuZAoJQGt3ZGVmIHN0cnVjdCBCT0gKCQltYWg6Ok1BSAoJZW5kCgkKCSMgVGhpcyB3aWxsIG1ha2UgdGhlIGRlZmF1bHQgd2lkZ2V0IGZvciBhbiBJbnQgYSBTbGlkZXIKCUB0eXBlYXNmaWVsZCBJbnQgPSBTbGlkZXIoMToxMCkKCSMgVGhpcyB3aWxsIG1ha2UgdGhlIGRlZmF1bHQgd2lkZ2V0IGZvciBmaWVsZHMgb2YgdHlwZSBBU0QgYSBwb3BvdXQgdGhhdCB3cmFwcyBhIFN0cnVjdEJvbmR7QVNEfQoJQHBvcG91dGFzZmllbGQgTUFICgkKCUBiaW5kIGJvaCBTdHJ1Y3RCb25kKEJPSCkKZW5kCgojIOKVlOKVkOKVoSAyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjQKYm9oCgojIOKVlOKVkOKVoSA0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjUKbWQiIiIKIyBATlRCb25kCiIiIgoKIyDilZTilZDilaEgOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwCm1kIiIiClNvbWV0aW1lcyBjdXN0b20gc3RydWN0cyBhcmUgbm90IG5lZWRlZCBhbmQgaXQgd291bGQgYmUgdXNlZnVsIHRvIGp1c3QgdXNlIHRoZSBzYW1lIG5pY2UgYm9uZCBzdHJ1Y3R1cmUgb2YgYFN0cnVjdEJvbmRgIHRvIHNpbXBseSBjcmVhdGUgYXJiaXRyYXJ5IE5hbWVkVHVwbGVzLiAKClRoaXMgaXMgcG9zc2libGUgd2l0aCB0aGUgY29udmVuaWVuY2UgbWFjcm8gYEBOVEJvbmRgIHdoaWNoIGNhbiBiZSBjYWxsZWQgYXMgc2hvd24gYmVsb3cgdG8gY3JlYXRlIGEgbmljZSBkaXNwbGF5IGZvciBhbiBpbnRlcmFjdGl2ZSBib25kIGNyZWF0aW5nIGFuIGFyYml0cmFyeSBOYW1lZFR1cGxlLgoKVGhlIG1hY3JvIHNpbXBseSBjcmVhdGUgYSBgU3RydWN0Qm9uZGAgd3JhcHBpbmcgdGhlIGRlc2lyZWQgTmFtZWRUdXBsZSB0eXBlLgoiIiIKCiMg4pWU4pWQ4pWhIDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOQpudF9ib25kID0gQGJpbmQgbnQgQE5UQm9uZCAiTXkgRmFuY3kgTlR1cGxlIiBiZWdpbgoJYSA9ICgiRGVzY3JpcHRpb24iLCBTbGlkZXIoMToxMCkpCgliID0gKG1kIioqQm9sZCoqIGZpZWxkIiwgU2xpZGVyKDE6MTApKQoJYyA9IFNsaWRlcigxOjEwKSAjIE5vIGRlc2NyaXB0aW9uLCBkZWZhdWx0cyB0byB0aGUgbmFtZSBvZiB0aGUgZmllbGQKZW5kCgojIOKVlOKVkOKVoSBlMmI3OWE1OC1lNjZlLTRkNDAtODY3My00MTg4MjM3NTNiMzgKbnQKCiMg4pWU4pWQ4pWhIDQ2Njk5NWEyLWRmZDQtNDM3NC04MzM5LWJjMDIzMjAzOWIyNwptZCIiIgojIyB0cmFuc2Zvcm1lZF92YWx1ZQoiIiIKCiMg4pWU4pWQ4pWhIDRjYjEyOGFhLTdhZDgtNGQxNy1iY2VkLTM2ODQ1NzAzZTZhOAptZCIiIgpgQE5UQm9uZGAgaXMgYWxzbyBxdWl0ZSB1c2VmdWwgaW4gY29tYmluYXRpb24gd2l0aCBgdHJhbnNmb3JtZWRfdmFsdWVgIGZyb20gYFBsdXRvVUkuRXhwZXJpbWVudGFsYC4gRm9yIHRoaXMgcmVhc29uLCB0aGUgYEBOVEJvbmRgIG1hY3JvIHN1cHBvcnRzIGFuIG9wdGlvbmFsIHRoaXJkIGFyZ3VtZW50IHdoaWNoIHNoYWxsIGJlIGEgZnVuY3Rpb24gdGhhdCB3aGVuIHByb3ZpZGVkIGlzIGRpcmVjdGx5IHVzZWQgdG8gdHJhbnNmb3JtIHRoZSB2YWx1ZSBvZiB0aGUgd2lkZ2V0LgoiIiIKCiMg4pWU4pWQ4pWhIDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlOApAYmluZCB0cmFuc2Zvcm1lZF92YWx1ZV9leGFtcGxlIEBOVEJvbmQgbWQiVHJhbnNmb3JtZWQhIiBiZWdpbgoJYSA9IFNsaWRlcigxOjEwKQoJYiA9IFNsaWRlcigxOjEwKQplbmQgXy5hICsgXy5iICMgVGhpcyBmdW5jdGlvbiBpcyByZXBsYWNlZCB3aXRoaW4gdGhlIG1hY3JvIHRvIGJlIGBudCAtPiBudC5hICsgbnQuYmAsIHdoaWNoIGNvdWxkIGhhdmUgYWxzbyBiZWVuIHByb3ZpZGVkIGFzIGFub255bW91cyBmdW5jdGlvbiBkaXJlY3RseQoKIyDilZTilZDilaEgMWQ1NTczZWUtODcyZS00ZGZiLWE3ODUtMWFjOWU4MzZhZDk4CnRyYW5zZm9ybWVkX3ZhbHVlX2V4YW1wbGUKCiMg4pWU4pWQ4pWhIDViYjIyZjA3LWZiZWEtNDRhYi05NzgzLTljYTE2ZTBkYTExZQptZCIiIgojIyMgVHJhbnNmb3JtIG9ubHkgYSBmZXcgZmllbGRzCiIiIgoKIyDilZTilZDilaEgMTM0ZDYwMzMtMmYwOC00ZjQ5LTk4MjktNmEwMjNiMzY4YTcwCm1kIiIiCkEgc2ltaWxhciBhcHByb2FjaCBjYW4gYWxzbyBiZSBhY2hpZXZlZCBvbiBhIGZpZWxkIGJ5IGZpZWxkIGJhc2lzIGJ5IHVzaW5nIHRoZSBgQHR2YCBkZWNvcmF0b3IgKHdoaWNoIGlzIG5vdCBhIG1hY3JvIHBlci1zZSBidXQgaXMgZGlyZWN0bHkgcHJvY2Vzc2VkIGR1cmluZyB0aGUgbWFjcm8gZXhwYW5zaW9uIG9mIGBATlRCb25kYCkuCgpgQHR2YCBpcyBhIHNob3J0aGFuZCBmb3IgdHJhbnNmb3JtZWRfdmFsdWUgYW5kIGl0IGV4cGVjdHMgdHdvIGFyZ3VtZW50cyBhZnRlciBpdCwgdGhlIGZpcnN0IGJlaW5nIHRoZSBmdW5jdGlvbiB0byBwcm9jZXNzIHRoZSB2YWx1ZSByZXR1cm5lZCBieSB0aGUgd2lkZ2V0LCBhbmQgdGhlIHNlY29uZCBiZWluZyB0aGUgd2lkZ2V0IGl0c2VsZi4KClRoaXMgY2FuIGJlIHVzZWQgdG8gYmUgYSBiaXQgbGVzcyB2ZXJib3NlIHdoZW4gb25lIGlzIGludGVyZXN0ZWQgaW4gb25seSB0cmFuc2Zvcm1pbmcgb25lIG9mIG1hbnkgZmllbGRzIGFzIGJlbG93OgoiIiIKCiMg4pWU4pWQ4pWhIDU0MzhlOWU3LWMwZjctNDUyMy04NjgyLWZmYjgyMjM1OWQ1MApzaW1wbGVfc2xpZGVyID0gU2xpZGVyKDE6MTApOwoKIyDilZTilZDilaEgMDJlNTgwMTItNWFmNi00YjkxLWE5YTQtMDljOWRjMDM4ZjExCkBiaW5kIHRyYW5zZm9ybV9zaW5nbGVfZmllbGQgQE5UQm9uZCAiRmllbGQgTGV2ZWwgVHJhbnNmb3JtZWQgVmFsdWUiIGJlZ2luCglhID0gKCJBbmdsZSBbwrBdIiwgQHR2IGRlZzJyYWQgU2xpZGVyKDA6OTA7IGRlZmF1bHQgPSA2MCwgc2hvd192YWx1ZT10cnVlKSkgIyBUaGlzIHRyYW5zZm9ybXMgdGhlIGFuZ2xlIGludG8gcmFkaWFucwoJYiA9IEB0diB4IC0+IHggKyAzIHNpbXBsZV9zbGlkZXIgIyBZb3UgY2FuIGVpdGhlciB1c2UgdGhlIGZ1bGwgYW5vbnltb3VzIGZ1bmN0aW9uIHN5bnRoYXgsIG9yIHRoZSBjb252ZW5pZW5jZSBmb3JtIHdoZXJlIF8gaXMgYXV0b21hdGljYWxseSBpbnRlcnByZXRlZCBhcyB0aGUgdmFyaWFibGUgb2YgdGhlIGFub255bW91cyBmdW5jdGlvbiBsaWtlIGJlbG93CgljID0gQHR2IF9eMiBTbGlkZXIoMToxMDsgZGVmYXVsdCA9IDMpICMgRmlyc3QgYXJndW1lbnQgdHJhbnNmb3JtZWQgdG8gdGhlIGFub24gZnVuYyB4IC0+IHheMgoJZCA9IFNsaWRlcigxOjEwKQplbmQKCiMg4pWU4pWQ4pWhIGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YQp0cmFuc2Zvcm1fc2luZ2xlX2ZpZWxkCgojIOKVlOKVkOKVoSA4ZWIxOGM3Zi1iYjRkLTRjZGMtOWUzMC1kNTYxZjkwOTk4MDAKbWQiIiIKIyMgTWFya2Rvd24gbWF0aCBpbiBkZXNjcmlwdGlvbgoiIiIKCiMg4pWU4pWQ4pWhIDA1MmI4YmJkLWFjY2EtNGMwMC1hNWRlLTBjNzE3ZWQwNjhlMwptZCIiIgpUaGUgZGVzY3JpcHRpb24gb2YgYW4gYEBOVEJvbmRgIGNhbiBub3cgYmUgcHJvdmlkZWQgYXMgYW55dGhpbmcgdGhhdCBoYXMgYSB2YWxpZCBgTUlNRSJ0ZXh0L2h0bWwiYCByZXByZXNlbnRhdGlvbi4gVGhpcyBpbmNsdWRlcyBtYXJrZG93biB3aXRoIG1hdGggaW5zaWRlIQoiIiIKCiMg4pWU4pWQ4pWhIGJiMDRhYzEyLTIwYTAtNDY3YS1hZjFhLWMyOTgzMDFlNDgzOAptYXJrZG93bl9mdW5jdGlvbiA9IG50IC0+IGF0YW4obnQueCwgbnQueSkgKyAzCgojIOKVlOKVkOKVoSAzNmZhZjE4Yy0xMWMzLTQwMTItYTk5Ni01NWM3Y2RhZTcxYTgKbWF0aF9udGJvbmQgPSBAYmluZCBhdGFudmFsIEBOVEJvbmQgbWQiVGhpcyBpcyBtYXRoITogYGBcO2F0YW4oeCx5KSArIDNgYCIgYmVnaW4KCXggPSAobWQiYGB4YGAiLCBTbGlkZXIoMToxMDsgc2hvd192YWx1ZT10cnVlKSkKCXkgPSAobWQiYGB5YGAiLCBTbGlkZXIoMToxMDsgc2hvd192YWx1ZT10cnVlKSkKZW5kIG1hcmtkb3duX2Z1bmN0aW9uICMgV2UgY2FuIGFsc28gZGlyZWN0bHkgdXNlIGZ1bmN0aW9ucyBpbiB0aGUgY2FsbGVyIHNjb3BlIHRvIHRyYW5zZm9ybSB0aGUgdmFsdWUKCiMg4pWU4pWQ4pWhIDI3OTc3NTI2LTc1ZGMtNDRjMy05OTc2LWMyMmU4Y2JkOTRkYQphdGFudmFsCgojIOKVlOKVkOKVoSBkYTNhZTM0OC0wODNkLTRhN2QtYWFiZC1kMGJjMjViM2NhMTcKbWQiIiIKIyMgQ3VzdG9tIEhUTUwgZGVzY3JpcHRpb24KIiIiCgojIOKVlOKVkOKVoSAzYzJjMjU3ZS1iYmVlLTRhMDQtYjNiYS02OGYyMzgyZmNlODcKQE5UQm9uZChtZCJhc2QiLCBiZWdpbiBhID0gU2xpZGVyKDE6MTApIGVuZCkuZGVzY3JpcHRpb24KCiMg4pWU4pWQ4pWhIGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NgptZCIiIgpXaGVuIHByb3ZpZGluZyBhIGRlc2NyaXB0aW9uIHRoYXQgaXMgbm90IGEgc3RyaW5nLCBieSBkZWZhdWx0IHRoZSBkZXNjcmlwdGlvbiBmaWVsZCBpbnNpZGUgb2YgdGhlIHJlc3VsdGluZyBgU3RydWN0Qm9uZGAgaXMgc2V0IHRvIGAiTm8gU3RyaW5nIERlc2NyaXB0aW9uIFByb3ZpZGVkImAuCgpJZiBmb3Igc29tZSByZWFzb24gb25lIHdhbnRzIHRvIGN1c3RvbWl6ZSB0aGUgc3RyaW5nIGRlc2NyaXB0aW9uLCBhIHR1cGxlIHdpdGggYChzdHJpbmdfZGVzY3JpcHRpb24sIGh0bWxfZGVzY3JpcHRpb24pYCBjYW4gYmUgcHJvdmlkZWQKIiIiCgojIOKVlOKVkOKVoSBjZjgwN2NiMy01ZDc1LTQwNDAtYmZkMS0wNWZlNzBkMjZlODkKdHVwbGVfZGVzY3JpcHRpb25fbnRib25kID0gQE5UQm9uZCAoIlBsYWluIGRlc2NyaXB0aW9uIiwgaHRtbCI8c3Bhbj5IVE1MIERlc2NyaXB0aW9uPC9zcGFuPiIpIGJlZ2luCglhID0gU2xpZGVyKDE6MTApCmVuZAoKIyDilZTilZDilaEgNTY0OTY4ZmUtMGE2OC00OGJjLTllMTEtYzc3MzJlMmJhZTA0CnR1cGxlX2Rlc2NyaXB0aW9uX250Ym9uZC5kZXNjcmlwdGlvbgoKIyDilZTilZDilaEgZjY1YjMyMzEtZjJiMi00NWRjLWI3MmUtMWFkMzEwNzA4M2ZjCm1kIiIiCiMgU3RydWN0Qm9uZFNlbGVjdAoiIiIKCiMg4pWU4pWQ4pWhIDY3YzA4NjBiLWI0YzEtNDEyZC04NzBhLWE0Y2U0OTg3NDY1ZQptZCIiIgpTb21ldGltZXMsIG9uZSB3YW50cyB0byBjcmVhdGUgYSBtb3JlIGNvbXBsZXggYmluZGluZyB3aGVyZSB0aGUgbnVtYmVyIG9mIHBhcmFtZXRlcnMgdG8gY29udHJvbCBhIGJvbmQgY2FuIHZhcnkgZGVwZW5kaW5nIG9uIHNvbWUgb3RoZXIgdmFyaWFibGUuIFRoZSBgU3RydWN0Qm9uZFNlbGVjdGAgY2FuIGJlIG9mIGhlbHAgaW4gc29tZSBvZiB0aGVzZSBjYXNlcywgYnkgcHJvdmlkaW5nIGEgd2F5IHRvIHNlbGVjdCBvdXQgb2YgYSBudW1iZXIgb2YgYXJiaXRyYXJ5IGBTdHJ1Y3RCb25kc2AgKHdoaWNoIGluY2x1ZGUgYEBOVEJvbmRgKSBieSB1c2luZyBhIGRyb3Bkb3duIHRvIHNlbGVjdCB0aGUgb25lIHRvIGJlIGRpc3BsYXllZCBhbmQgdXNlZCBmb3IgZ2VuZXJhdGluZyB0aGUgYFN0cnVjdEJvbmRTZWxlY3RgIHdpZGdldCdzIG91dHB1dC4KClRoaXMgc3RydWN0dXJlIGNhbiBiZSBjb25zdHJ1Y3RlZCB3aXRoIGEgdmVjdG9yIG9mIGBTdHJ1Y3RCb25kYCBvciBgdHJhbnNmb3JtZWRfdmFsdWUoZiwgOjpTdHJ1Y3RCb25kKWAgZWxlbWVudHMsIGFuZCB3aWxsIHRha2UgY2FyZSBvZiBnZW5lcmF0aW5nIGFuIGFwcHJvcHJpYXRlIHdpZGdldCB0byBkaXNwbGF5IGFuZCBwcm9jZXNzIG9ubHkgdGhlIHNlbGVjdGVkIG9uZS4KClRoZSBtYWluIHNpZ25hdHVyZSBvZiB0aGUgY29uc3RydWN0b3IgaXMgdGhlIGZvbGxvd2luZzoKYGBganVsaWEKU3RydWN0Qm9uZFNlbGVjdChlbHM6OlZlY3RvcjsgZGVzY3JpcHRpb24gPSAiU3RydWN0Qm9uZFNlbGVjdCIsIGRlZmF1bHRfaWR4ID0gMSwgc2VsZWN0b3JfdGV4dCA9ICJTZWxlY3RvciIpCmBgYAoKVGhlIG5hbWVzIHRvIHNlbGVjdCB1cG9uIHdpbGwgYmUgdGFrZW4gZnJvbSB0aGUgYGRlc2NyaXB0aW9uYCBvZiB0aGUgcHJvdmlkZWQgYFN0cnVjdEJvbmRzYCwgd2hpbGUgdGhlIHRleHQgZGlzcGxheWVkIG5leHQgdG8gdGhlIF9zZWxlY3Rvcl8gd2lsbCBkZWZhdWx0IHRvIGBTZWxlY3RvcmAgYnV0IGNhbiBiZSBjdXN0b21pemVkIHdpdGggdGhlIGBzZWxlY3Rvcl90ZXh0YCBrd2FyZyB0byB0aGUgY29uc3RydWN0b3IuClRoZSBgZGVzY3JpcHRpb25gIGt3YXJnIGNhbiBiZSB1c2VkIHRvIGN1c3RvbWl6ZSB0aGUgdGV4dCBpbiB0aGUgd2lkZ2V0IGNvbnRhaW5lciAoc2ltaWxhciB0byB0aGUgc2FtZSBrd2FyZyBpbiBgU3RydWN0Qm9uZGAgYW5kIHRvIGBATlRCb25kYCkuIEZpbmFsbHksIHRoZSBgZGVmYXVsdF9pZHhgIHNob3VsZCBiZSBhbiBpbnRlZ2VyIGFuZCB3aWxsIHNlbGVjdCB3aGljaCBvZiB0aGUgcHJvdmlkZWQgYFN0cnVjdEJvbmRgcyB3aWxsIGJlIHNlbGVjdGVkIGFzIGRlZmF1bHQgd2hlbiBpbnN0YW50aWF0aW5nIHRoZSB3aWRnZXQuCiIiIgoKIyDilZTilZDilaEgYmQ1ZWMwODYtNTE1Ni00ZTdjLWE3MGItNWNhOWYwODliYjQ5CnNic19ib25kID0gQGJpbmQgc2JzIFN0cnVjdEJvbmRTZWxlY3QoWwoJQE5UQm9uZCAiY29zKGFyZykiIGJlZ2luCgkJYXJnID0gU2xpZGVyKHJhbmdlKDAsMSwxMDApKQoJZW5kIChudCAtPiBjb3MobnQuYXJnKSkgIyBXZSBuZWVkIHRvIHdyYXAgdGhlIGZ1bmN0aW9uIGdpdmVuIHRvIGBATlRCb25kYCBpbiAoKSB0byBhdm9pZCBwYXJzZSBwcm9ibGVtcyB3aGVuIHByb3ZpZGluZyBhIGZ1bmN0aW9uCglATlRCb25kICJhdGFuKHkseCkiIGJlZ2luCgkJeCA9IFNsaWRlcihyYW5nZSgwLDEwOyBzdGVwID0gMC4xKTsgZGVmYXVsdCA9IDMsIHNob3dfdmFsdWU9dHJ1ZSkKCQl5ID0gU2xpZGVyKHJhbmdlKDAsIDEwOyBzdGVwID0gMC4xKTsgZGVmYXVsdCA9IDUsIHNob3dfdmFsdWU9dHJ1ZSkKCWVuZCBudCAtPiBhdGFuKG50LnksIG50LngpCl07IGRlZmF1bHRfaWR4ID0gMiwgc2VsZWN0b3JfdGV4dCA9ICJPcHRpb25zOiIpCgojIOKVlOKVkOKVoSA3ODUzY2M3Zi00ZTU4LTQ0ZDEtOGQzYi1mOGQ0NzQ1NTY0ZTYKc2JzCgojIOKVlOKVkOKVoSA5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzcKbWQiIiIKIyBAQm9uZHNMaXN0CiIiIgoKIyDilZTilZDilaEgOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3Cm1kIiIiCkluIHNvbWUgY2FzZXMsIG9uZSBkb2VzIG5vdCB3YW50IHRvIGhhdmUgYSBzaW5nbGUgYm9uZCB3cmFwcGluZyBlaXRoZXIgYSBTdHJ1Y3R1cmUgb3IgYSBOYW1lZFR1cGxlIGJlY2F1c2Ugc2luZ2xlIGluZGVwZW5kZW50IGJvbmRzIGFyZSBtb3JlIGNvbnZlbmllbnQuCgpgQEJvbmRzTGlzdGAgaXMgYSBjb252ZW5pZW5jZSBtYWNybyB0byBjcmVhdGUgYW4gb2JqZWN0IG9mIHR5cGUgYEJvbmRzTGlzdGAgd2hpY2ggc2ltcGx5IGFsbG93IHRvIGFkZCBhIGRlc2NyaXB0aW9uIHRvIHNlcGFyYXRlIGJvbmRzIGFuZCBncm91cCB0aGVtIGFsbCB0b2dldGhlciBpbiBhIHRhYmxlLWxpa2UgZm9ybWF0IGVxdWl2YWxlbnQgdG8gdGhvc2Ugb2YgYFN0cnVjdEJvbmRgLgoKISEhIG5vdGUKCVVubGlrZSBgU3RydWN0Qm9uZGAsIGEgQm9uZHNMaXN0IGlzIGFscmVhZHkgY29tcG9zZWQgb2YgYm9uZCBjcmVhdGVkIHdpdGggYEBiaW5kYCBhbmQgaXQganVzdCBncm91cHMgdGhlbSB1cCB3aXRoIGEgZGVzY3JpcHRpb24uIFRoZSBvdXRwdXQgb2YgYEBCb25kc0xpc3RgIGlzIG5vdCBzdXBwb3NlZCB0byBiZSBib3VuZCB0byBhIHZhcmlhYmxlIHVzaW5nIGBAYmluZGAuXAoJVGhlIGJvbmRzIGdyb3VwZWQgaW4gYSBCb25kc0xpc3Qgc3RpbGwgYWN0IGFuZCB1cGRhdGUgaW5kZXBlbmRlbnRseSBmcm9tIG9uZSBhbm90aGVyLgoKU2VlIHRoZSBleGFtcGxlIGJlbG93IGZvciB1bmRlcnN0YW5kaW5nIHRoZSBzeW50aGF4LiBUaGUgaGVhZGVyIG9mIGEgQm9uZHNMaXN0IGlzIHNob3duIGluIGFuIG9yYW5nZSBiYWNrZ3JvdW5kIHRvIGVhc2lseSBkaWZmZXJlbnRpYXRlIGl0IGZyb20gYFN0cnVjdEJvbmRgLgoiIiIKCiMg4pWU4pWQ4pWhIDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiYwpibCA9IEBCb25kc0xpc3QgIk15IEdyb3VwIG9mIEJvbmRzIiBsZXQgdHYgPSBQbHV0b1VJLkV4cGVyaW1lbnRhbC50cmFuc2Zvcm1lZF92YWx1ZQoJICMgV2UgdXNlIHRyYW5zZm9ybWVkX3ZhbHVlIHRvIHRyYW5zbGF0ZSBHSHogdG8gSHogaW4gdGhlIGJvdW5kIHZhcmlhYmxlIGBmcmVxYAoJIkZyZXF1ZW5jeSBbR0h6XSIgPSBAYmluZCBmcmVxIHR2KHggLT4geCAqIDFlOSwgRWRpdGFibGUoMjA7IHN1ZmZpeCA9ICIgR0h6IikpCgltZCJBbHRpdHVkZSBgYGhgYCBbbV0iID0gQGJpbmQgYWx0IFNjcnViYmFibGUoMTAwOjEwOjIwMCkKZW5kCgojIOKVlOKVkOKVoSBhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTQKZnJlcQoKIyDilZTilZDilaEgNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZiCmFsdAoKIyDilZTilZDilaEgMmVlN2YyNmQtZjM4My00ZTdlLWE2OWEtOGZiNzI3MTc0NjdjCm1kIiIiCiMgUG9wb3V0CiIiIgoKIyDilZTilZDilaEgNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyCm1kIiIiClRoZSBzdHJ1Y3R1cmVzIGFib3ZlIGNhbiBhbHNvIGJlIHVzZWQgbmVzdGVkIHdpdGhpbiBvbmUgYW5vdGhlci4gVG8gZmFjaWxpdGF0ZSBhY2Nlc3NpbmcgbmVzdGVkIHN0cnVjdHVyZXMsIG9uZSBjYW4gdXNlIHRoZSBgUG9wb3V0YCB0eXBlLgoKSW4gaXRzIHNpbXBsZSBmb3JtLCB5b3UgY2FuIGdpdmUgYW4gaW5zdGFuY2Ugb2YgYSBTdHJ1Y3RCb25kLCBhIGJvbmQgd3JhcHBpbmcgYSBTdHJ1Y3RCb25kIG9yIGEgQm9uZHNMaXN0IGFzIGlucHV0IHRvIFBvcG91dCB0byBjcmVhdGUgYSB0YWJsZSB0aGF0IGlzIGhpZGRlbiBiZWhpbmQgYSBwb3B1cCB3aW5kb3cuCklmIGFuIGluc3RhbmNlIHByZXNlbnQsIGJ1dCB5b3Ugd2FudCBhIGN1c3RvbSB0eXBlIGZvciB3aGljaCB5b3UgaGF2ZSBkZWZpbmVkIGN1c3RvbSBib25kcyBhbmQgZGVzY3JpcHRpb25zIHdpdGggYEBmaWVsZGRhdGFgIHRvIGFwcGVhciBhcyBwb3BvdXQsIHlvdSBjYW4gdXNlIHRoZSBmdW5jdGlvbiBgcG9wb3V0d3JhcChUWVBFKWAgdG8gZ2VuZXJhdGUgYSBzbWFsbCBpY29uIHdoaWNoIGhpZGVzIGEgcG9wdXAgY29udGFpbmluZyB0aGUgYFN0cnVjdEJvbmRgIG9mIHRoZSBwcm92aWRlZCB0eXBlIGBUWVBFYC4KClRoZSBTdHJ1Y3RCb25kIHRhYmxlIGFwcGVhcnMgb24gaG92ZXIgdXBvbiB0aGUgaWNvbiwgY2FuIGJlIG1hZGUgZml4ZWQgYnkgY2xpY2tpbmcgb24gdGhlIGljb24gYW5kIGNhbiB0aGVuIGJlIG1vdmVkIGFyb3VuZCBvciByZXNpemVkLgpBIGRvdWJsZSBjbGljayBvbiB0aGUgaGVhZGVyIG9mIHRoZSBwb3BvdXQgaGlkZXMgaXQgYWdhaW46CiIiIgoKIyDilZTilZDilaEgNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyCmJlZ2luCkJhc2UuQGt3ZGVmIHN0cnVjdCBMT0wKCWE6OkludCAKCWI6OkludAplbmQKQGZpZWxkZGF0YSBMT0wgYmVnaW4KCWEgPSAobWQiV29uZGVyISIsIFNsaWRlcigxOjEwKSkKCWIgPSAoQGh0bCgiPHNwYW4+RmllbGQgQjwvc3Bhbj4iKSwgU2NydWJiYWJsZSgxOjEwKSkKZW5kCmVuZAoKIyDilZTilZDilaEgNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0CkBiaW5kIGxvbF9wb3AgcG9wb3V0d3JhcChMT0wpCgojIOKVlOKVkOKVoSAwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDYKbG9sX3BvcAoKIyDilZTilZDilaEgMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk3Cm1kIiIiClRoZSBhYmlsaXR5IHRvIGFsc28gd3JhcCBwcmUtZXhpc3RpbmcgYm9uZHMgYXJvdW5kIFN0cnVjdEJvbmRzIGlzIGNvbnZlbmllbnQgZm9yIG9yZ2FuaXppbmcgdGhlIHZhcmlvdXMgYm9uZHMgb25lIGhhdmUgaW4gYSBgQm9uZHNMaXN0YCBvciBgQm9uZFRhYmxlYAoKQXMgYW4gZXhhbXBsZSwgb25lIGNhbiBjcmVhdGUgYSBgQm9uZHNMaXN0YCBjb250YWluaW5nIHRoZSB0d28gYFN0cnVjdEJvbmRgIGJvbmRzIGdlbmVyYXRlZCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoaXMgbm90ZWJvb2sgd2l0aCB0aGUgZm9sbHdpbmcgY29kZS4KIiIiCgojIOKVlOKVkOKVoSA4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjUKYmxjID0gQEJvbmRzTGlzdCAiUG9wb3V0IENvbnRhaW5lciIgYmVnaW4KCSJTdHJ1Y3R1cmUgQVNEIiA9IFBvcG91dChhc2RfYm9uZCkKCSJOYW1lZFR1cGxlIiA9IFBvcG91dChudF9ib25kKQoJIlN0cnVjdEJvbmRTZWxlY3QiID0gUG9wb3V0KHNic19ib25kKQplbmQKCiMg4pWU4pWQ4pWhIGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNgphc2QKCiMg4pWU4pWQ4pWhIDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YQpudAoKIyDilZTilZDilaEgM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1Cm1kIiIiCiMgQm9uZFRhYmxlCiIiIgoKIyDilZTilZDilaEgMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0Cm1kIiIiClRoZSBmaW5hbCBjb252ZW5pZW5jZSBzdHJ1Y3R1cmUgcHJvdmlkZWQgYnkgdGhpcyBtb2R1bGUgaXMgdGhlIGBCb25kVGFibGVgLiBJdCBjYW4gYmUgY3JlYXRlZCB0byBncm91cCBhIGxpc3Qgb2YgYm9uZHMgaW4gYSBmbG9hdGluZyB0YWJsZSB0aGF0IHN0YXlzIG9uIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIG5vdGVib29rIChzaW1pbGFyIHRvIHRoZSBUYWJsZU9mQ29udGVudHMgb2YgUGx1dG9VSSkgYW5kIGNhbiBiZSBtb3ZlZCBhcm91bmQgYW5kIHJlc2l6ZWQgb3IgaGlkZGVuIGZvciBjb252ZW5pZW5jZS4KClRoZSBCb25kVGFibGUgaXMgaW50ZW5kZWQgdG8gYmUgdXNlZCBlaXRoZXIgd2l0aCBib25kcyBjb250YWluaW5nIGBTdHJ1Y3RCb25kYCBvciB3aXRoIGBCb25kc0xpc3RgLiBGdXR1cmUgdHlwZXMgd2l0aCBzaW1pbGFyIHN0cnVjdHVyZSB3aWxsIGFsc28gYmUgYWRkZWQuCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgYSBib25kdGFibGUgY29udGFpbmluZyBhbGwgdGhlIGV4YW1wbGVzIG9mIHRoaXMgbm90ZWJvb2suCiIiIgoKIyDilZTilZDilaEgOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2CkJvbmRUYWJsZShbCglhc2RfYm9uZCwKCW50X2JvbmQsCglibCwKCWJsYwpdOyBkZXNjcmlwdGlvbiA9ICJNeSBCb25kcyIpIHw+IHNob3dfb3V0cHV0X3doZW5faGlkZGVuCgojIOKVlOKVkOKVoSAwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWYKbnQKCiMg4pWU4pWQ4pWhIDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OAphc2QKCiMg4pWU4pWQ4pWhIDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjMwpmcmVxCgojIOKVlOKVkOKVoSBiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDYKYWx0CgojIOKVlOKVkOKVoSAwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEKUExVVE9fUFJPSkVDVF9UT01MX0NPTlRFTlRTID0gIiIiCltkZXBzXQpMYVRlWFN0cmluZ3MgPSAiYjk2NGZhOWYtMDQ0OS01YjU3LWE1YzItZDNlYTY1ZjQwNDBmIgpQbHV0b0Rldk1hY3JvcyA9ICJhMDQ5OWYyOS1jMzliLTRjNWMtODA3Yy04ODA3NDIyMWI5NDkiCgpbY29tcGF0XQpMYVRlWFN0cmluZ3MgPSAifjEuNC4wIgpQbHV0b0Rldk1hY3JvcyA9ICJ+MC45LjEiCiIiIgoKIyDilZTilZDilaEgMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAyClBMVVRPX01BTklGRVNUX1RPTUxfQ09OVEVOVFMgPSAiIiIKIyBUaGlzIGZpbGUgaXMgbWFjaGluZS1nZW5lcmF0ZWQgLSBlZGl0aW5nIGl0IGRpcmVjdGx5IGlzIG5vdCBhZHZpc2VkCgpqdWxpYV92ZXJzaW9uID0gIjEuMTIuMC1yYzIiCm1hbmlmZXN0X2Zvcm1hdCA9ICIyLjAiCnByb2plY3RfaGFzaCA9ICIxMTgwMGViZjViNTRkYjBkNGZmZmEzMzA1ZDc5ZWY4OWMzOTljMWY4IgoKW1tkZXBzLkFyZ1Rvb2xzXV0KdXVpZCA9ICIwZGFkODRjNS1kMTEyLTQyZTYtOGQyOC1lZjEyZGFiYjc4OWYiCnZlcnNpb24gPSAiMS4xLjIiCgpbW2RlcHMuQXJ0aWZhY3RzXV0KdXVpZCA9ICI1NmYyMmQ3Mi1mZDZkLTk4ZjEtMDJmMC0wOGRkYzA5MDdjMzMiCnZlcnNpb24gPSAiMS4xMS4wIgoKW1tkZXBzLkJhc2U2NF1dCnV1aWQgPSAiMmEwZjQ0ZTMtNmM4My01NWJkLTg3ZTQtYjE5NzhkOThiZDVmIgp2ZXJzaW9uID0gIjEuMTEuMCIKCltbZGVwcy5Db2RlVHJhY2tpbmddXQpkZXBzID0gWyJJbnRlcmFjdGl2ZVV0aWxzIiwgIlVVSURzIl0KZ2l0LXRyZWUtc2hhMSA9ICI5ODBmMDFkNmQzMjgzYjNkYmRmZDdlZDg5NDA1Zjk2YjcyNTZhZDU3Igp1dWlkID0gImRhMWZkOGEyLThkOWUtNWVjMi04NTU2LTMwMjJmYjU2MDhhMiIKdmVyc2lvbiA9ICIyLjAuMSIKCltbZGVwcy5EYXRlc11dCmRlcHMgPSBbIlByaW50ZiJdCnV1aWQgPSAiYWRlMmNhNzAtMzg5MS01OTQ1LTk4ZmItZGMwOTk0MzJlMDZhIgp2ZXJzaW9uID0gIjEuMTEuMCIKCltbZGVwcy5Eb3dubG9hZHNdXQpkZXBzID0gWyJBcmdUb29scyIsICJGaWxlV2F0Y2hpbmciLCAiTGliQ1VSTCIsICJOZXR3b3JrT3B0aW9ucyJdCnV1aWQgPSAiZjQzYTI0MWYtYzIwYS00YWQ0LTg1MmMtZjZiMTI0Nzg2MWM2Igp2ZXJzaW9uID0gIjEuNi4wIgoKW1tkZXBzLkZpbGVXYXRjaGluZ11dCnV1aWQgPSAiN2IxZjYwNzktNzM3YS01OGRjLWI4YmMtN2EyY2E1YzFiNWVlIgp2ZXJzaW9uID0gIjEuMTEuMCIKCltbZGVwcy5JbnRlcmFjdGl2ZVV0aWxzXV0KZGVwcyA9IFsiTWFya2Rvd24iXQp1dWlkID0gImI3N2UwYTRjLWQyOTEtNTdhMC05MGU4LThkYjI1YTI3YTI0MCIKdmVyc2lvbiA9ICIxLjExLjAiCgpbW2RlcHMuSnVsaWFJbnRlcnByZXRlcl1dCmRlcHMgPSBbIkNvZGVUcmFja2luZyIsICJJbnRlcmFjdGl2ZVV0aWxzIiwgIlJhbmRvbSIsICJVVUlEcyJdCmdpdC10cmVlLXNoYTEgPSAiZDgzMzc2MjJmZTUzYzA1ZDE2ZjAzMWRmMjRkYWYwMjcwZTUzYmM2NCIKdXVpZCA9ICJhYTFhZTg1ZC1jYWJlLTU2MTctYTY4Mi02YWRmNTFiMmUxNmEiCnZlcnNpb24gPSAiMC4xMC41IgoKW1tkZXBzLkp1bGlhU3ludGF4SGlnaGxpZ2h0aW5nXV0KZGVwcyA9IFsiU3R5bGVkU3RyaW5ncyJdCnV1aWQgPSAiYWM2ZTVmZjctZmI2NS00ZTc5LWE0MjUtZWMzYmM5YzAzMDExIgp2ZXJzaW9uID0gIjEuMTIuMCIKCltbZGVwcy5MYVRlWFN0cmluZ3NdXQpnaXQtdHJlZS1zaGExID0gImRkYTIxYjhjYmQ2YTZjNDBkOWQwMmE3MzIzMGY5ZDcwZmVkNjkxOGMiCnV1aWQgPSAiYjk2NGZhOWYtMDQ0OS01YjU3LWE1YzItZDNlYTY1ZjQwNDBmIgp2ZXJzaW9uID0gIjEuNC4wIgoKW1tkZXBzLkxpYkNVUkxdXQpkZXBzID0gWyJMaWJDVVJMX2psbCIsICJNb3ppbGxhQ0FDZXJ0c19qbGwiXQp1dWlkID0gImIyNzAzMmMyLWEzZTctNTBjOC04MGNkLTJkMzZkYmNiZmQyMSIKdmVyc2lvbiA9ICIwLjYuNCIKCltbZGVwcy5MaWJDVVJMX2psbF1dCmRlcHMgPSBbIkFydGlmYWN0cyIsICJMaWJTU0gyX2psbCIsICJMaWJkbCIsICJPcGVuU1NMX2psbCIsICJabGliX2psbCIsICJuZ2h0dHAyX2psbCJdCnV1aWQgPSAiZGVhYzliNDctOGJjNy01OTA2LWEwZmUtMzVhYzU2ZGM4NGMwIgp2ZXJzaW9uID0gIjguMTEuMSsxIgoKW1tkZXBzLkxpYkdpdDJdXQpkZXBzID0gWyJMaWJHaXQyX2psbCIsICJOZXR3b3JrT3B0aW9ucyIsICJQcmludGYiLCAiU0hBIl0KdXVpZCA9ICI3NmY4NTQ1MC01MjI2LTViNWEtOGVhYS01MjlhZDA0NWI0MzMiCnZlcnNpb24gPSAiMS4xMS4wIgoKW1tkZXBzLkxpYkdpdDJfamxsXV0KZGVwcyA9IFsiQXJ0aWZhY3RzIiwgIkxpYlNTSDJfamxsIiwgIkxpYmRsIiwgIk9wZW5TU0xfamxsIl0KdXVpZCA9ICJlMzdkYWY2Ny01OGE0LTU5MGEtOGU5OS1iMDI0NWRkMmZmYzUiCnZlcnNpb24gPSAiMS45LjArMCIKCltbZGVwcy5MaWJTU0gyX2psbF1dCmRlcHMgPSBbIkFydGlmYWN0cyIsICJMaWJkbCIsICJPcGVuU1NMX2psbCJdCnV1aWQgPSAiMjk4MTZiNWEtYjlhYi01NDZmLTkzM2MtZWRhZDE4ODZkZmE4Igp2ZXJzaW9uID0gIjEuMTEuMysxIgoKW1tkZXBzLkxpYmRsXV0KdXVpZCA9ICI4ZjM5OWRhMy0zNTU3LTU2NzUtYjVmZi1mYjgzMmM5N2NiZGIiCnZlcnNpb24gPSAiMS4xMS4wIgoKW1tkZXBzLkxvZ2dpbmddXQp1dWlkID0gIjU2ZGRiMDE2LTg1N2ItNTRlMS1iODNkLWRiNGQ1OGRiNTU2OCIKdmVyc2lvbiA9ICIxLjExLjAiCgpbW2RlcHMuTWFjcm9Ub29sc11dCmdpdC10cmVlLXNoYTEgPSAiMWUwMjI4YTAzMDY0MjAxNGZlNWNmZTY4YzJjMGE4MThmOWUzZjUyMiIKdXVpZCA9ICIxOTE0ZGQyZi04MWM2LTVmY2QtODcxOS02ZDVjOTYxMGZmMDkiCnZlcnNpb24gPSAiMC41LjE2IgoKW1tkZXBzLk1hcmtkb3duXV0KZGVwcyA9IFsiQmFzZTY0IiwgIkp1bGlhU3ludGF4SGlnaGxpZ2h0aW5nIiwgIlN0eWxlZFN0cmluZ3MiXQp1dWlkID0gImQ2ZjQzNzZlLWFlZjUtNTA1YS05NmMxLTljMDI3Mzk0NjA3YSIKdmVyc2lvbiA9ICIxLjExLjAiCgpbW2RlcHMuTW96aWxsYUNBQ2VydHNfamxsXV0KdXVpZCA9ICIxNGEzNjA2ZC1mNjBkLTU2MmUtOTEyMS0xMmQ5NzJjZDgxNTkiCnZlcnNpb24gPSAiMjAyNS41LjIwIgoKW1tkZXBzLk5ldHdvcmtPcHRpb25zXV0KdXVpZCA9ICJjYTU3NTkzMC1jMmUzLTQzYTktYWNlNC0xZTk4OGIyYzE5MDgiCnZlcnNpb24gPSAiMS4zLjAiCgpbW2RlcHMuT3BlblNTTF9qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliZGwiXQp1dWlkID0gIjQ1OGMzYzk1LTJlODQtNTBhYS04ZWZjLTE5MzgwYjJhM2E5NSIKdmVyc2lvbiA9ICIzLjUuMSswIgoKW1tkZXBzLlBrZ11dCmRlcHMgPSBbIkFydGlmYWN0cyIsICJEYXRlcyIsICJEb3dubG9hZHMiLCAiRmlsZVdhdGNoaW5nIiwgIkxpYkdpdDIiLCAiTGliZGwiLCAiTG9nZ2luZyIsICJNYXJrZG93biIsICJQcmludGYiLCAiUmFuZG9tIiwgIlNIQSIsICJUT01MIiwgIlRhciIsICJVVUlEcyIsICJwN3ppcF9qbGwiXQp1dWlkID0gIjQ0Y2ZlOTVhLTFlYjItNTJlYS1iNjcyLWUyYWZkZjY5Yjc4ZiIKdmVyc2lvbiA9ICIxLjEyLjAiCgogICAgW2RlcHMuUGtnLmV4dGVuc2lvbnNdCiAgICBSRVBMRXh0ID0gIlJFUEwiCgogICAgW2RlcHMuUGtnLndlYWtkZXBzXQogICAgUkVQTCA9ICIzZmEwY2Q5Ni1lZWYxLTU2NzYtOGE2MS1iM2I4NzU4YmJmZmIiCgpbW2RlcHMuUGx1dG9EZXZNYWNyb3NdXQpkZXBzID0gWyJKdWxpYUludGVycHJldGVyIiwgIkxvZ2dpbmciLCAiTWFjcm9Ub29scyIsICJQa2ciLCAiVE9NTCJdCmdpdC10cmVlLXNoYTEgPSAiMWNiODYxYzkyOTVkNzlkYzZlMjMxNzBkNGIzM2JjZTAxM2Y2OTY0MyIKdXVpZCA9ICJhMDQ5OWYyOS1jMzliLTRjNWMtODA3Yy04ODA3NDIyMWI5NDkiCnZlcnNpb24gPSAiMC45LjEiCgpbW2RlcHMuUHJpbnRmXV0KZGVwcyA9IFsiVW5pY29kZSJdCnV1aWQgPSAiZGUwODU4ZGEtNjMwMy01ZTY3LTg3NDQtNTFlZGRlZWViOGQ3Igp2ZXJzaW9uID0gIjEuMTEuMCIKCltbZGVwcy5SYW5kb21dXQpkZXBzID0gWyJTSEEiXQp1dWlkID0gIjlhM2Y4Mjg0LWEyYzktNWYwMi05YTExLTg0NTk4MGExZmQ1YyIKdmVyc2lvbiA9ICIxLjExLjAiCgpbW2RlcHMuU0hBXV0KdXVpZCA9ICJlYThlOTE5Yy0yNDNjLTUxYWYtODgyNS1hYWE2M2NkNzIxY2UiCnZlcnNpb24gPSAiMC43LjAiCgpbW2RlcHMuU3R5bGVkU3RyaW5nc11dCnV1aWQgPSAiZjQ4OTMzNGItZGEzZC00YzJlLWI4ZjAtZTQ3NmUxMmMxNjJiIgp2ZXJzaW9uID0gIjEuMTEuMCIKCltbZGVwcy5UT01MXV0KZGVwcyA9IFsiRGF0ZXMiXQp1dWlkID0gImZhMjY3ZjFmLTYwNDktNGYxNC1hYTU0LTMzYmFmYWUxZWQ3NiIKdmVyc2lvbiA9ICIxLjAuMyIKCltbZGVwcy5UYXJdXQpkZXBzID0gWyJBcmdUb29scyIsICJTSEEiXQp1dWlkID0gImE0ZTU2OWE2LWU4MDQtNGZhNC1iMGYzLWVlZjdhMWQ1YjEzZSIKdmVyc2lvbiA9ICIxLjEwLjAiCgpbW2RlcHMuVVVJRHNdXQpkZXBzID0gWyJSYW5kb20iLCAiU0hBIl0KdXVpZCA9ICJjZjcxMThhNy02OTc2LTViMWEtOWEzOS03YWRjNzJmNTkxYTQiCnZlcnNpb24gPSAiMS4xMS4wIgoKW1tkZXBzLlVuaWNvZGVdXQp1dWlkID0gIjRlYzBhODNlLTQ5M2UtNTBlMi1iOWFjLThmNzJhY2Y1YThmNSIKdmVyc2lvbiA9ICIxLjExLjAiCgpbW2RlcHMuWmxpYl9qbGxdXQpkZXBzID0gWyJMaWJkbCJdCnV1aWQgPSAiODM3NzVhNTgtMWYxZC01MTNmLWIxOTctZDcxMzU0YWIwMDdhIgp2ZXJzaW9uID0gIjEuMy4xKzIiCgpbW2RlcHMubmdodHRwMl9qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliZGwiXQp1dWlkID0gIjhlODUwZWRlLTc2ODgtNTMzOS1hMDdjLTMwMmFjZDJhYWY4ZCIKdmVyc2lvbiA9ICIxLjY0LjArMSIKCltbZGVwcy5wN3ppcF9qbGxdXQpkZXBzID0gWyJBcnRpZmFjdHMiLCAiTGliZGwiXQp1dWlkID0gIjNmMTllOTMzLTMzZDgtNTNiMy1hYWFiLWJkNTExMGMzYjdhMCIKdmVyc2lvbiA9ICIxNy41LjArMiIKIiIiCgojIOKVlOKVkOKVoSBDZWxsIG9yZGVyOgojIOKVn+KUgDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YQojIOKVoOKVkDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZgojIOKVoOKVkDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwMwojIOKVoOKVkDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5MwojIOKVoOKVkGNiZmM2ZWVjLTg5OTEtNGE5Yy1hZGEwLTI5NWM4MDUyODU0ZAojIOKVn+KUgDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MAojIOKVn+KUgGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMAojIOKVoOKVkDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZgojIOKVoOKVkGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NgojIOKVn+KUgGZlODkxYjRlLWY0NDAtNDgyMy1iNDNiLTcyNTcyZjZhNmMxMgojIOKVoOKVkDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOAojIOKVoOKVkDIzNThmNjg2LTE5NTAtNDBmOS05ZDVjLWRhYzJkOThmNGMyNAojIOKVn+KUgDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNQojIOKVn+KUgDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MAojIOKVoOKVkDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOQojIOKVoOKVkGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzOAojIOKVn+KUgDQ2Njk5NWEyLWRmZDQtNDM3NC04MzM5LWJjMDIzMjAzOWIyNwojIOKVn+KUgDRjYjEyOGFhLTdhZDgtNGQxNy1iY2VkLTM2ODQ1NzAzZTZhOAojIOKVoOKVkDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlOAojIOKVoOKVkDFkNTU3M2VlLTg3MmUtNGRmYi1hNzg1LTFhYzllODM2YWQ5OAojIOKVn+KUgDViYjIyZjA3LWZiZWEtNDRhYi05NzgzLTljYTE2ZTBkYTExZQojIOKVn+KUgDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MAojIOKVoOKVkDU0MzhlOWU3LWMwZjctNDUyMy04NjgyLWZmYjgyMjM1OWQ1MAojIOKVoOKVkDAyZTU4MDEyLTVhZjYtNGI5MS1hOWE0LTA5YzlkYzAzOGYxMQojIOKVoOKVkGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YQojIOKVn+KUgDhlYjE4YzdmLWJiNGQtNGNkYy05ZTMwLWQ1NjFmOTA5OTgwMAojIOKVn+KUgDA1MmI4YmJkLWFjY2EtNGMwMC1hNWRlLTBjNzE3ZWQwNjhlMwojIOKVoOKVkGJiMDRhYzEyLTIwYTAtNDY3YS1hZjFhLWMyOTgzMDFlNDgzOAojIOKVoOKVkDM2ZmFmMThjLTExYzMtNDAxMi1hOTk2LTU1YzdjZGFlNzFhOAojIOKVoOKVkDI3OTc3NTI2LTc1ZGMtNDRjMy05OTc2LWMyMmU4Y2JkOTRkYQojIOKVn+KUgGRhM2FlMzQ4LTA4M2QtNGE3ZC1hYWJkLWQwYmMyNWIzY2ExNwojIOKVoOKVkDNjMmMyNTdlLWJiZWUtNGEwNC1iM2JhLTY4ZjIzODJmY2U4NwojIOKVn+KUgGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NgojIOKVoOKVkGNmODA3Y2IzLTVkNzUtNDA0MC1iZmQxLTA1ZmU3MGQyNmU4OQojIOKVoOKVkDU2NDk2OGZlLTBhNjgtNDhiYy05ZTExLWM3NzMyZTJiYWUwNAojIOKVn+KUgGY2NWIzMjMxLWYyYjItNDVkYy1iNzJlLTFhZDMxMDcwODNmYwojIOKVn+KUgDY3YzA4NjBiLWI0YzEtNDEyZC04NzBhLWE0Y2U0OTg3NDY1ZQojIOKVoOKVkGJkNWVjMDg2LTUxNTYtNGU3Yy1hNzBiLTVjYTlmMDg5YmI0OQojIOKVoOKVkDc4NTNjYzdmLTRlNTgtNDRkMS04ZDNiLWY4ZDQ3NDU1NjRlNgojIOKVn+KUgDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjNwojIOKVn+KUgDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkNwojIOKVoOKVkDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiYwojIOKVoOKVkGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNAojIOKVoOKVkDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYgojIOKVn+KUgDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3YwojIOKVn+KUgDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMgojIOKVoOKVkDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMgojIOKVoOKVkDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NAojIOKVoOKVkDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNgojIOKVn+KUgDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5NwojIOKVoOKVkDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNQojIOKVoOKVkGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNgojIOKVoOKVkDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YQojIOKVn+KUgDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNQojIOKVn+KUgDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNAojIOKVoOKVkDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNgojIOKVoOKVkDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZgojIOKVoOKVkDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OAojIOKVoOKVkDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjMwojIOKVoOKVkGJlMmE3ODIwLWUxOTQtNDQxMC1iMDBkLWE5MzMyYjIzNGFkNgojIOKVn+KUgDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMQojIOKVn+KUgDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMgo=";
window.pluto_disable_ui = true;
window.pluto_slider_server_url = undefined;
window.pluto_binder_url = "https://mybinder.org/v2/gh/fonsp/pluto-on-binder/v0.20.17";
window.pluto_statefile = "data:;base64,3gASpWJvbmRziqNzYnOBpXZhbHVlkZICkZKRH5EzpGZyZXGBpXZhbHVlFKNhbHSBpXZhbHVlzJaibnSBpXZhbHVlkZORAZEBkQG5dHJhbnNmb3JtZWRfdmFsdWVfZXhhbXBsZYGldmFsdWWRkpEBkQGnYXRhbnZhbIGldmFsdWWRkpEBkQGjYXNkgaV2YWx1ZZGVkQGRBpGgkaCRAaNib2iBpXZhbHVlkZGRkZGRkQG2dHJhbnNmb3JtX3NpbmdsZV9maWVsZIGldmFsdWWRlJE9kQGRA5EBp2xvbF9wb3CBpXZhbHVlkZGSkQGRBqxjZWxsX3Jlc3VsdHPeADzZJDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmDqGVsZW1lbnRzk5KhYZKhMap0ZXh0L3BsYWlukqFikqExqnRleHQvcGxhaW6SoWOSoTGqdGV4dC9wbGFpbqR0eXBlqk5hbWVkVHVwbGWob2JqZWN0aWSwMmE5YzE1NmNhNTVlNjdjNaRtaW1l2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3Sscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAk+EDSwcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDk5NmI0MDg1LTExNGMtNDhmNC05ZjkwLThlNjM3ZjI5YzA2YblkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lQLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDA1MmI4YmJkLWFjY2EtNGMwMC1hNWRlLTBjNzE3ZWQwNjhlM4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZ4zxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5UaGUgZGVzY3JpcHRpb24gb2YgYW4gPGNvZGU+QE5UQm9uZDwvY29kZT4gY2FuIG5vdyBiZSBwcm92aWRlZCBhcyBhbnl0aGluZyB0aGF0IGhhcyBhIHZhbGlkIDxjb2RlPk1JTUUmcXVvdDt0ZXh0L2h0bWwmcXVvdDs8L2NvZGU+IHJlcHJlc2VudGF0aW9uLiBUaGlzIGluY2x1ZGVzIG1hcmtkb3duIHdpdGggbWF0aCBpbnNpZGUmIzMzOzwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNZQH6r0rsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQwNTJiOGJiZC1hY2NhLTRjMDAtYTVkZS0wYzcxN2VkMDY4ZTO5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABDJDtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoB7DxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5Tb21ldGltZXMgY3VzdG9tIHN0cnVjdHMgYXJlIG5vdCBuZWVkZWQgYW5kIGl0IHdvdWxkIGJlIHVzZWZ1bCB0byBqdXN0IHVzZSB0aGUgc2FtZSBuaWNlIGJvbmQgc3RydWN0dXJlIG9mIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IHRvIHNpbXBseSBjcmVhdGUgYXJiaXRyYXJ5IE5hbWVkVHVwbGVzLiA8L3A+CjxwPlRoaXMgaXMgcG9zc2libGUgd2l0aCB0aGUgY29udmVuaWVuY2UgbWFjcm8gPGNvZGU+QE5UQm9uZDwvY29kZT4gd2hpY2ggY2FuIGJlIGNhbGxlZCBhcyBzaG93biBiZWxvdyB0byBjcmVhdGUgYSBuaWNlIGRpc3BsYXkgZm9yIGFuIGludGVyYWN0aXZlIGJvbmQgY3JlYXRpbmcgYW4gYXJiaXRyYXJ5IE5hbWVkVHVwbGUuPC9wPgo8cD5UaGUgbWFjcm8gc2ltcGx5IGNyZWF0ZSBhIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IHdyYXBwaW5nIHRoZSBkZXNpcmVkIE5hbWVkVHVwbGUgdHlwZS48L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWNjOMxXbBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQwuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAUPcrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDY3YzA4NjBiLWI0YzEtNDEyZC04NzBhLWE0Y2U0OTg3NDY1ZYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaBps8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+U29tZXRpbWVzLCBvbmUgd2FudHMgdG8gY3JlYXRlIGEgbW9yZSBjb21wbGV4IGJpbmRpbmcgd2hlcmUgdGhlIG51bWJlciBvZiBwYXJhbWV0ZXJzIHRvIGNvbnRyb2wgYSBib25kIGNhbiB2YXJ5IGRlcGVuZGluZyBvbiBzb21lIG90aGVyIHZhcmlhYmxlLiBUaGUgPGNvZGU+U3RydWN0Qm9uZFNlbGVjdDwvY29kZT4gY2FuIGJlIG9mIGhlbHAgaW4gc29tZSBvZiB0aGVzZSBjYXNlcywgYnkgcHJvdmlkaW5nIGEgd2F5IHRvIHNlbGVjdCBvdXQgb2YgYSBudW1iZXIgb2YgYXJiaXRyYXJ5IDxjb2RlPlN0cnVjdEJvbmRzPC9jb2RlPiAmIzQwO3doaWNoIGluY2x1ZGUgPGNvZGU+QE5UQm9uZDwvY29kZT4mIzQxOyBieSB1c2luZyBhIGRyb3Bkb3duIHRvIHNlbGVjdCB0aGUgb25lIHRvIGJlIGRpc3BsYXllZCBhbmQgdXNlZCBmb3IgZ2VuZXJhdGluZyB0aGUgPGNvZGU+U3RydWN0Qm9uZFNlbGVjdDwvY29kZT4gd2lkZ2V0JiMzOTtzIG91dHB1dC48L3A+CjxwPlRoaXMgc3RydWN0dXJlIGNhbiBiZSBjb25zdHJ1Y3RlZCB3aXRoIGEgdmVjdG9yIG9mIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IG9yIDxjb2RlPnRyYW5zZm9ybWVkX3ZhbHVlJiM0MDtmLCA6OlN0cnVjdEJvbmQmIzQxOzwvY29kZT4gZWxlbWVudHMsIGFuZCB3aWxsIHRha2UgY2FyZSBvZiBnZW5lcmF0aW5nIGFuIGFwcHJvcHJpYXRlIHdpZGdldCB0byBkaXNwbGF5IGFuZCBwcm9jZXNzIG9ubHkgdGhlIHNlbGVjdGVkIG9uZS48L3A+CjxwPlRoZSBtYWluIHNpZ25hdHVyZSBvZiB0aGUgY29uc3RydWN0b3IgaXMgdGhlIGZvbGxvd2luZzo8L3A+CjxwcmU+PGNvZGUgY2xhc3M9Imxhbmd1YWdlLWp1bGlhIj5TdHJ1Y3RCb25kU2VsZWN0JiM0MDtlbHM6OlZlY3RvcjsgZGVzY3JpcHRpb24gJiM2MTsgJnF1b3Q7U3RydWN0Qm9uZFNlbGVjdCZxdW90OywgZGVmYXVsdF9pZHggJiM2MTsgMSwgc2VsZWN0b3JfdGV4dCAmIzYxOyAmcXVvdDtTZWxlY3RvciZxdW90OyYjNDE7PC9jb2RlPjwvcHJlPgo8cD5UaGUgbmFtZXMgdG8gc2VsZWN0IHVwb24gd2lsbCBiZSB0YWtlbiBmcm9tIHRoZSA8Y29kZT5kZXNjcmlwdGlvbjwvY29kZT4gb2YgdGhlIHByb3ZpZGVkIDxjb2RlPlN0cnVjdEJvbmRzPC9jb2RlPiwgd2hpbGUgdGhlIHRleHQgZGlzcGxheWVkIG5leHQgdG8gdGhlIDxlbT5zZWxlY3RvcjwvZW0+IHdpbGwgZGVmYXVsdCB0byA8Y29kZT5TZWxlY3RvcjwvY29kZT4gYnV0IGNhbiBiZSBjdXN0b21pemVkIHdpdGggdGhlIDxjb2RlPnNlbGVjdG9yX3RleHQ8L2NvZGU+IGt3YXJnIHRvIHRoZSBjb25zdHJ1Y3Rvci4gVGhlIDxjb2RlPmRlc2NyaXB0aW9uPC9jb2RlPiBrd2FyZyBjYW4gYmUgdXNlZCB0byBjdXN0b21pemUgdGhlIHRleHQgaW4gdGhlIHdpZGdldCBjb250YWluZXIgJiM0MDtzaW1pbGFyIHRvIHRoZSBzYW1lIGt3YXJnIGluIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IGFuZCB0byA8Y29kZT5ATlRCb25kPC9jb2RlPiYjNDE7LiBGaW5hbGx5LCB0aGUgPGNvZGU+ZGVmYXVsdF9pZHg8L2NvZGU+IHNob3VsZCBiZSBhbiBpbnRlZ2VyIGFuZCB3aWxsIHNlbGVjdCB3aGljaCBvZiB0aGUgcHJvdmlkZWQgPGNvZGU+U3RydWN0Qm9uZDwvY29kZT5zIHdpbGwgYmUgc2VsZWN0ZWQgYXMgZGVmYXVsdCB3aGVuIGluc3RhbnRpYXRpbmcgdGhlIHdpZGdldC48L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWNjXjCg7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNjdjMDg2MGItYjRjMS00MTJkLTg3MGEtYTRjZTQ5ODc0NjVluWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAhxSbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3Y4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZODxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDEgaWQ9IlBvcG91dCI+UG9wb3V0PC9oMT4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2OCYPDsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2O5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4AAvdUtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkM2MyYzI1N2UtYmJlZS00YTA0LWIzYmEtNjhmMjM4MmZjZTg3iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedkgIk5vIFN0cmluZyBEZXNjcmlwdGlvbiBQcm92aWRlZCKkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAIm9gSsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQzYzJjMjU3ZS1iYmVlLTRhMDQtYjNiYS02OGYyMzgyZmNlODe5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4KMD2EtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoCaDxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5UaGUgZmluYWwgY29udmVuaWVuY2Ugc3RydWN0dXJlIHByb3ZpZGVkIGJ5IHRoaXMgbW9kdWxlIGlzIHRoZSA8Y29kZT5Cb25kVGFibGU8L2NvZGU+LiBJdCBjYW4gYmUgY3JlYXRlZCB0byBncm91cCBhIGxpc3Qgb2YgYm9uZHMgaW4gYSBmbG9hdGluZyB0YWJsZSB0aGF0IHN0YXlzIG9uIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIG5vdGVib29rICYjNDA7c2ltaWxhciB0byB0aGUgVGFibGVPZkNvbnRlbnRzIG9mIFBsdXRvVUkmIzQxOyBhbmQgY2FuIGJlIG1vdmVkIGFyb3VuZCBhbmQgcmVzaXplZCBvciBoaWRkZW4gZm9yIGNvbnZlbmllbmNlLjwvcD4KPHA+VGhlIEJvbmRUYWJsZSBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIGVpdGhlciB3aXRoIGJvbmRzIGNvbnRhaW5pbmcgPGNvZGU+U3RydWN0Qm9uZDwvY29kZT4gb3Igd2l0aCA8Y29kZT5Cb25kc0xpc3Q8L2NvZGU+LiBGdXR1cmUgdHlwZXMgd2l0aCBzaW1pbGFyIHN0cnVjdHVyZSB3aWxsIGFsc28gYmUgYWRkZWQuPC9wPgo8cD5IZXJlIGlzIGFuIGV4YW1wbGUgb2YgYSBib25kdGFibGUgY29udGFpbmluZyBhbGwgdGhlIGV4YW1wbGVzIG9mIHRoaXMgbm90ZWJvb2suPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo1jY43tY2wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAEy761cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ0Y2IxMjhhYS03YWQ4LTRkMTctYmNlZC0zNjg0NTcwM2U2YTiKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52gFgPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPjxjb2RlPkBOVEJvbmQ8L2NvZGU+IGlzIGFsc28gcXVpdGUgdXNlZnVsIGluIGNvbWJpbmF0aW9uIHdpdGggPGNvZGU+dHJhbnNmb3JtZWRfdmFsdWU8L2NvZGU+IGZyb20gPGNvZGU+UGx1dG9VSS5FeHBlcmltZW50YWw8L2NvZGU+LiBGb3IgdGhpcyByZWFzb24sIHRoZSA8Y29kZT5ATlRCb25kPC9jb2RlPiBtYWNybyBzdXBwb3J0cyBhbiBvcHRpb25hbCB0aGlyZCBhcmd1bWVudCB3aGljaCBzaGFsbCBiZSBhIGZ1bmN0aW9uIHRoYXQgd2hlbiBwcm92aWRlZCBpcyBkaXJlY3RseSB1c2VkIHRvIHRyYW5zZm9ybSB0aGUgdmFsdWUgb2YgdGhlIHdpZGdldC48L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWNjVsek7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNGNiMTI4YWEtN2FkOC00ZDE3LWJjZWQtMzY4NDU3MDNlNmE4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAPPULVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGJkNWVjMDg2LTUxNTYtNGU3Yy1hNzBiLTVjYTlmMDg5YmI0OYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnarQY8Ym9uZCBkZWY9InNicyIgdW5pcXVlX2lkPSJ5bHdyaHl0YWNqbG4iPjx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlIHN0cnVjdGJvbmQtc2VsZWN0Jz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+U3RydWN0Qm9uZFNlbGVjdDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naG1tdW9ncXl5cicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHN0cnVjdGJvbmQtc2VsZWN0PgogICAgPHNwYW4gY2xhc3M9InNlbGVjdG9yIj4KICAgICAgICA8c3BhbiBjbGFzcz0iZGVzY3JpcHRpb24iPk9wdGlvbnM6PC9zcGFuPgogICAgICAgIDxzZWxlY3Q+PG9wdGlvbiB2YWx1ZT0ncHVpc2VsZWN0LTEnPmNvcyhhcmcpPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT0ncHVpc2VsZWN0LTInIHNlbGVjdGVkPScnPmF0YW4oeSx4KTwvb3B0aW9uPjwvc2VsZWN0PgogICAgPC9zcGFuPgogICAgPHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA0JnF1b3Q7KSwgOmFyZyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+Y29zKGFyZyk8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2hmYm9tYm95angnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J3aXl4aWdsd2MnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2FyZyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYXJnJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhcmdgIj5hcmc8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYXJnJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd5cWNjemlqcXdhJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMDAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd5cWNjemlqcXdhJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAieXFjY3ppanF3YSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2J3aXl4aWdsd2MnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJid2l5eGlnbHdjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQo8c2NyaXB0PgoJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCglkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBOYW1lZFR1cGxlIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdoZmJvbWJveWp4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaGZib21ib3lqeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0ndGZuZHl4Y2tndCc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2Znc3p0dHVpYXgnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA1JnF1b3Q7KSwgOngsIDp5KX0nPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBjbGFzcz0nY29sbGFwc2libGUnPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KICAgICAgICA8c3BhbiBjbGFzcz0nY29sbGFwc2UtYnRuJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5hdGFuKHkseCk8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2F5ZWZ5d2Z0emEnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2JmaGpmc2Zvd2UnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J3gnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J3gnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYHhgIj54PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J3gnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2N0cGVkZHltcnMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwMScgdmFsdWU9JzMxJz48c2NyaXB0PgoJCQkJCWNvbnN0IGlucHV0X2VsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJCQkJY29uc3Qgb3V0cHV0X2VsID0gY3VycmVudFNjcmlwdC5uZXh0RWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBkaXNwbGF5cyA9IFsiMC4wIiwgIjAuMSIsICIwLjIiLCAiMC4zIiwgIjAuNCIsICIwLjUiLCAiMC42IiwgIjAuNyIsICIwLjgiLCAiMC45IiwgIjEuMCIsICIxLjEiLCAiMS4yIiwgIjEuMyIsICIxLjQiLCAiMS41IiwgIjEuNiIsICIxLjciLCAiMS44IiwgIjEuOSIsICIyLjAiLCAiMi4xIiwgIjIuMiIsICIyLjMiLCAiMi40IiwgIjIuNSIsICIyLjYiLCAiMi43IiwgIjIuOCIsICIyLjkiLCAiMy4wIiwgIjMuMSIsICIzLjIiLCAiMy4zIiwgIjMuNCIsICIzLjUiLCAiMy42IiwgIjMuNyIsICIzLjgiLCAiMy45IiwgIjQuMCIsICI0LjEiLCAiNC4yIiwgIjQuMyIsICI0LjQiLCAiNC41IiwgIjQuNiIsICI0LjciLCAiNC44IiwgIjQuOSIsICI1LjAiLCAiNS4xIiwgIjUuMiIsICI1LjMiLCAiNS40IiwgIjUuNSIsICI1LjYiLCAiNS43IiwgIjUuOCIsICI1LjkiLCAiNi4wIiwgIjYuMSIsICI2LjIiLCAiNi4zIiwgIjYuNCIsICI2LjUiLCAiNi42IiwgIjYuNyIsICI2LjgiLCAiNi45IiwgIjcuMCIsICI3LjEiLCAiNy4yIiwgIjcuMyIsICI3LjQiLCAiNy41IiwgIjcuNiIsICI3LjciLCAiNy44IiwgIjcuOSIsICI4LjAiLCAiOC4xIiwgIjguMiIsICI4LjMiLCAiOC40IiwgIjguNSIsICI4LjYiLCAiOC43IiwgIjguOCIsICI4LjkiLCAiOS4wIiwgIjkuMSIsICI5LjIiLCAiOS4zIiwgIjkuNCIsICI5LjUiLCAiOS42IiwgIjkuNyIsICI5LjgiLCAiOS45IiwgIjEwLjAiXQoKCQkJCQlsZXQgdXBkYXRlX291dHB1dCA9ICgpID0+IHsKCQkJCQkJb3V0cHV0X2VsLnZhbHVlID0gZGlzcGxheXNbaW5wdXRfZWwudmFsdWVBc051bWJlciAtIDFdCgkJCQkJfQoJCQkJCQoJCQkJCWlucHV0X2VsLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgdXBkYXRlX291dHB1dCkKCQkJCQkvLyBXZSBhbHNvIHBvbGwgZm9yIGNoYW5nZXMgYmVjYXVzZSB0aGUgYGlucHV0X2VsLnZhbHVlYCBjYW4gY2hhbmdlIGZyb20gdGhlIG91dHNpZGUsIGUuZy4gaHR0cHM6Ly9naXRodWIuY29tL0p1bGlhUGx1dG8vUGx1dG9VSS5qbC9pc3N1ZXMvMjc3CgkJCQkJbGV0IGlkID0gc2V0SW50ZXJ2YWwodXBkYXRlX291dHB1dCwgMjAwKQoJCQkJCWludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCQkJCQkJY2xlYXJJbnRlcnZhbChpZCkKCQkJCQkJaW5wdXRfZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCX0pCgkJCQkJPC9zY3JpcHQ+PG91dHB1dCBzdHlsZT0nCgkJCQkJCWZvbnQtZmFtaWx5OiBzeXN0ZW0tdWk7CiAgICAJCQkJCWZvbnQtc2l6ZTogMTVweDsKICAgIAkJCQkJbWFyZ2luLWxlZnQ6IDNweDsKICAgIAkJCQkJdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC00cHgpOwogICAgCQkJCQlkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Jz4zLjA8L291dHB1dD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdjdHBlZGR5bXJzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiY3RwZWRkeW1ycyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYmZoamZzZm93ZScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0neSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0neScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgeWAiPnk8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0neSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYmhtc2F0ZWJwdycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAxJyB2YWx1ZT0nNTEnPjxzY3JpcHQ+CgkJCQkJY29uc3QgaW5wdXRfZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBvdXRwdXRfZWwgPSBjdXJyZW50U2NyaXB0Lm5leHRFbGVtZW50U2libGluZwoJCQkJCWNvbnN0IGRpc3BsYXlzID0gWyIwLjAiLCAiMC4xIiwgIjAuMiIsICIwLjMiLCAiMC40IiwgIjAuNSIsICIwLjYiLCAiMC43IiwgIjAuOCIsICIwLjkiLCAiMS4wIiwgIjEuMSIsICIxLjIiLCAiMS4zIiwgIjEuNCIsICIxLjUiLCAiMS42IiwgIjEuNyIsICIxLjgiLCAiMS45IiwgIjIuMCIsICIyLjEiLCAiMi4yIiwgIjIuMyIsICIyLjQiLCAiMi41IiwgIjIuNiIsICIyLjciLCAiMi44IiwgIjIuOSIsICIzLjAiLCAiMy4xIiwgIjMuMiIsICIzLjMiLCAiMy40IiwgIjMuNSIsICIzLjYiLCAiMy43IiwgIjMuOCIsICIzLjkiLCAiNC4wIiwgIjQuMSIsICI0LjIiLCAiNC4zIiwgIjQuNCIsICI0LjUiLCAiNC42IiwgIjQuNyIsICI0LjgiLCAiNC45IiwgIjUuMCIsICI1LjEiLCAiNS4yIiwgIjUuMyIsICI1LjQiLCAiNS41IiwgIjUuNiIsICI1LjciLCAiNS44IiwgIjUuOSIsICI2LjAiLCAiNi4xIiwgIjYuMiIsICI2LjMiLCAiNi40IiwgIjYuNSIsICI2LjYiLCAiNi43IiwgIjYuOCIsICI2LjkiLCAiNy4wIiwgIjcuMSIsICI3LjIiLCAiNy4zIiwgIjcuNCIsICI3LjUiLCAiNy42IiwgIjcuNyIsICI3LjgiLCAiNy45IiwgIjguMCIsICI4LjEiLCAiOC4yIiwgIjguMyIsICI4LjQiLCAiOC41IiwgIjguNiIsICI4LjciLCAiOC44IiwgIjguOSIsICI5LjAiLCAiOS4xIiwgIjkuMiIsICI5LjMiLCAiOS40IiwgIjkuNSIsICI5LjYiLCAiOS43IiwgIjkuOCIsICI5LjkiLCAiMTAuMCJdCgoJCQkJCWxldCB1cGRhdGVfb3V0cHV0ID0gKCkgPT4gewoJCQkJCQlvdXRwdXRfZWwudmFsdWUgPSBkaXNwbGF5c1tpbnB1dF9lbC52YWx1ZUFzTnVtYmVyIC0gMV0KCQkJCQl9CgkJCQkJCgkJCQkJaW5wdXRfZWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCS8vIFdlIGFsc28gcG9sbCBmb3IgY2hhbmdlcyBiZWNhdXNlIHRoZSBgaW5wdXRfZWwudmFsdWVgIGNhbiBjaGFuZ2UgZnJvbSB0aGUgb3V0c2lkZSwgZS5nLiBodHRwczovL2dpdGh1Yi5jb20vSnVsaWFQbHV0by9QbHV0b1VJLmpsL2lzc3Vlcy8yNzcKCQkJCQlsZXQgaWQgPSBzZXRJbnRlcnZhbCh1cGRhdGVfb3V0cHV0LCAyMDApCgkJCQkJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCQkJCQljbGVhckludGVydmFsKGlkKQoJCQkJCQlpbnB1dF9lbC5yZW1vdmVFdmVudExpc3RlbmVyKCJpbnB1dCIsIHVwZGF0ZV9vdXRwdXQpCgkJCQkJfSkKCQkJCQk8L3NjcmlwdD48b3V0cHV0IHN0eWxlPScKCQkJCQkJZm9udC1mYW1pbHk6IHN5c3RlbS11aTsKICAgIAkJCQkJZm9udC1zaXplOiAxNXB4OwogICAgCQkJCQltYXJnaW4tbGVmdDogM3B4OwogICAgCQkJCQl0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTRweCk7CiAgICAJCQkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsnPjUuMDwvb3V0cHV0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JobXNhdGVicHcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJiaG1zYXRlYnB3Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYmZoamZzZm93ZSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJmaGpmc2Zvd2UiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE5hbWVkVHVwbGUiKQo8L3NjcmlwdD4KCTxzY3JpcHQgaWQ9J2F5ZWZ5d2Z0emEnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJheWVmeXdmdHphIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdwcmh5c3p6YW92Jz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCiAgICAgICAgY29uc3QgY29sbGFwc2VfYnRuID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuY29sbGFwc2UtYnRuJykKCiAgICAgICAgcGFyZW50LmNvbGxhcHNlID0gKCkgPT4gewogICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKICAgICAgICB9CgogICAgICAgIGNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHBhcmVudC5jb2xsYXBzZSgpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgZmllbGQtaHRtbCB7CiAgICBkaXNwbGF5OiBjb250ZW50czsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICAvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwogICAgZmxleDogMTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAgZGlzcGxheTogZmxleDsKfQoKLmNvbGxhcHNlLWJ0biB7CiAgICBkaXNwbGF5OiBub25lOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQ+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgd2lkdGg6IDEwMCU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmRlc2NyaXB0aW9uIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBhbGlnbi1zZWxmOiBjZW50ZXIKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIrKiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nem9yemR5cW51aic+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgoKICAgIDxzY3JpcHQ+CiAgICAgICAgY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KICAgICAgICBjb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwogICAgICAgIAogICAgICAgIC8vIFRoaXMgaXMgdGhlIGVsZW1lbnQgb2YgdGhlIHNlbGVjdCBkcm9wZG93bgogICAgICAgIGNvbnN0IHNlbGVjdCA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCJzZWxlY3QiKQoKICAgICAgICAvLyBUaGlzIHdpbGwgaG9sZCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHN0cnVjdGJvbmQgZWxlbWVudAogICAgICAgIGxldCBzZWxlY3RlZAoKICAgICAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldF9zZWxlY3RfdmFsdWUoKSB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0X2lucHV0X3ZhbHVlKHNlbGVjdCkKICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLnN1YnN0cmluZygxMCkpCiAgICAgICAgfQoKICAgICAgICBjb25zdCBjaGFuZ2Vfc2VsZWN0aW9uID0gKHZhbHVlLCB0cmlnZ2VyX2V2ZW50ID0gdHJ1ZSkgPT4gewogICAgICAgICAgICBzZXRfaW5wdXRfdmFsdWUoc2VsZWN0LCBgcHVpc2VsZWN0LSR7dmFsdWV9YCkKICAgICAgICAgICAgY29uc3QgYm9uZHMgPSBwYXJlbnQucXVlcnlTZWxlY3RvckFsbCgic3RydWN0LWJvbmQiKQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvbmRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoaSAhPSB2YWx1ZSAtIDEpIHsKICAgICAgICAgICAgICAgICAgICBib25kc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRkZW4iLCB0cnVlKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBib25kc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRkZW4iLCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGJvbmRzW2ldCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRyaWdnZXJfZXZlbnQpIHsKICAgICAgICAgICAgICAgIHVwZGF0ZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNoYW5nZV9zZWxlY3Rpb24oZ2V0X3NlbGVjdF92YWx1ZSgpLCBmYWxzZSkKCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgInZhbHVlIiwgewogICAgICAgICAgICBnZXQ6ICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZ2V0X3NlbGVjdF92YWx1ZSgpCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldF9pbnB1dF92YWx1ZShzZWxlY3RlZCkKICAgICAgICAgICAgICAgIHJldHVybiBbaW5kZXgsIHZhbHVlXQogICAgICAgICAgICB9LAogICAgICAgICAgICBzZXQ6IChuZXd2YWwpID0+IHsKICAgICAgICAgICAgICAgIGNoYW5nZV9zZWxlY3Rpb24obmV3dmFsWzBdLCBmYWxzZSkKICAgICAgICAgICAgICAgIHNldF9pbnB1dF92YWx1ZShzZWxlY3RlZCwgbmV3dmFsWzFdKQogICAgICAgICAgICB9LAogICAgICAgIH0pCgogICAgICAgIC8vIFdlIGFkZCBhIGxpc3RlbmVyIHRoYXQgZXh0cmFjdCB0aGUgZm9yd2FyZCB0aGUgaW5wdXQgZXZlbnQgaW4gY2FzZSB0aGUgdGFyZ2V0IG9mIHRoZSBldmVudCBpcyB0aGUgc2VsZWN0ZWQgYm9uZAogICAgICAgIGZvciAobGV0IGJvbmQgb2YgcGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInN0cnVjdC1ib25kIikpIHsKICAgICAgICAgICAgYm9uZC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgICAgICBpZiAoYm9uZCA9PSBzZWxlY3RlZCkgewogICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfQoKICAgICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCAoZSkgPT4gewogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgIGNoYW5nZV9zZWxlY3Rpb24oZ2V0X3NlbGVjdF92YWx1ZSgpKQogICAgICAgIH0pCiAgICA8L3NjcmlwdD4KICAgIDxzdHlsZT4KICAgICAgICBzdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI6Zmlyc3Qtb2YtdHlwZS5uby1wb3BvdXQ6YmVmb3JlIHsKICBkaXNwbGF5OiBub25lOwp9CgpzdHJ1Y3Rib25kLXNlbGVjdCA+IHN0cnVjdC1ib25kLmhpZGRlbiB7CiAgZGlzcGxheTogbm9uZTsKfQoKc3RydWN0Ym9uZC1zZWxlY3QsCnN0cnVjdGJvbmQtc2VsZWN0ID4gc3RydWN0LWJvbmQsCnN0cnVjdGJvbmQtc2VsZWN0IHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQoKc3RydWN0Ym9uZC1zZWxlY3QgPiAuc2VsZWN0b3IgLmRlc2NyaXB0aW9uIHsKICBjb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yLCAjNDA0MDQwKTsKfQoKc3RydWN0Ym9uZC1zZWxlY3QgPnN0cnVjdC1ib25kPnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogIGRpc3BsYXk6IG5vbmU7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCB7CiAgICBwYWRkaW5nOiA2cHggMTJweDsKICAgIGJvcmRlcjogMnB4IHNvbGlkICNlN2U3ZTc7CiAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBjb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yLCAjNDA0MDQwKTsKICAgIGZvbnQtZmFtaWx5OiBpbmhlcml0OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjJzOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgCiAgICAvKiBTaXplIGNvbnN0cmFpbnRzICovCiAgICBtYXgtd2lkdGg6IDUwcHg7IAogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIAogICAgLyogQ3VzdG9tIGFycm93IHN0eWxpbmcgKi8KICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAtbW96LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAvKiBMaWdodCBtb2RlIGFycm93IC0gIzQwNDA0MCAqLwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD1VVEYtOCwlM2NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMjQgMjQnIGZpbGw9J25vbmUnIHN0cm9rZT0nJTIzNDA0MDQwJyBzdHJva2Utd2lkdGg9JzInIHN0cm9rZS1saW5lY2FwPSdyb3VuZCcgc3Ryb2tlLWxpbmVqb2luPSdyb3VuZCclM2UlM2Nwb2x5bGluZSBwb2ludHM9JzYgOSAxMiAxNSAxOCA5JyUzZSUzYy9wb2x5bGluZSUzZSUzYy9zdmclM2UiKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiByaWdodCA4cHggY2VudGVyOwogICAgYmFja2dyb3VuZC1zaXplOiAxNnB4OwogICAgcGFkZGluZy1yaWdodDogMzJweDsKICAgIG1pbi13aWR0aDogMTIwcHg7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdDpob3ZlciB7CiAgICBib3JkZXItY29sb3I6ICNkMGQwZDA7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdDpmb2N1cyB7CiAgICBib3JkZXItY29sb3I6ICNjMGMwYzA7Cn0KCkBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHsKICAgIHN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCB7CiAgICAgICAgYm9yZGVyLWNvbG9yOiAjN2Q3ZDdkOwogICAgICAgIGNvbG9yOiB2YXIoLS1wbHV0by1vdXRwdXQtY29sb3IsICNjNGM0YzQpOwogICAgICAgIC8qIERhcmsgbW9kZSBhcnJvdyAtICNjNGM0YzQgKi8KICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PVVURi04LCUzY3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAyNCAyNCcgZmlsbD0nbm9uZScgc3Ryb2tlPSclMjNjNGM0YzQnIHN0cm9rZS13aWR0aD0nMicgc3Ryb2tlLWxpbmVjYXA9J3JvdW5kJyBzdHJva2UtbGluZWpvaW49J3JvdW5kJyUzZSUzY3BvbHlsaW5lIHBvaW50cz0nNiA5IDEyIDE1IDE4IDknJTNlJTNjL3BvbHlsaW5lJTNlJTNjL3N2ZyUzZSIpOwogICAgfQogICAgCiAgICBzdHJ1Y3Rib25kLXNlbGVjdCA+IC5zZWxlY3RvciBzZWxlY3Q6aG92ZXIgewogICAgICAgIGJvcmRlci1jb2xvcjogIzhhOGE4YTsKICAgIH0KICAgIAogICAgc3RydWN0Ym9uZC1zZWxlY3QgPiAuc2VsZWN0b3Igc2VsZWN0OmZvY3VzIHsKICAgICAgICBib3JkZXItY29sb3I6ICM3ZDdkN2Q7CiAgICB9Cn0KCi8qIEFkZCBzdHlsaW5nIGZvciBkcm9wZG93biBvcHRpb25zICovCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCBvcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuc3RydWN0Ym9uZC1zZWxlY3QgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDFweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjYzhlZGQ1OyAgCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5zdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB6LWluZGV4OiAxMDsKfQoKQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykgewogIHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5zdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI6YmVmb3JlIHsKICAgIGJhY2tncm91bmQ6ICMyNjU4MmU7ICAKICB9Cn0KICAgIDwvc3R5bGU+Cjwvc3RydWN0Ym9uZC1zZWxlY3Q+CjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlVzZSB0aGUgc2VsZWN0b3IgdG8gY2hvb3NlIHdoaWNoIFN0cnVjdEJvbmQgdG8gZGlzcGxheSBhbmQgdXNlLiIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0naG1tdW9ncXl5cic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImhtbXVvZ3F5eXIiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J3NvYWdwcXdiY2snPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KPC9ib25kPqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWWoc2JzX2JvbmSybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAI2r1esHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRiZDVlYzA4Ni01MTU2LTRlN2MtYTcwYi01Y2E5ZjA4OWJiNDm5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4enqeytXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYWmcHJlZml4o0JPSKhlbGVtZW50c5GSo21haJKFpnByZWZpeKNNQUioZWxlbWVudHORkqFhkqExqnRleHQvcGxhaW6kdHlwZaZzdHJ1Y3SscHJlZml4X3Nob3J0o01BSKhvYmplY3RpZLA1YmNhN2M2OTA2OGQ1ZmNj2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3SkdHlwZaZzdHJ1Y3SscHJlZml4X3Nob3J0o0JPSKhvYmplY3RpZLA1YmNhN2M2OWI0OTg3OTVipG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACE1MvrBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWUltXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkZTEwMjYxM2YtMjQ0Yy00YjQ5LTk4MzctNTM1YmYwNDdhMTRhiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYOoZWxlbWVudHOUkqFhkqYxLjA0NzKqdGV4dC9wbGFpbpKhYpKhNKp0ZXh0L3BsYWlukqFjkqE5qnRleHQvcGxhaW6SoWSSoTGqdGV4dC9wbGFpbqR0eXBlqk5hbWVkVHVwbGWob2JqZWN0aWSwYzllMzY1Y2MyNDQ5MzczOKRtaW1l2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3Sscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAiCGkywcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YblkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lLrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDhlYjE4YzdmLWJiNGQtNGNkYy05ZTMwLWQ1NjFmOTA5OTgwMIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZZDxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDIgaWQ9Ik1hcmtkb3duLW1hdGgtaW4tZGVzY3JpcHRpb24iPk1hcmtkb3duIG1hdGggaW4gZGVzY3JpcHRpb248L2gyPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo14wUQ8rKwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDhlYjE4YzdmLWJiNGQtNGNkYy05ZTMwLWQ1NjFmOTA5OTgwMLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgADLS+1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjWKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52To8ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgxIGlkPSJATlRCb25kIj5ATlRCb25kPC9oMT4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2M4wpKsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ0OTUxNjM3NC1mNjI1LTRhODQtYWM1Yy1mOTI0OTdkNDUwMjW5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABEqFtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkziqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedroRzxzY3JpcHQ+CgkKLy8gTG9hZCB0aGUgbGlicmFyeSBmb3IgY29uc2lzdGVudCBzbW9vdGggc2Nyb2xsaW5nCmNvbnN0IHtkZWZhdWx0OiBzY3JvbGxJbnRvVmlld30gPSBhd2FpdCBpbXBvcnQoImRhdGE6dGV4dC9qYXZhc2NyaXB0O2Jhc2U2NCxkbUZ5SUZFOVpUMCtJbTlpYW1WamRDSTlQWFI1Y0dWdlppQmxKaVp1ZFd4c0lUMWxKaVl4UFQwOVpTNXViMlJsVkhsd1pTeFZQU2hsTEhRcFBUNG9JWFI4ZkNKb2FXUmtaVzRpSVQwOVpTa21KaUoyYVhOcFlteGxJaUU5UFdVbUppSmpiR2x3SWlFOVBXVXNRVDBvWlN4MEtUMCtlMmxtS0dVdVkyeHBaVzUwU0dWcFoyaDBQR1V1YzJOeWIyeHNTR1ZwWjJoMGZIeGxMbU5zYVdWdWRGZHBaSFJvUEdVdWMyTnliMnhzVjJsa2RHZ3BlMnhsZENCc1BXZGxkRU52YlhCMWRHVmtVM1I1YkdVb1pTeHVkV3hzS1R0eVpYUjFjbTRnVlNoc0xtOTJaWEptYkc5M1dTeDBLWHg4VlNoc0xtOTJaWEptYkc5M1dDeDBLWHg4S0dVOVBudHNaWFFnZEQwb1pUMCtlMmxtS0NGbExtOTNibVZ5Ukc5amRXMWxiblI4ZkNGbExtOTNibVZ5Ukc5amRXMWxiblF1WkdWbVlYVnNkRlpwWlhjcGNtVjBkWEp1SUc1MWJHdzdkSEo1ZTNKbGRIVnliaUJsTG05M2JtVnlSRzlqZFcxbGJuUXVaR1ZtWVhWc2RGWnBaWGN1Wm5KaGJXVkZiR1Z0Wlc1MGZXTmhkR05vZTNKbGRIVnliaUJ1ZFd4c2ZYMHBLR1VwTzNKbGRIVnliaUVoZENZbUtIUXVZMnhwWlc1MFNHVnBaMmgwUEdVdWMyTnliMnhzU0dWcFoyaDBmSHgwTG1Oc2FXVnVkRmRwWkhSb1BHVXVjMk55YjJ4c1YybGtkR2dwZlNrb1pTbDljbVYwZFhKdUlURjlMRmc5S0dVc2RDeHNMRzhzYml4eUxHa3NjeWs5UG5JOFpTWW1hVDUwZkh4eVBtVW1KbWs4ZEQ4d09uSThQV1VtSm5NOFBXeDhmR2srUFhRbUpuTStQV3cvY2kxbExXODZhVDUwSmlaelBHeDhmSEk4WlNZbWN6NXNQMmt0ZEN0dU9qQXNKRDFsUFQ1bExuQmhjbVZ1ZEVWc1pXMWxiblEvUHlobExtZGxkRkp2YjNST2IyUmxLQ2t1YUc5emRIeDhiblZzYkNrc2RIUTlLR1VzZENrOVBudDJZWElnYkN4dkxHNHNjanRwWmloMGVYQmxiMllnWkc5amRXMWxiblErSW5VaUtYSmxkSFZ5Ymx0ZE8yeGxkSHR6WTNKdmJHeE5iMlJsT21rc1lteHZZMnM2Y3l4cGJteHBibVU2WVN4aWIzVnVaR0Z5ZVRwb0xITnJhWEJQZG1WeVpteHZkMGhwWkdSbGJrVnNaVzFsYm5Sek9uVjlQWFFzWnowaVpuVnVZM1JwYjI0aVBUMTBlWEJsYjJZZ2FEOW9PbVU5UG1VaFBUMW9PMmxtS0NGUktHVXBLWFJvY205M0lGUjVjR1ZGY25KdmNpZ2lTVzUyWVd4cFpDQjBZWEpuWlhRaUtUdHNaWFFnZGoxa2IyTjFiV1Z1ZEM1elkzSnZiR3hwYm1kRmJHVnRaVzUwZkh4a2IyTjFiV1Z1ZEM1a2IyTjFiV1Z1ZEVWc1pXMWxiblFzYlQxYlhTeDNQV1U3Wm05eUtEdFJLSGNwSmlabktIY3BPeWw3YVdZb0tIYzlKQ2gzS1NrOVBUMTJLWHR0TG5CMWMyZ29keWs3WW5KbFlXdDliblZzYkNFOWR5WW1kejA5UFdSdlkzVnRaVzUwTG1KdlpIa21Ka0VvZHlrbUppRkJLR1J2WTNWdFpXNTBMbVJ2WTNWdFpXNTBSV3hsYldWdWRDbDhmRzUxYkd3aFBYY21Ka0VvZHl4MUtTWW1iUzV3ZFhOb0tIY3BmV3hsZENCWFBXNTFiR3doUFNodlBXNTFiR3c5UFNoc1BYZHBibVJ2ZHk1MmFYTjFZV3hXYVdWM2NHOXlkQ2svZG05cFpDQXdPbXd1ZDJsa2RHZ3BQMjg2YVc1dVpYSlhhV1IwYUN4SVBXNTFiR3doUFNoeVBXNTFiR3c5UFNodVBYZHBibVJ2ZHk1MmFYTjFZV3hXYVdWM2NHOXlkQ2svZG05cFpDQXdPbTR1YUdWcFoyaDBLVDl5T21sdWJtVnlTR1ZwWjJoMExIdHpZM0p2Ykd4WU9sOHNjMk55YjJ4c1dUcDRmVDEzYVc1a2IzY3NlMmhsYVdkb2REcEZMSGRwWkhSb09sUXNkRzl3T2s0c2NtbG5hSFE2VEN4aWIzUjBiMjA2V1N4c1pXWjBPa045UFdVdVoyVjBRbTkxYm1ScGJtZERiR2xsYm5SU1pXTjBLQ2tzVWowaWMzUmhjblFpUFQwOWMzeDhJbTVsWVhKbGMzUWlQVDA5Y3o5T09pSmxibVFpUFQwOWN6OVpPazRyUlM4eUxGWTlJbU5sYm5SbGNpSTlQVDFoUDBNclZDOHlPaUpsYm1RaVBUMDlZVDlNT2tNc1FqMWJYVHRtYjNJb2JHVjBJRVE5TUR0RVBHMHViR1Z1WjNSb08wUXJLeWw3YkdWMElFODliVnRFWFN4N2FHVnBaMmgwT21vc2QybGtkR2c2U1N4MGIzQTZVeXh5YVdkb2REcHhMR0p2ZEhSdmJUcDZMR3hsWm5RNlJuMDlUeTVuWlhSQ2IzVnVaR2x1WjBOc2FXVnVkRkpsWTNRb0tUdHBaaWdpYVdZdGJtVmxaR1ZrSWowOVBXa21KazQrUFRBbUprTStQVEFtSmxrOFBVZ21Ka3c4UFZjbUprNCtQVk1tSmxrOFBYb21Ka00rUFVZbUprdzhQWEVwWW5KbFlXczdiR1YwSUVjOVoyVjBRMjl0Y0hWMFpXUlRkSGxzWlNoUEtTeEtQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlUR1ZtZEZkcFpIUm9MREV3S1N4TFBYQmhjbk5sU1c1MEtFY3VZbTl5WkdWeVZHOXdWMmxrZEdnc01UQXBMRkE5Y0dGeWMyVkpiblFvUnk1aWIzSmtaWEpTYVdkb2RGZHBaSFJvTERFd0tTeGFQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlRbTkwZEc5dFYybGtkR2dzTVRBcExHVmxQVEFzWlhROU1DeGxiRDBpYjJabWMyVjBWMmxrZEdnaWFXNGdUejlQTG05bVpuTmxkRmRwWkhSb0xVOHVZMnhwWlc1MFYybGtkR2d0U2kxUU9qQXNaVzg5SW05bVpuTmxkRWhsYVdkb2RDSnBiaUJQUDA4dWIyWm1jMlYwU0dWcFoyaDBMVTh1WTJ4cFpXNTBTR1ZwWjJoMExVc3RXam93TEdWdVBTSnZabVp6WlhSWGFXUjBhQ0pwYmlCUFB6QTlQVDFQTG05bVpuTmxkRmRwWkhSb1B6QTZTUzlQTG05bVpuTmxkRmRwWkhSb09qQXNaWEk5SW05bVpuTmxkRWhsYVdkb2RDSnBiaUJQUHpBOVBUMVBMbTltWm5ObGRFaGxhV2RvZEQ4d09tb3ZUeTV2Wm1aelpYUklaV2xuYUhRNk1EdHBaaWgyUFQwOVR5bGxaVDBpYzNSaGNuUWlQVDA5Y3o5U09pSmxibVFpUFQwOWN6OVNMVWc2SW01bFlYSmxjM1FpUFQwOWN6OVlLSGdzZUN0SUxFZ3NTeXhhTEhnclVpeDRLMUlyUlN4RktUcFNMVWd2TWl4bGREMGljM1JoY25RaVBUMDlZVDlXT2lKalpXNTBaWElpUFQwOVlUOVdMVmN2TWpvaVpXNWtJajA5UFdFL1ZpMVhPbGdvWHl4ZksxY3NWeXhLTEZBc1h5dFdMRjhyVml0VUxGUXBMR1ZsUFUxaGRHZ3ViV0Y0S0RBc1pXVXJlQ2tzWlhROVRXRjBhQzV0WVhnb01DeGxkQ3RmS1R0bGJITmxlMlZsUFNKemRHRnlkQ0k5UFQxelAxSXRVeTFMT2lKbGJtUWlQVDA5Y3o5U0xYb3JXaXRsYnpvaWJtVmhjbVZ6ZENJOVBUMXpQMWdvVXl4NkxHb3NTeXhhSzJWdkxGSXNVaXRGTEVVcE9sSXRLRk1yYWk4eUtTdGxieTh5TEdWMFBTSnpkR0Z5ZENJOVBUMWhQMVl0UmkxS09pSmpaVzUwWlhJaVBUMDlZVDlXTFNoR0swa3ZNaWtyWld3dk1qb2laVzVrSWowOVBXRS9WaTF4SzFBclpXdzZXQ2hHTEhFc1NTeEtMRkFyWld3c1ZpeFdLMVFzVkNrN2JHVjBlM05qY205c2JFeGxablE2Wldrc2MyTnliMnhzVkc5d09tVmtmVDFQTzJWbFBVMWhkR2d1YldGNEtEQXNUV0YwYUM1dGFXNG9aV1FyWldVdlpYSXNUeTV6WTNKdmJHeElaV2xuYUhRdGFpOWxjaXRsYnlrcExHVjBQVTFoZEdndWJXRjRLREFzVFdGMGFDNXRhVzRvWldrclpYUXZaVzRzVHk1elkzSnZiR3hYYVdSMGFDMUpMMlZ1SzJWc0tTa3NVaXM5WldRdFpXVXNWaXM5WldrdFpYUjlRaTV3ZFhOb0tIdGxiRHBQTEhSdmNEcGxaU3hzWldaME9tVjBmU2w5Y21WMGRYSnVJRUo5TEdZOVpUMCtlM1poY2lCME8zSmxkSFZ5YmlFeFBUMDlaVDk3WW14dlkyczZJbVZ1WkNJc2FXNXNhVzVsT2lKdVpXRnlaWE4wSW4wNktIUTlaU2s5UFQxUFltcGxZM1FvZENrbUpqQWhQVDFQWW1wbFkzUXVhMlY1Y3loMEtTNXNaVzVuZEdnL1pUcDdZbXh2WTJzNkluTjBZWEowSWl4cGJteHBibVU2SW01bFlYSmxjM1FpZlgwN1puVnVZM1JwYjI0Z1l5aGxMSFFwZTNaaGNpQnNPMmxtS0NGbExtbHpRMjl1Ym1WamRHVmtmSHdoS0dVOVBudHNaWFFnZEQxbE8yWnZjaWc3ZENZbWRDNXdZWEpsYm5ST2IyUmxPeWw3YVdZb2RDNXdZWEpsYm5ST2IyUmxQVDA5Wkc5amRXMWxiblFwY21WMGRYSnVJVEE3ZEQxMExuQmhjbVZ1ZEU1dlpHVWdhVzV6ZEdGdVkyVnZaaUJUYUdGa2IzZFNiMjkwUDNRdWNHRnlaVzUwVG05a1pTNW9iM04wT25RdWNHRnlaVzUwVG05a1pYMXlaWFIxY200aE1YMHBLR1VwS1hKbGRIVnlianRwWmlnaWIySnFaV04wSWowOWRIbHdaVzltS0d3OWRDa21KaUptZFc1amRHbHZiaUk5UFhSNWNHVnZaaUJzTG1KbGFHRjJhVzl5S1hKbGRIVnliaUIwTG1KbGFHRjJhVzl5S0hSMEtHVXNkQ2twTzJ4bGRDQnZQU0ppYjI5c1pXRnVJajA5ZEhsd1pXOW1JSFI4Zkc1MWJHdzlQWFEvZG05cFpDQXdPblF1WW1Wb1lYWnBiM0k3Wm05eUtHeGxkSHRsYkRwdUxIUnZjRHB5TEd4bFpuUTZhWDF2WmlCMGRDaGxMR1lvZENrcEtXNHVjMk55YjJ4c0tIdDBiM0E2Y2l4c1pXWjBPbWtzWW1Wb1lYWnBiM0k2YjMwcGZYWmhjaUJrTEhBOUtDazlQaWhrZkh3b1pEMGljR1Z5Wm05eWJXRnVZMlVpYVc0Z2QybHVaRzkzUDNCbGNtWnZjbTFoYm1ObExtNXZkeTVpYVc1a0tIQmxjbVp2Y20xaGJtTmxLVHBFWVhSbExtNXZkeWtzWkNncEtUdG1kVzVqZEdsdmJpQmlLR1VwZTJ4bGRDQjBQVTFoZEdndWJXbHVLQ2h3S0NrdFpTNXpkR0Z5ZEZScGJXVXBMMlV1WkhWeVlYUnBiMjRzTVNrc2JEMWxMbVZoYzJVb2RDa3NiejFsTG5OMFlYSjBXQ3NvWlM1NExXVXVjM1JoY25SWUtTcHNMRzQ5WlM1emRHRnlkRmtyS0dVdWVTMWxMbk4wWVhKMFdTa3FiRHRsTG0xbGRHaHZaQ2h2TEc0c2RDeHNLU3h2SVQwOVpTNTRmSHh1SVQwOVpTNTVQM0psY1hWbGMzUkJibWx0WVhScGIyNUdjbUZ0WlNnb0tUMCtZaWhsS1NrNlpTNWpZaWdwZldaMWJtTjBhVzl1SUhrb1pTeDBMR3dwZTJ4bGRDQnZQV0Z5WjNWdFpXNTBjeTVzWlc1bmRHZytNeVltZG05cFpDQXdJVDA5WVhKbmRXMWxiblJ6V3pOZFAyRnlaM1Z0Wlc1MGMxc3pYVG8yTURBc2JqMWhjbWQxYldWdWRITXViR1Z1WjNSb1BqUW1Kblp2YVdRZ01DRTlQV0Z5WjNWdFpXNTBjMXMwWFQ5aGNtZDFiV1Z1ZEhOYk5GMDZaVDArTVNzdExXVXFaU3BsS21VcVpTeHlQV0Z5WjNWdFpXNTBjeTVzWlc1bmRHZytOVDloY21kMWJXVnVkSE5iTlYwNmRtOXBaQ0F3TEdrOVlYSm5kVzFsYm5SekxteGxibWQwYUQ0MlAyRnlaM1Z0Wlc1MGMxczJYVHAyYjJsa0lEQXNjejFsTG5OamNtOXNiRXhsWm5Rc1lUMWxMbk5qY205c2JGUnZjRHRpS0h0elkzSnZiR3hoWW14bE9tVXNiV1YwYUc5a0tIUXNiQ3h2TEc0cGUyeGxkQ0J5UFUxaGRHZ3VZMlZwYkNoMEtTeHpQVTFoZEdndVkyVnBiQ2hzS1R0bExuTmpjbTlzYkV4bFpuUTljaXhsTG5OamNtOXNiRlJ2Y0QxekxHay9MaWg3ZEdGeVoyVjBPbVVzWld4aGNITmxaRHB2TEhaaGJIVmxPbTRzYkdWbWREcHlMSFJ2Y0RwemZTbDlMSE4wWVhKMFZHbHRaVHB3S0Nrc2MzUmhjblJZT25Nc2MzUmhjblJaT21Fc2VEcDBMSGs2YkN4a2RYSmhkR2x2YmpwdkxHVmhjMlU2Yml4allqcHlmU2w5ZG1GeUlFMDlaVDArWlNZbUlXVXVZbVZvWVhacGIzSjhmQ0p6Ylc5dmRHZ2lQVDA5WlM1aVpXaGhkbWx2Y2l4clBXWjFibU4wYVc5dUtHVXNkQ2w3YkdWMElHdzlkSHg4ZTMwN2NtVjBkWEp1SUUwb2JDay9ZeWhsTEh0aWJHOWphenBzTG1Kc2IyTnJMR2x1YkdsdVpUcHNMbWx1YkdsdVpTeHpZM0p2Ykd4TmIyUmxPbXd1YzJOeWIyeHNUVzlrWlN4aWIzVnVaR0Z5ZVRwc0xtSnZkVzVrWVhKNUxITnJhWEJQZG1WeVpteHZkMGhwWkdSbGJrVnNaVzFsYm5Sek9td3VjMnRwY0U5MlpYSm1iRzkzU0dsa1pHVnVSV3hsYldWdWRITXNZbVZvWVhacGIzSTZaVDArVUhKdmJXbHpaUzVoYkd3b1pTNXlaV1IxWTJVb0tHVXNkQ2s5UG50c1pYUjdaV3c2Ynl4c1pXWjBPbTRzZEc5d09uSjlQWFFzYVQxdkxuTmpjbTlzYkV4bFpuUXNjejF2TG5OamNtOXNiRlJ2Y0R0eVpYUjFjbTRnYVQwOVBXNG1Kbk05UFQxeVAyVTZXeTR1TG1Vc2JtVjNJRkJ5YjIxcGMyVW9aVDArZVNodkxHNHNjaXhzTG1SMWNtRjBhVzl1TEd3dVpXRnpaU3dvS1QwK1pTaDdaV3c2Ynl4c1pXWjBPbHRwTEc1ZExIUnZjRHBiY3l4eVhYMHBMR3d1YjI1VFkzSnZiR3hEYUdGdVoyVXBLVjE5TEZ0ZEtTbDlLVHBRY205dGFYTmxMbkpsYzI5c2RtVW9ZeWhsTEhRcEtYMDdaWGh3YjNKMGUyc2dZWE1nWkdWbVlYVnNkSDA3IikKCmNvbnN0IGluZGVudCA9IHRydWUKY29uc3QgYXNpZGUgPSB0cnVlCmNvbnN0IHRpdGxlX3RleHQgPSAiVGFibGUgb2YgQ29udGVudHMiCmNvbnN0IGluY2x1ZGVfZGVmaW5pdGlvbnMgPSBmYWxzZQoKCmNvbnN0IHRvY05vZGUgPSBodG1sYDxuYXYgY2xhc3M9InBsdXRvdWktdG9jIj4KCTxoZWFkZXI+CgkgPHNwYW4gY2xhc3M9InRvYy10b2dnbGUgb3Blbi10b2MiPjwvc3Bhbj4KCSA8c3BhbiBjbGFzcz0idG9jLXRvZ2dsZSBjbG9zZWQtdG9jIj48L3NwYW4+CgkgJHt0aXRsZV90ZXh0fQoJPC9oZWFkZXI+Cgk8c2VjdGlvbj48L3NlY3Rpb24+CjwvbmF2PmAKCnRvY05vZGUuY2xhc3NMaXN0LnRvZ2dsZSgiYXNpZGUiLCBhc2lkZSkKdG9jTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCJpbmRlbnQiLCBpbmRlbnQpCgoKY29uc3QgZ2V0UGFyZW50Q2VsbCA9IGVsID0+IGVsLmNsb3Nlc3QoInBsdXRvLWNlbGwiKQoKY29uc3QgZ2V0SGVhZGVycyA9ICgpID0+IHsKCWNvbnN0IGRlcHRoID0gTWF0aC5tYXgoMSwgTWF0aC5taW4oNiwgMykpIC8vIHNob3VsZCBiZSBpbiByYW5nZSAxOjYKCWNvbnN0IHJhbmdlID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiBkZXB0aH0sICh4LCBpKSA9PiBpKzEpIC8vIFsxLCAuLi4sIGRlcHRoXQoJCgljb25zdCBzZWxlY3RvciA9IFsKCQkuLi4oaW5jbHVkZV9kZWZpbml0aW9ucyA/IFsKCQkJYHBsdXRvLW5vdGVib29rIHBsdXRvLWNlbGwgLnBsdXRvLWRvY3MtYmluZGluZ2AsIAoJCQlgcGx1dG8tbm90ZWJvb2sgcGx1dG8tY2VsbCBhc3NpZ25lZTpub3QoOmVtcHR5KWAsIAoJCV0gOiBbXSksCgkJLi4ucmFuZ2UubWFwKGkgPT4gYHBsdXRvLW5vdGVib29rIHBsdXRvLWNlbGwgaCR7aX1gKQoJXS5qb2luKCIsIikKCXJldHVybiBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKS5maWx0ZXIoZWwgPT4gCgkJLy8gZXhjbHVkZSBoZWFkZXJzIGluc2lkZSBvZiBhIHBsdXRvLWRvY3MtYmluZGluZyBibG9jawoJCSEoZWwubm9kZU5hbWUuc3RhcnRzV2l0aCgiSCIpICYmIGVsLmNsb3Nlc3QoIi5wbHV0by1kb2NzLWJpbmRpbmciKSkgJiYgIWVsLmNsYXNzTGlzdC5jb250YWlucygibm8tdG9jIikKCSkKfQoKCmNvbnN0IGRvY3VtZW50X2NsaWNrX2hhbmRsZXIgPSAoZXZlbnQpID0+IHsKCWNvbnN0IHBhdGggPSAoZXZlbnQucGF0aCB8fCBldmVudC5jb21wb3NlZFBhdGgoKSkKCWNvbnN0IHRvYyA9IHBhdGguZmluZChlbGVtID0+IGVsZW0/LmNsYXNzTGlzdD8uY29udGFpbnM/LigidG9jLXRvZ2dsZSIpKQoJaWYgKHRvYykgewoJCWV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpCgkJdG9jLmNsb3Nlc3QoIi5wbHV0b3VpLXRvYyIpLmNsYXNzTGlzdC50b2dnbGUoImhpZGUiKQoJfQp9Cgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGRvY3VtZW50X2NsaWNrX2hhbmRsZXIpCgoKY29uc3QgaGVhZGVyX3RvX2luZGV4X2VudHJ5X21hcCA9IG5ldyBNYXAoKQpjb25zdCBjdXJyZW50bHlfaGlnaGxpZ2h0ZWRfc2V0ID0gbmV3IFNldCgpCgpjb25zdCBsYXN0X3RvY19lbGVtZW50X2NsaWNrX3RpbWUgPSB7IGN1cnJlbnQ6IDAgfQoKY29uc3QgaW50ZXJzZWN0aW9uX2NhbGxiYWNrID0gKGl4cykgPT4gewoJbGV0IG9uX3RvcCA9IGl4cy5maWx0ZXIoaXggPT4gaXguaW50ZXJzZWN0aW9uUmF0aW8gPiAwICYmIGl4LmludGVyc2VjdGlvblJlY3QueSA8IGl4LnJvb3RCb3VuZHMuaGVpZ2h0IC8gMikKCWlmKG9uX3RvcC5sZW5ndGggPiAwKXsKCQljdXJyZW50bHlfaGlnaGxpZ2h0ZWRfc2V0LmZvckVhY2goYSA9PiBhLmNsYXNzTGlzdC5yZW1vdmUoImluLXZpZXciKSkKCQljdXJyZW50bHlfaGlnaGxpZ2h0ZWRfc2V0LmNsZWFyKCkKCQlvbl90b3Auc2xpY2UoMCwxKS5mb3JFYWNoKGkgPT4gewoJCQlsZXQgZGl2ID0gaGVhZGVyX3RvX2luZGV4X2VudHJ5X21hcC5nZXQoaS50YXJnZXQpCgkJCWRpdi5jbGFzc0xpc3QuYWRkKCJpbi12aWV3IikKCQkJY3VycmVudGx5X2hpZ2hsaWdodGVkX3NldC5hZGQoZGl2KQoJCQkKCQkJLy8vIHNjcm9sbCBpbnRvIHZpZXcKCQkJLyoKCQkJY29uc3QgdG9jX2hlaWdodCA9IHRvY05vZGUub2Zmc2V0SGVpZ2h0CgkJCWNvbnN0IGRpdl9wb3MgPSBkaXYub2Zmc2V0VG9wCgkJCWNvbnN0IGRpdl9oZWlnaHQgPSBkaXYub2Zmc2V0SGVpZ2h0CgkJCWNvbnN0IGN1cnJlbnRfc2Nyb2xsID0gdG9jTm9kZS5zY3JvbGxUb3AKCQkJY29uc3QgaGVhZGVyX2hlaWdodCA9IHRvY05vZGUucXVlcnlTZWxlY3RvcigiaGVhZGVyIikub2Zmc2V0SGVpZ2h0CgkJCQoJCQljb25zdCBzY3JvbGxfdG9fdG9wID0gZGl2X3BvcyAtIGhlYWRlcl9oZWlnaHQKCQkJY29uc3Qgc2Nyb2xsX3RvX2JvdHRvbSA9IGRpdl9wb3MgKyBkaXZfaGVpZ2h0IC0gdG9jX2hlaWdodAoJCQkKCQkJLy8gaWYgd2Ugc2V0IGEgc2Nyb2xsVG9wLCB0aGVuIHRoZSBicm93c2VyIHdpbGwgc3RvcCBhbnkgY3VycmVudGx5IG9uZ29pbmcgc21vb3Roc2Nyb2xsIGFuaW1hdGlvbi4gU28gbGV0J3Mgb25seSBkbyB0aGlzIGlmIHlvdSBhcmUgbm90IGN1cnJlbnRseSBpbiBhIHNtb290aHNjcm9sbC4KCQkJaWYoRGF0ZS5ub3coKSAtIGxhc3RfdG9jX2VsZW1lbnRfY2xpY2tfdGltZS5jdXJyZW50ID49IDIwMDApCgkJCQlpZihjdXJyZW50X3Njcm9sbCA8IHNjcm9sbF90b19ib3R0b20pewoJCQkJCXRvY05vZGUuc2Nyb2xsVG9wID0gc2Nyb2xsX3RvX2JvdHRvbQoJCQkJfSBlbHNlIGlmKGN1cnJlbnRfc2Nyb2xsID4gc2Nyb2xsX3RvX3RvcCl7CgkJCQkJdG9jTm9kZS5zY3JvbGxUb3AgPSBzY3JvbGxfdG9fdG9wCgkJCQl9CgkJCSovCgkJfSkKCX0KfQpsZXQgaW50ZXJzZWN0aW9uX29ic2VydmVyXzEgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoaW50ZXJzZWN0aW9uX2NhbGxiYWNrLCB7Cglyb290OiBudWxsLCAvLyBpLmUuIHRoZSB2aWV3cG9ydAogIAl0aHJlc2hvbGQ6IDEsCglyb290TWFyZ2luOiAiLTE1cHgiLCAvLyBzbGlnaHRseSBzbWFsbGVyIHRoYW4gdGhlIHZpZXdwb3J0CgkvLyBkZWxheTogMTAwLAp9KQpsZXQgaW50ZXJzZWN0aW9uX29ic2VydmVyXzIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoaW50ZXJzZWN0aW9uX2NhbGxiYWNrLCB7Cglyb290OiBudWxsLCAvLyBpLmUuIHRoZSB2aWV3cG9ydAogIAl0aHJlc2hvbGQ6IDEsCglyb290TWFyZ2luOiAiMTVweCIsIC8vIHNsaWdodGx5IGxhcmdlciB0aGFuIHRoZSB2aWV3cG9ydAoJLy8gZGVsYXk6IDEwMCwKfSkKCmNvbnN0IHJlbmRlciA9IChlbGVtZW50cykgPT4gewoJaGVhZGVyX3RvX2luZGV4X2VudHJ5X21hcC5jbGVhcigpCgljdXJyZW50bHlfaGlnaGxpZ2h0ZWRfc2V0LmNsZWFyKCkKCWludGVyc2VjdGlvbl9vYnNlcnZlcl8xLmRpc2Nvbm5lY3QoKQoJaW50ZXJzZWN0aW9uX29ic2VydmVyXzIuZGlzY29ubmVjdCgpCgoJCWxldCBsYXN0X2xldmVsID0gYEgxYAoJcmV0dXJuIGh0bWxgJHtlbGVtZW50cy5tYXAoaCA9PiB7Cgljb25zdCBwYXJlbnRfY2VsbCA9IGdldFBhcmVudENlbGwoaCkKCgkJbGV0IFtjbGFzc05hbWUsIHRpdGxlX2VsXSA9IGgubWF0Y2hlcyhgLnBsdXRvLWRvY3MtYmluZGluZ2ApID8gWyJwbHV0by1kb2NzLWJpbmRpbmctZWwiLCBoLmZpcnN0RWxlbWVudENoaWxkXSA6IFtoLm5vZGVOYW1lLCBoXQoKCWNvbnN0IGlkID0gdGl0bGVfZWwubWF0Y2hlcygiYXNzaWduZWUiKSA/CgkJdGl0bGVfZWwuaW5uZXJUZXh0LnJlcGxhY2UoL15jb25zdCAvLCAiIikgOgoJCXRpdGxlX2VsLmlkID8KCQl0aXRsZV9lbC5pZCA6CgkJcGFyZW50X2NlbGwuaWQKCQoJY29uc3QgaW5uZXJfaHRtbCA9IHRpdGxlX2VsLmlubmVySFRNTAoJCQoJY29uc3QgYSA9IGh0bWxgPGEgCgkJY2xhc3M9IiR7Y2xhc3NOYW1lfSIgCgkJdGl0bGU9IiR7dGl0bGVfZWwuaW5uZXJUZXh0fSIKCQlocmVmPSIjJHtpZH0iCgk+JHtpbm5lcl9odG1sfTwvYT5gCgkvKiBhLm9ubW91c2VvdmVyPSgpPT57CgkJcGFyZW50X2NlbGwuZmlyc3RFbGVtZW50Q2hpbGQuY2xhc3NMaXN0LmFkZCgKCQkJJ2hpZ2hsaWdodC1wbHV0by1jZWxsLXNob3VsZGVyJwoJCSkKCX0KCWEub25tb3VzZW91dD0oKSA9PiB7CgkJcGFyZW50X2NlbGwuZmlyc3RFbGVtZW50Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgKCQkJJ2hpZ2hsaWdodC1wbHV0by1jZWxsLXNob3VsZGVyJwoJCSkKCX0gKi8KCQkKCQkKCWEub25jbGljaz0oZSkgPT4gewoJCWUucHJldmVudERlZmF1bHQoKTsKCQloaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBudWxsLCBhLmhyZWYpCgkJbGFzdF90b2NfZWxlbWVudF9jbGlja190aW1lLmN1cnJlbnQgPSBEYXRlLm5vdygpCgkJc2Nyb2xsSW50b1ZpZXcoaCwgewoJCQliZWhhdmlvcjogJ3Ntb290aCcsIAoJCQlibG9jazogJ3N0YXJ0JywKCQl9KS50aGVuKCgpID0+IAoJCQkvLyBzb21ldGltZXMgaXQgZG9lc24ndCBzY3JvbGwgdG8gdGhlIHJpZ2h0IHBsYWNlCgkJCS8vIHNvbHV0aW9uOiB0cnkgYSBzZWNvbmQgdGltZSEKCQkJc2Nyb2xsSW50b1ZpZXcoaCwgewoJCQkJYmVoYXZpb3I6ICdzbW9vdGgnLCAKCQkJCWJsb2NrOiAnc3RhcnQnLAoJCQl9KQoJICAgKQoJfQoJICAgCgkvLyBSZW1vdmUgYW55IGBpZGAgYXR0cmlidXRlcyByZWN1cnNpdmVseSwgYmVjYXVzZSB0aGV5IG1heSBpbnRlcmZlcmUgd2l0aCBsaW5raW5nLXRvLWlkIHVzaW5nIGAjYAoJY29uc3QgcmVtb3ZlSWRBdHRyaWJ1dGVzID0gKGVsKSA9PiB7CgkJaWYgKGVsICYmIGVsLm5vZGVUeXBlID09PSAxKSB7IC8vIEVsZW1lbnQgbm9kZQoJCQlpZiAoZWwuaGFzQXR0cmlidXRlPy4oImlkIikpIGVsLnJlbW92ZUF0dHJpYnV0ZT8uKCJpZCIpCgkJCWVsLmNoaWxkTm9kZXMuZm9yRWFjaChyZW1vdmVJZEF0dHJpYnV0ZXMpCgkJfQoJfQoJcmVtb3ZlSWRBdHRyaWJ1dGVzKGEpCgoJLy8gUmVtb3ZlIENsaWNrLVRvLUNvcHktSGVhZGVyLUlEIGZlYXR1cmUKCWEucXVlcnlTZWxlY3RvckFsbCgicGx1dG8taGVhZGVyLWlkLWNvcHktd3JhcHBlciIpLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlKCkpCgoJY29uc3Qgcm93ID0gIGh0bWxgPGRpdiBjbGFzcz0idG9jLXJvdyAke2NsYXNzTmFtZX0gYWZ0ZXItJHtsYXN0X2xldmVsfSI+JHthfTwvZGl2PmAKCQlpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMS5vYnNlcnZlKHRpdGxlX2VsKQoJCWludGVyc2VjdGlvbl9vYnNlcnZlcl8yLm9ic2VydmUodGl0bGVfZWwpCgkJaGVhZGVyX3RvX2luZGV4X2VudHJ5X21hcC5zZXQodGl0bGVfZWwsIHJvdykKCglpZihjbGFzc05hbWUuc3RhcnRzV2l0aCgiSCIpKQoJCWxhc3RfbGV2ZWwgPSBjbGFzc05hbWUKCQkKCXJldHVybiByb3cKfSl9YAp9Cgpjb25zdCBpbnZhbGlkYXRlZCA9IHsgY3VycmVudDogZmFsc2UgfQoKY29uc3QgdXBkYXRlQ2FsbGJhY2sgPSAoKSA9PiB7CglpZiAoIWludmFsaWRhdGVkLmN1cnJlbnQpIHsKCQl0b2NOb2RlLnF1ZXJ5U2VsZWN0b3IoInNlY3Rpb24iKS5yZXBsYWNlV2l0aCgKCQkJaHRtbGA8c2VjdGlvbj4ke3JlbmRlcihnZXRIZWFkZXJzKCkpfTwvc2VjdGlvbj5gCgkJKQoJfQp9CnVwZGF0ZUNhbGxiYWNrKCkKc2V0VGltZW91dCh1cGRhdGVDYWxsYmFjaywgMTAwKQpzZXRUaW1lb3V0KHVwZGF0ZUNhbGxiYWNrLCAxMDAwKQpzZXRUaW1lb3V0KHVwZGF0ZUNhbGxiYWNrLCA1MDAwKQoKY29uc3Qgbm90ZWJvb2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJwbHV0by1ub3RlYm9vayIpCgoKLy8gV2UgaGF2ZSBhIG11dGF0aW9ub2JzZXJ2ZXIgZm9yIGVhY2ggY2VsbDoKY29uc3QgbXV0X29ic2VydmVycyA9IHsKCWN1cnJlbnQ6IFtdLAp9Cgpjb25zdCBjcmVhdGVDZWxsT2JzZXJ2ZXJzID0gKCkgPT4gewoJbXV0X29ic2VydmVycy5jdXJyZW50LmZvckVhY2goKG8pID0+IG8uZGlzY29ubmVjdCgpKQoJbXV0X29ic2VydmVycy5jdXJyZW50ID0gQXJyYXkuZnJvbShub3RlYm9vay5xdWVyeVNlbGVjdG9yQWxsKCJwbHV0by1jZWxsIikpLm1hcChlbCA9PiB7CgkJY29uc3QgbyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHVwZGF0ZUNhbGxiYWNrKQoJCW8ub2JzZXJ2ZShlbCwge2F0dHJpYnV0ZUZpbHRlcjogWyJjbGFzcyJdfSkKCQlyZXR1cm4gbwoJfSkKfQpjcmVhdGVDZWxsT2JzZXJ2ZXJzKCkKCi8vIEFuZCBvbmUgZm9yIHRoZSBub3RlYm9vaydzIGNoaWxkIGxpc3QsIHdoaWNoIHVwZGF0ZXMgb3VyIGNlbGwgb2JzZXJ2ZXJzOgpjb25zdCBub3RlYm9va09ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4gewoJdXBkYXRlQ2FsbGJhY2soKQoJY3JlYXRlQ2VsbE9ic2VydmVycygpCn0pCm5vdGVib29rT2JzZXJ2ZXIub2JzZXJ2ZShub3RlYm9vaywge2NoaWxkTGlzdDogdHJ1ZX0pCgovLyBBbmQgZmluYWxseSwgYW4gb2JzZXJ2ZXIgZm9yIHRoZSBkb2N1bWVudC5ib2R5IGNsYXNzTGlzdCwgdG8gbWFrZSBzdXJlIHRoYXQgdGhlIHRvYyBhbHNvIHdvcmtzIHdoZW4gaXQgaXMgbG9hZGVkIGR1cmluZyBub3RlYm9vayBpbml0aWFsaXphdGlvbgpjb25zdCBib2R5Q2xhc3NPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHVwZGF0ZUNhbGxiYWNrKQpib2R5Q2xhc3NPYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHthdHRyaWJ1dGVGaWx0ZXI6IFsiY2xhc3MiXX0pCgovLyBIaWRlL3Nob3cgdGhlIFRvQyB3aGVuIHRoZSBzY3JlZW4gZ2V0cyBzbWFsbApsZXQgbWF0Y2hfbGlzdGVuZXIgPSAoKSA9PiB7Cgljb25zdCBzbWFsbCA9ICh0b2NOb2RlLmNsb3Nlc3QoInBsdXRvLWVkaXRvciIpID8/IGRvY3VtZW50LmJvZHkpLnNjcm9sbFdpZHRoIDwgMTAwMAoJdG9jTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCJzbWFsbHNjcmVlbiIsIHNtYWxsKQoJdG9jTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRlIiwgc21hbGwpCn0KZm9yKGxldCBzIG9mIFsxMDAwLCAxMTAwLCAxMjAwLCAxMzAwLCAxNDAwLCAxNTAwLCAxNjAwLCAxNzAwLCAxODAwLCAxOTAwLCAyMDAwXSkgewoJbGV0IG0gPSBtYXRjaE1lZGlhKGAobWF4LXdpZHRoOiAke3N9cHgpYCkKCW0uYWRkTGlzdGVuZXIobWF0Y2hfbGlzdGVuZXIpCglpbnZhbGlkYXRpb24udGhlbigoKSA9PiBtLnJlbW92ZUxpc3RlbmVyKG1hdGNoX2xpc3RlbmVyKSkKfQptYXRjaF9saXN0ZW5lcigpCgppbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CglpbnZhbGlkYXRlZC5jdXJyZW50ID0gdHJ1ZQoJaW50ZXJzZWN0aW9uX29ic2VydmVyXzEuZGlzY29ubmVjdCgpCglpbnRlcnNlY3Rpb25fb2JzZXJ2ZXJfMi5kaXNjb25uZWN0KCkKCW5vdGVib29rT2JzZXJ2ZXIuZGlzY29ubmVjdCgpCglib2R5Q2xhc3NPYnNlcnZlci5kaXNjb25uZWN0KCkKCW11dF9vYnNlcnZlcnMuY3VycmVudC5mb3JFYWNoKChvKSA9PiBvLmRpc2Nvbm5lY3QoKSkKCWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIiwgZG9jdW1lbnRfY2xpY2tfaGFuZGxlcikKfSkKCnJldHVybiB0b2NOb2RlCjwvc2NyaXB0Pgo8c3R5bGU+CkBtZWRpYSBub3QgcHJpbnQgewoKLnBsdXRvdWktdG9jIHsKCWZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywgT3h5Z2VuLVNhbnMsIENhbnRhcmVsbCwgIkFwcGxlIENvbG9yIEVtb2ppIiwKCQkiU2Vnb2UgVUkgRW1vamkiLCAiU2Vnb2UgVUkgU3ltYm9sIiwgc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwoJLS1tYWluLWJnLWNvbG9yOiAjZmFmYWZhOwoJLS1wbHV0by1vdXRwdXQtY29sb3I6IGhzbCgwLCAwJSwgMzYlKTsKCS0tcGx1dG8tb3V0cHV0LWgtY29sb3I6IGhzbCgwLCAwJSwgMjElKTsKCS0tc2lkZWJhci1saS1hY3RpdmUtYmc6IHJnYigyMzUsIDIzNSwgMjM1KTsKCS0taWNvbi1maWx0ZXI6IHVuc2V0Owp9CgpAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CgkucGx1dG91aS10b2MgewoJCS0tbWFpbi1iZy1jb2xvcjogIzMwMzAzMDsKCQktLXBsdXRvLW91dHB1dC1jb2xvcjogaHNsKDAsIDAlLCA5MCUpOwoJCS0tcGx1dG8tb3V0cHV0LWgtY29sb3I6IGhzbCgwLCAwJSwgOTclKTsKCQktLXNpZGViYXItbGktYWN0aXZlLWJnOiByZ2IoODIsIDgyLCA4Mik7CgkJLS1pY29uLWZpbHRlcjogaW52ZXJ0KDEpOwoJfQp9CgoucGx1dG91aS10b2MuYXNpZGUgewoJY29sb3I6IHZhcigtLXBsdXRvLW91dHB1dC1jb2xvcik7Cglwb3NpdGlvbjogZml4ZWQ7CglyaWdodDogMXJlbTsKCXRvcDogNXJlbTsKCXdpZHRoOiBtaW4oODB2dywgMzAwcHgpOwoJcGFkZGluZzogMC41cmVtOwoJcGFkZGluZy10b3A6IDBlbTsKCS8qIGJvcmRlcjogM3B4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xNSk7ICovCglib3JkZXItcmFkaXVzOiAxMHB4OwoJbWF4LWhlaWdodDogY2FsYygxMDB2aCAtIDVyZW0gLSA5MHB4KTsKCW92ZXJmbG93OiBhdXRvOwoJei1pbmRleDogNDA7CgliYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1tYWluLWJnLWNvbG9yKTsKCXRyYW5zaXRpb246IHRyYW5zZm9ybSAzMDBtcyBjdWJpYy1iZXppZXIoMC4xOCwgMC44OSwgMC40NSwgMS4xMik7Cn0KCi5wbHV0b3VpLXRvYy5zbWFsbHNjcmVlbjpub3QoLmhpZGUpIHsKCWJveC1zaGFkb3c6IDAgMCAxMXB4IDBweCAjMDAwMDAwMTA7Cn0KCi5wbHV0b3VpLXRvYy5hc2lkZS5oaWRlIHsKCXRyYW5zZm9ybTogdHJhbnNsYXRlWChjYWxjKDEwMCUgLSAyOHB4KSk7Cgljb2xvcjogdHJhbnNwYXJlbnQ7Cn0KLnBsdXRvdWktdG9jLmFzaWRlLmhpZGUgc2VjdGlvbiB7CglkaXNwbGF5OiBub25lOwp9Ci5wbHV0b3VpLXRvYy5hc2lkZS5oaWRlIGhlYWRlciB7CgltYXJnaW4tYm90dG9tOiAwZW07CglwYWRkaW5nLWJvdHRvbTogMGVtOwoJYm9yZGVyLWJvdHRvbTogbm9uZTsKfQp9ICAvKiBFbmQgb2YgTWVkaWEgcHJpbnQgcXVlcnkgKi8KLnBsdXRvdWktdG9jLmFzaWRlLmhpZGUgLm9wZW4tdG9jLAoucGx1dG91aS10b2MuYXNpZGU6bm90KC5oaWRlKSAuY2xvc2VkLXRvYywKLnBsdXRvdWktdG9jOm5vdCguYXNpZGUpIC5jbG9zZWQtdG9jIHsKCWRpc3BsYXk6IG5vbmU7Cn0KCkBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbikgewogIC5wbHV0b3VpLXRvYy5hc2lkZSB7Cgl0cmFuc2l0aW9uLWR1cmF0aW9uOiAwczsKICB9Cn0KCi50b2MtdG9nZ2xlIHsKCWN1cnNvcjogcG9pbnRlcjsKICAgIHBhZGRpbmc6IDFlbTsKICAgIG1hcmdpbjogLTFlbTsKICAgIG1hcmdpbi1yaWdodDogLTAuN2VtOwogICAgbGluZS1oZWlnaHQ6IDFlbTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi50b2MtdG9nZ2xlOjpiZWZvcmUgewogICAgY29udGVudDogIiI7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICBoZWlnaHQ6IDFlbTsKICAgIHdpZHRoOiAxZW07CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvbGlzdC1vdXRsaW5lLnN2ZyIpOwoJLyogZ2VuZXJhdGVkIHVzaW5nIGh0dHBzOi8vZG9waWF6YS5vcmcvdG9vbHMvZGF0YXVyaS9pbmRleC5waHAgKi8KICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0kxTVRJaUlHaGxhV2RvZEQwaU5URXlJaUIyYVdWM1FtOTRQU0l3SURBZ05URXlJRFV4TWlJK1BIUnBkR3hsUG1sdmJtbGpiMjV6TFhZMUxXODhMM1JwZEd4bFBqeHNhVzVsSUhneFBTSXhOakFpSUhreFBTSXhORFFpSUhneVBTSTBORGdpSUhreVBTSXhORFFpSUhOMGVXeGxQU0ptYVd4c09tNXZibVU3YzNSeWIydGxPaU13TURBN2MzUnliMnRsTFd4cGJtVmpZWEE2Y205MWJtUTdjM1J5YjJ0bExXeHBibVZxYjJsdU9uSnZkVzVrTzNOMGNtOXJaUzEzYVdSMGFEb3pNbkI0SWk4K1BHeHBibVVnZURFOUlqRTJNQ0lnZVRFOUlqSTFOaUlnZURJOUlqUTBPQ0lnZVRJOUlqSTFOaUlnYzNSNWJHVTlJbVpwYkd3NmJtOXVaVHR6ZEhKdmEyVTZJekF3TUR0emRISnZhMlV0YkdsdVpXTmhjRHB5YjNWdVpEdHpkSEp2YTJVdGJHbHVaV3B2YVc0NmNtOTFibVE3YzNSeWIydGxMWGRwWkhSb09qTXljSGdpTHo0OGJHbHVaU0I0TVQwaU1UWXdJaUI1TVQwaU16WTRJaUI0TWowaU5EUTRJaUI1TWowaU16WTRJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxPM04wY205clpUb2pNREF3TzNOMGNtOXJaUzFzYVc1bFkyRndPbkp2ZFc1a08zTjBjbTlyWlMxc2FXNWxhbTlwYmpweWIzVnVaRHR6ZEhKdmEyVXRkMmxrZEdnNk16SndlQ0l2UGp4amFYSmpiR1VnWTNnOUlqZ3dJaUJqZVQwaU1UUTBJaUJ5UFNJeE5pSWdjM1I1YkdVOUltWnBiR3c2Ym05dVpUdHpkSEp2YTJVNkl6QXdNRHR6ZEhKdmEyVXRiR2x1WldOaGNEcHliM1Z1WkR0emRISnZhMlV0YkdsdVpXcHZhVzQ2Y205MWJtUTdjM1J5YjJ0bExYZHBaSFJvT2pNeWNIZ2lMejQ4WTJseVkyeGxJR040UFNJNE1DSWdZM2s5SWpJMU5pSWdjajBpTVRZaUlITjBlV3hsUFNKbWFXeHNPbTV2Ym1VN2MzUnliMnRsT2lNd01EQTdjM1J5YjJ0bExXeHBibVZqWVhBNmNtOTFibVE3YzNSeWIydGxMV3hwYm1WcWIybHVPbkp2ZFc1a08zTjBjbTlyWlMxM2FXUjBhRG96TW5CNElpOCtQR05wY21Oc1pTQmplRDBpT0RBaUlHTjVQU0l6TmpnaUlISTlJakUySWlCemRIbHNaVDBpWm1sc2JEcHViMjVsTzNOMGNtOXJaVG9qTURBd08zTjBjbTlyWlMxc2FXNWxZMkZ3T25KdmRXNWtPM04wY205clpTMXNhVzVsYW05cGJqcHliM1Z1WkR0emRISnZhMlV0ZDJsa2RHZzZNekp3ZUNJdlBqd3ZjM1puUGc9PSIpOwogICAgYmFja2dyb3VuZC1zaXplOiAxZW07CglmaWx0ZXI6IHZhcigtLWljb24tZmlsdGVyKTsKfQoKLmFzaWRlIC50b2MtdG9nZ2xlLm9wZW4tdG9jOmhvdmVyOjpiZWZvcmUgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2Fycm93LWZvcndhcmQtb3V0bGluZS5zdmciKTsKCS8qIGdlbmVyYXRlZCB1c2luZyBodHRwczovL2RvcGlhemEub3JnL3Rvb2xzL2RhdGF1cmkvaW5kZXgucGhwICovCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJMU1USWlJR2hsYVdkb2REMGlOVEV5SWlCMmFXVjNRbTk0UFNJd0lEQWdOVEV5SURVeE1pSStQSFJwZEd4bFBtbHZibWxqYjI1ekxYWTFMV0U4TDNScGRHeGxQanh3YjJ4NWJHbHVaU0J3YjJsdWRITTlJakkyT0NBeE1USWdOREV5SURJMU5pQXlOamdnTkRBd0lpQnpkSGxzWlQwaVptbHNiRHB1YjI1bE8zTjBjbTlyWlRvak1EQXdPM04wY205clpTMXNhVzVsWTJGd09uSnZkVzVrTzNOMGNtOXJaUzFzYVc1bGFtOXBianB5YjNWdVpEdHpkSEp2YTJVdGQybGtkR2c2TkRod2VDSXZQanhzYVc1bElIZ3hQU0l6T1RJaUlIa3hQU0l5TlRZaUlIZ3lQU0l4TURBaUlIa3lQU0l5TlRZaUlITjBlV3hsUFNKbWFXeHNPbTV2Ym1VN2MzUnliMnRsT2lNd01EQTdjM1J5YjJ0bExXeHBibVZqWVhBNmNtOTFibVE3YzNSeWIydGxMV3hwYm1WcWIybHVPbkp2ZFc1a08zTjBjbTlyWlMxM2FXUjBhRG8wT0hCNElpOCtQQzl6ZG1jKyIpOwp9Ci5hc2lkZSAudG9jLXRvZ2dsZS5jbG9zZWQtdG9jOmhvdmVyOjpiZWZvcmUgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2Fycm93LWJhY2stb3V0bGluZS5zdmciKTsKCS8qIGdlbmVyYXRlZCB1c2luZyBodHRwczovL2RvcGlhemEub3JnL3Rvb2xzL2RhdGF1cmkvaW5kZXgucGhwICovCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJMU1USWlJR2hsYVdkb2REMGlOVEV5SWlCMmFXVjNRbTk0UFNJd0lEQWdOVEV5SURVeE1pSStQSFJwZEd4bFBtbHZibWxqYjI1ekxYWTFMV0U4TDNScGRHeGxQanh3YjJ4NWJHbHVaU0J3YjJsdWRITTlJakkwTkNBME1EQWdNVEF3SURJMU5pQXlORFFnTVRFeUlpQnpkSGxzWlQwaVptbHNiRHB1YjI1bE8zTjBjbTlyWlRvak1EQXdPM04wY205clpTMXNhVzVsWTJGd09uSnZkVzVrTzNOMGNtOXJaUzFzYVc1bGFtOXBianB5YjNWdVpEdHpkSEp2YTJVdGQybGtkR2c2TkRod2VDSXZQanhzYVc1bElIZ3hQU0l4TWpBaUlIa3hQU0l5TlRZaUlIZ3lQU0kwTVRJaUlIa3lQU0l5TlRZaUlITjBlV3hsUFNKbWFXeHNPbTV2Ym1VN2MzUnliMnRsT2lNd01EQTdjM1J5YjJ0bExXeHBibVZqWVhBNmNtOTFibVE3YzNSeWIydGxMV3hwYm1WcWIybHVPbkp2ZFc1a08zTjBjbTlyWlMxM2FXUjBhRG8wT0hCNElpOCtQQzl6ZG1jKyIpOwp9CgoKCi5wbHV0b3VpLXRvYyBoZWFkZXIgewoJZGlzcGxheTogZmxleDsKCWFsaWduLWl0ZW1zOiBjZW50ZXI7CglnYXA6IC4zZW07Cglmb250LXNpemU6IDEuNWVtOwoJLyogbWFyZ2luLXRvcDogLTAuMWVtOyAqLwoJbWFyZ2luLWJvdHRvbTogMC40ZW07CglwYWRkaW5nOiAwLjVyZW07CgltYXJnaW4tbGVmdDogMDsKCW1hcmdpbi1yaWdodDogMDsKCWZvbnQtd2VpZ2h0OiBib2xkOwoJLyogYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4xNSk7ICovCglwb3NpdGlvbjogc3RpY2t5OwoJdG9wOiAwcHg7CgliYWNrZ3JvdW5kOiB2YXIoLS1tYWluLWJnLWNvbG9yKTsKCXotaW5kZXg6IDQxOwp9Ci5wbHV0b3VpLXRvYy5hc2lkZSBoZWFkZXIgewoJcGFkZGluZy1sZWZ0OiAwOwoJcGFkZGluZy1yaWdodDogMDsKfQoKLnBsdXRvdWktdG9jIHNlY3Rpb24gLnRvYy1yb3cgewoJd2hpdGUtc3BhY2U6IG5vd3JhcDsKCW92ZXJmbG93OiBoaWRkZW47Cgl0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKCXBhZGRpbmc6IC4xZW07Cglib3JkZXItcmFkaXVzOiAuMmVtOwp9CgoucGx1dG91aS10b2Mgc2VjdGlvbiAudG9jLXJvdy5IMSB7CgltYXJnaW4tdG9wOiAxZW07Cn0KCgoucGx1dG91aS10b2MuYXNpZGUgc2VjdGlvbiAudG9jLXJvdy5pbi12aWV3IHsKCWJhY2tncm91bmQ6IHZhcigtLXNpZGViYXItbGktYWN0aXZlLWJnKTsKfQoKCgkKLmhpZ2hsaWdodC1wbHV0by1jZWxsLXNob3VsZGVyIHsKCWJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wNSk7CgliYWNrZ3JvdW5kLWNsaXA6IHBhZGRpbmctYm94Owp9CgoucGx1dG91aS10b2Mgc2VjdGlvbiBhIHsKCXRleHQtZGVjb3JhdGlvbjogbm9uZTsKCWZvbnQtd2VpZ2h0OiBub3JtYWw7Cgljb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yKTsKfQoucGx1dG91aS10b2Mgc2VjdGlvbiBhOmhvdmVyIHsKCWNvbG9yOiB2YXIoLS1wbHV0by1vdXRwdXQtaC1jb2xvcik7Cn0KCi5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkgxIHsKCWZvbnQtd2VpZ2h0OiA3MDA7CglsaW5lLWhlaWdodDogMWVtOwp9CgoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gLmFmdGVyLUgyIGEgeyBwYWRkaW5nLWxlZnQ6IDEwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIC5hZnRlci1IMyBhIHsgcGFkZGluZy1sZWZ0OiAyMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiAuYWZ0ZXItSDQgYSB7IHBhZGRpbmctbGVmdDogMzBweDsgfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gLmFmdGVyLUg1IGEgeyBwYWRkaW5nLWxlZnQ6IDQwcHg7IH0KLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIC5hZnRlci1INiBhIHsgcGFkZGluZy1sZWZ0OiA1MHB4OyB9CgoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5IMSB7IHBhZGRpbmctbGVmdDogMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkgyIHsgcGFkZGluZy1sZWZ0OiAxMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkgzIHsgcGFkZGluZy1sZWZ0OiAyMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkg0IHsgcGFkZGluZy1sZWZ0OiAzMHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkg1IHsgcGFkZGluZy1sZWZ0OiA0MHB4OyB9Ci5wbHV0b3VpLXRvYy5pbmRlbnQgc2VjdGlvbiBhLkg2IHsgcGFkZGluZy1sZWZ0OiA1MHB4OyB9CgoKLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEucGx1dG8tZG9jcy1iaW5kaW5nLWVsLAoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5BU1NJR05FRQoJewoJZm9udC1mYW1pbHk6IEp1bGlhTW9ubywgbW9ub3NwYWNlOwoJZm9udC1zaXplOiAuOGVtOwoJLyogYmFja2dyb3VuZDogYmxhY2s7ICovCglmb250LXdlaWdodDogNzAwOwogICAgZm9udC1zdHlsZTogaXRhbGljOwoJY29sb3I6IHZhcigtLWNtLXZhci1jb2xvcik7IC8qIHRoaXMgaXMgc3RlYWxpbmcgYSB2YXJpYWJsZSBmcm9tIFBsdXRvLCBidXQgaXQncyBmaW5lIGlmIHRoYXQgZG9lc250IHdvcmsgKi8KfQoucGx1dG91aS10b2MuaW5kZW50IHNlY3Rpb24gYS5wbHV0by1kb2NzLWJpbmRpbmctZWw6OmJlZm9yZSwKLnBsdXRvdWktdG9jLmluZGVudCBzZWN0aW9uIGEuQVNTSUdORUU6OmJlZm9yZQoJewoJY29udGVudDogIj4gIjsKCW9wYWNpdHk6IC4zOwp9Cjwvc3R5bGU+CgoKPHNjcmlwdD4KLy8gU2V0IGdsb2JhbCB2YXJpYWJsZXMgZm9yIHRoZSBKYXZhU2NyaXB0CmNvbnN0IGhpZGVfcHJlYW1ibGUgPSB0cnVlOwpjb25zdCBmb3JjZV9oaWRlX2VuYWJsZWQgPSB0cnVlOwoKLy8gTG9hZCB0aGUgbGlicmFyeSBmb3IgY29uc2lzdGVudCBzbW9vdGggc2Nyb2xsaW5nCmNvbnN0IHtkZWZhdWx0OiBzY3JvbGxJbnRvVmlld30gPSBhd2FpdCBpbXBvcnQoImRhdGE6dGV4dC9qYXZhc2NyaXB0O2Jhc2U2NCxkbUZ5SUZFOVpUMCtJbTlpYW1WamRDSTlQWFI1Y0dWdlppQmxKaVp1ZFd4c0lUMWxKaVl4UFQwOVpTNXViMlJsVkhsd1pTeFZQU2hsTEhRcFBUNG9JWFI4ZkNKb2FXUmtaVzRpSVQwOVpTa21KaUoyYVhOcFlteGxJaUU5UFdVbUppSmpiR2x3SWlFOVBXVXNRVDBvWlN4MEtUMCtlMmxtS0dVdVkyeHBaVzUwU0dWcFoyaDBQR1V1YzJOeWIyeHNTR1ZwWjJoMGZIeGxMbU5zYVdWdWRGZHBaSFJvUEdVdWMyTnliMnhzVjJsa2RHZ3BlMnhsZENCc1BXZGxkRU52YlhCMWRHVmtVM1I1YkdVb1pTeHVkV3hzS1R0eVpYUjFjbTRnVlNoc0xtOTJaWEptYkc5M1dTeDBLWHg4VlNoc0xtOTJaWEptYkc5M1dDeDBLWHg4S0dVOVBudHNaWFFnZEQwb1pUMCtlMmxtS0NGbExtOTNibVZ5Ukc5amRXMWxiblI4ZkNGbExtOTNibVZ5Ukc5amRXMWxiblF1WkdWbVlYVnNkRlpwWlhjcGNtVjBkWEp1SUc1MWJHdzdkSEo1ZTNKbGRIVnliaUJsTG05M2JtVnlSRzlqZFcxbGJuUXVaR1ZtWVhWc2RGWnBaWGN1Wm5KaGJXVkZiR1Z0Wlc1MGZXTmhkR05vZTNKbGRIVnliaUJ1ZFd4c2ZYMHBLR1VwTzNKbGRIVnliaUVoZENZbUtIUXVZMnhwWlc1MFNHVnBaMmgwUEdVdWMyTnliMnhzU0dWcFoyaDBmSHgwTG1Oc2FXVnVkRmRwWkhSb1BHVXVjMk55YjJ4c1YybGtkR2dwZlNrb1pTbDljbVYwZFhKdUlURjlMRmc5S0dVc2RDeHNMRzhzYml4eUxHa3NjeWs5UG5JOFpTWW1hVDUwZkh4eVBtVW1KbWs4ZEQ4d09uSThQV1VtSm5NOFBXeDhmR2srUFhRbUpuTStQV3cvY2kxbExXODZhVDUwSmlaelBHeDhmSEk4WlNZbWN6NXNQMmt0ZEN0dU9qQXNKRDFsUFQ1bExuQmhjbVZ1ZEVWc1pXMWxiblEvUHlobExtZGxkRkp2YjNST2IyUmxLQ2t1YUc5emRIeDhiblZzYkNrc2RIUTlLR1VzZENrOVBudDJZWElnYkN4dkxHNHNjanRwWmloMGVYQmxiMllnWkc5amRXMWxiblErSW5VaUtYSmxkSFZ5Ymx0ZE8yeGxkSHR6WTNKdmJHeE5iMlJsT21rc1lteHZZMnM2Y3l4cGJteHBibVU2WVN4aWIzVnVaR0Z5ZVRwb0xITnJhWEJQZG1WeVpteHZkMGhwWkdSbGJrVnNaVzFsYm5Sek9uVjlQWFFzWnowaVpuVnVZM1JwYjI0aVBUMTBlWEJsYjJZZ2FEOW9PbVU5UG1VaFBUMW9PMmxtS0NGUktHVXBLWFJvY205M0lGUjVjR1ZGY25KdmNpZ2lTVzUyWVd4cFpDQjBZWEpuWlhRaUtUdHNaWFFnZGoxa2IyTjFiV1Z1ZEM1elkzSnZiR3hwYm1kRmJHVnRaVzUwZkh4a2IyTjFiV1Z1ZEM1a2IyTjFiV1Z1ZEVWc1pXMWxiblFzYlQxYlhTeDNQV1U3Wm05eUtEdFJLSGNwSmlabktIY3BPeWw3YVdZb0tIYzlKQ2gzS1NrOVBUMTJLWHR0TG5CMWMyZ29keWs3WW5KbFlXdDliblZzYkNFOWR5WW1kejA5UFdSdlkzVnRaVzUwTG1KdlpIa21Ka0VvZHlrbUppRkJLR1J2WTNWdFpXNTBMbVJ2WTNWdFpXNTBSV3hsYldWdWRDbDhmRzUxYkd3aFBYY21Ka0VvZHl4MUtTWW1iUzV3ZFhOb0tIY3BmV3hsZENCWFBXNTFiR3doUFNodlBXNTFiR3c5UFNoc1BYZHBibVJ2ZHk1MmFYTjFZV3hXYVdWM2NHOXlkQ2svZG05cFpDQXdPbXd1ZDJsa2RHZ3BQMjg2YVc1dVpYSlhhV1IwYUN4SVBXNTFiR3doUFNoeVBXNTFiR3c5UFNodVBYZHBibVJ2ZHk1MmFYTjFZV3hXYVdWM2NHOXlkQ2svZG05cFpDQXdPbTR1YUdWcFoyaDBLVDl5T21sdWJtVnlTR1ZwWjJoMExIdHpZM0p2Ykd4WU9sOHNjMk55YjJ4c1dUcDRmVDEzYVc1a2IzY3NlMmhsYVdkb2REcEZMSGRwWkhSb09sUXNkRzl3T2s0c2NtbG5hSFE2VEN4aWIzUjBiMjA2V1N4c1pXWjBPa045UFdVdVoyVjBRbTkxYm1ScGJtZERiR2xsYm5SU1pXTjBLQ2tzVWowaWMzUmhjblFpUFQwOWMzeDhJbTVsWVhKbGMzUWlQVDA5Y3o5T09pSmxibVFpUFQwOWN6OVpPazRyUlM4eUxGWTlJbU5sYm5SbGNpSTlQVDFoUDBNclZDOHlPaUpsYm1RaVBUMDlZVDlNT2tNc1FqMWJYVHRtYjNJb2JHVjBJRVE5TUR0RVBHMHViR1Z1WjNSb08wUXJLeWw3YkdWMElFODliVnRFWFN4N2FHVnBaMmgwT21vc2QybGtkR2c2U1N4MGIzQTZVeXh5YVdkb2REcHhMR0p2ZEhSdmJUcDZMR3hsWm5RNlJuMDlUeTVuWlhSQ2IzVnVaR2x1WjBOc2FXVnVkRkpsWTNRb0tUdHBaaWdpYVdZdGJtVmxaR1ZrSWowOVBXa21KazQrUFRBbUprTStQVEFtSmxrOFBVZ21Ka3c4UFZjbUprNCtQVk1tSmxrOFBYb21Ka00rUFVZbUprdzhQWEVwWW5KbFlXczdiR1YwSUVjOVoyVjBRMjl0Y0hWMFpXUlRkSGxzWlNoUEtTeEtQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlUR1ZtZEZkcFpIUm9MREV3S1N4TFBYQmhjbk5sU1c1MEtFY3VZbTl5WkdWeVZHOXdWMmxrZEdnc01UQXBMRkE5Y0dGeWMyVkpiblFvUnk1aWIzSmtaWEpTYVdkb2RGZHBaSFJvTERFd0tTeGFQWEJoY25ObFNXNTBLRWN1WW05eVpHVnlRbTkwZEc5dFYybGtkR2dzTVRBcExHVmxQVEFzWlhROU1DeGxiRDBpYjJabWMyVjBWMmxrZEdnaWFXNGdUejlQTG05bVpuTmxkRmRwWkhSb0xVOHVZMnhwWlc1MFYybGtkR2d0U2kxUU9qQXNaVzg5SW05bVpuTmxkRWhsYVdkb2RDSnBiaUJQUDA4dWIyWm1jMlYwU0dWcFoyaDBMVTh1WTJ4cFpXNTBTR1ZwWjJoMExVc3RXam93TEdWdVBTSnZabVp6WlhSWGFXUjBhQ0pwYmlCUFB6QTlQVDFQTG05bVpuTmxkRmRwWkhSb1B6QTZTUzlQTG05bVpuTmxkRmRwWkhSb09qQXNaWEk5SW05bVpuTmxkRWhsYVdkb2RDSnBiaUJQUHpBOVBUMVBMbTltWm5ObGRFaGxhV2RvZEQ4d09tb3ZUeTV2Wm1aelpYUklaV2xuYUhRNk1EdHBaaWgyUFQwOVR5bGxaVDBpYzNSaGNuUWlQVDA5Y3o5U09pSmxibVFpUFQwOWN6OVNMVWc2SW01bFlYSmxjM1FpUFQwOWN6OVlLSGdzZUN0SUxFZ3NTeXhhTEhnclVpeDRLMUlyUlN4RktUcFNMVWd2TWl4bGREMGljM1JoY25RaVBUMDlZVDlXT2lKalpXNTBaWElpUFQwOVlUOVdMVmN2TWpvaVpXNWtJajA5UFdFL1ZpMVhPbGdvWHl4ZksxY3NWeXhLTEZBc1h5dFdMRjhyVml0VUxGUXBMR1ZsUFUxaGRHZ3ViV0Y0S0RBc1pXVXJlQ2tzWlhROVRXRjBhQzV0WVhnb01DeGxkQ3RmS1R0bGJITmxlMlZsUFNKemRHRnlkQ0k5UFQxelAxSXRVeTFMT2lKbGJtUWlQVDA5Y3o5U0xYb3JXaXRsYnpvaWJtVmhjbVZ6ZENJOVBUMXpQMWdvVXl4NkxHb3NTeXhhSzJWdkxGSXNVaXRGTEVVcE9sSXRLRk1yYWk4eUtTdGxieTh5TEdWMFBTSnpkR0Z5ZENJOVBUMWhQMVl0UmkxS09pSmpaVzUwWlhJaVBUMDlZVDlXTFNoR0swa3ZNaWtyWld3dk1qb2laVzVrSWowOVBXRS9WaTF4SzFBclpXdzZXQ2hHTEhFc1NTeEtMRkFyWld3c1ZpeFdLMVFzVkNrN2JHVjBlM05qY205c2JFeGxablE2Wldrc2MyTnliMnhzVkc5d09tVmtmVDFQTzJWbFBVMWhkR2d1YldGNEtEQXNUV0YwYUM1dGFXNG9aV1FyWldVdlpYSXNUeTV6WTNKdmJHeElaV2xuYUhRdGFpOWxjaXRsYnlrcExHVjBQVTFoZEdndWJXRjRLREFzVFdGMGFDNXRhVzRvWldrclpYUXZaVzRzVHk1elkzSnZiR3hYYVdSMGFDMUpMMlZ1SzJWc0tTa3NVaXM5WldRdFpXVXNWaXM5WldrdFpYUjlRaTV3ZFhOb0tIdGxiRHBQTEhSdmNEcGxaU3hzWldaME9tVjBmU2w5Y21WMGRYSnVJRUo5TEdZOVpUMCtlM1poY2lCME8zSmxkSFZ5YmlFeFBUMDlaVDk3WW14dlkyczZJbVZ1WkNJc2FXNXNhVzVsT2lKdVpXRnlaWE4wSW4wNktIUTlaU2s5UFQxUFltcGxZM1FvZENrbUpqQWhQVDFQWW1wbFkzUXVhMlY1Y3loMEtTNXNaVzVuZEdnL1pUcDdZbXh2WTJzNkluTjBZWEowSWl4cGJteHBibVU2SW01bFlYSmxjM1FpZlgwN1puVnVZM1JwYjI0Z1l5aGxMSFFwZTNaaGNpQnNPMmxtS0NGbExtbHpRMjl1Ym1WamRHVmtmSHdoS0dVOVBudHNaWFFnZEQxbE8yWnZjaWc3ZENZbWRDNXdZWEpsYm5ST2IyUmxPeWw3YVdZb2RDNXdZWEpsYm5ST2IyUmxQVDA5Wkc5amRXMWxiblFwY21WMGRYSnVJVEE3ZEQxMExuQmhjbVZ1ZEU1dlpHVWdhVzV6ZEdGdVkyVnZaaUJUYUdGa2IzZFNiMjkwUDNRdWNHRnlaVzUwVG05a1pTNW9iM04wT25RdWNHRnlaVzUwVG05a1pYMXlaWFIxY200aE1YMHBLR1VwS1hKbGRIVnlianRwWmlnaWIySnFaV04wSWowOWRIbHdaVzltS0d3OWRDa21KaUptZFc1amRHbHZiaUk5UFhSNWNHVnZaaUJzTG1KbGFHRjJhVzl5S1hKbGRIVnliaUIwTG1KbGFHRjJhVzl5S0hSMEtHVXNkQ2twTzJ4bGRDQnZQU0ppYjI5c1pXRnVJajA5ZEhsd1pXOW1JSFI4Zkc1MWJHdzlQWFEvZG05cFpDQXdPblF1WW1Wb1lYWnBiM0k3Wm05eUtHeGxkSHRsYkRwdUxIUnZjRHB5TEd4bFpuUTZhWDF2WmlCMGRDaGxMR1lvZENrcEtXNHVjMk55YjJ4c0tIdDBiM0E2Y2l4c1pXWjBPbWtzWW1Wb1lYWnBiM0k2YjMwcGZYWmhjaUJrTEhBOUtDazlQaWhrZkh3b1pEMGljR1Z5Wm05eWJXRnVZMlVpYVc0Z2QybHVaRzkzUDNCbGNtWnZjbTFoYm1ObExtNXZkeTVpYVc1a0tIQmxjbVp2Y20xaGJtTmxLVHBFWVhSbExtNXZkeWtzWkNncEtUdG1kVzVqZEdsdmJpQmlLR1VwZTJ4bGRDQjBQVTFoZEdndWJXbHVLQ2h3S0NrdFpTNXpkR0Z5ZEZScGJXVXBMMlV1WkhWeVlYUnBiMjRzTVNrc2JEMWxMbVZoYzJVb2RDa3NiejFsTG5OMFlYSjBXQ3NvWlM1NExXVXVjM1JoY25SWUtTcHNMRzQ5WlM1emRHRnlkRmtyS0dVdWVTMWxMbk4wWVhKMFdTa3FiRHRsTG0xbGRHaHZaQ2h2TEc0c2RDeHNLU3h2SVQwOVpTNTRmSHh1SVQwOVpTNTVQM0psY1hWbGMzUkJibWx0WVhScGIyNUdjbUZ0WlNnb0tUMCtZaWhsS1NrNlpTNWpZaWdwZldaMWJtTjBhVzl1SUhrb1pTeDBMR3dwZTJ4bGRDQnZQV0Z5WjNWdFpXNTBjeTVzWlc1bmRHZytNeVltZG05cFpDQXdJVDA5WVhKbmRXMWxiblJ6V3pOZFAyRnlaM1Z0Wlc1MGMxc3pYVG8yTURBc2JqMWhjbWQxYldWdWRITXViR1Z1WjNSb1BqUW1Kblp2YVdRZ01DRTlQV0Z5WjNWdFpXNTBjMXMwWFQ5aGNtZDFiV1Z1ZEhOYk5GMDZaVDArTVNzdExXVXFaU3BsS21VcVpTeHlQV0Z5WjNWdFpXNTBjeTVzWlc1bmRHZytOVDloY21kMWJXVnVkSE5iTlYwNmRtOXBaQ0F3TEdrOVlYSm5kVzFsYm5SekxteGxibWQwYUQ0MlAyRnlaM1Z0Wlc1MGMxczJYVHAyYjJsa0lEQXNjejFsTG5OamNtOXNiRXhsWm5Rc1lUMWxMbk5qY205c2JGUnZjRHRpS0h0elkzSnZiR3hoWW14bE9tVXNiV1YwYUc5a0tIUXNiQ3h2TEc0cGUyeGxkQ0J5UFUxaGRHZ3VZMlZwYkNoMEtTeHpQVTFoZEdndVkyVnBiQ2hzS1R0bExuTmpjbTlzYkV4bFpuUTljaXhsTG5OamNtOXNiRlJ2Y0QxekxHay9MaWg3ZEdGeVoyVjBPbVVzWld4aGNITmxaRHB2TEhaaGJIVmxPbTRzYkdWbWREcHlMSFJ2Y0RwemZTbDlMSE4wWVhKMFZHbHRaVHB3S0Nrc2MzUmhjblJZT25Nc2MzUmhjblJaT21Fc2VEcDBMSGs2YkN4a2RYSmhkR2x2YmpwdkxHVmhjMlU2Yml4allqcHlmU2w5ZG1GeUlFMDlaVDArWlNZbUlXVXVZbVZvWVhacGIzSjhmQ0p6Ylc5dmRHZ2lQVDA5WlM1aVpXaGhkbWx2Y2l4clBXWjFibU4wYVc5dUtHVXNkQ2w3YkdWMElHdzlkSHg4ZTMwN2NtVjBkWEp1SUUwb2JDay9ZeWhsTEh0aWJHOWphenBzTG1Kc2IyTnJMR2x1YkdsdVpUcHNMbWx1YkdsdVpTeHpZM0p2Ykd4TmIyUmxPbXd1YzJOeWIyeHNUVzlrWlN4aWIzVnVaR0Z5ZVRwc0xtSnZkVzVrWVhKNUxITnJhWEJQZG1WeVpteHZkMGhwWkdSbGJrVnNaVzFsYm5Sek9td3VjMnRwY0U5MlpYSm1iRzkzU0dsa1pHVnVSV3hsYldWdWRITXNZbVZvWVhacGIzSTZaVDArVUhKdmJXbHpaUzVoYkd3b1pTNXlaV1IxWTJVb0tHVXNkQ2s5UG50c1pYUjdaV3c2Ynl4c1pXWjBPbTRzZEc5d09uSjlQWFFzYVQxdkxuTmpjbTlzYkV4bFpuUXNjejF2TG5OamNtOXNiRlJ2Y0R0eVpYUjFjbTRnYVQwOVBXNG1Kbk05UFQxeVAyVTZXeTR1TG1Vc2JtVjNJRkJ5YjIxcGMyVW9aVDArZVNodkxHNHNjaXhzTG1SMWNtRjBhVzl1TEd3dVpXRnpaU3dvS1QwK1pTaDdaV3c2Ynl4c1pXWjBPbHRwTEc1ZExIUnZjRHBiY3l4eVhYMHBMR3d1YjI1VFkzSnZiR3hEYUdGdVoyVXBLVjE5TEZ0ZEtTbDlLVHBRY205dGFYTmxMbkpsYzI5c2RtVW9ZeWhsTEhRcEtYMDdaWGh3YjNKMGUyc2dZWE1nWkdWbVlYVnNkSDA3IikKCi8vIExvYWQgYW5kIGV4ZWN1dGUgdGhlIEphdmFTY3JpcHQgZnVuY3Rpb25hbGl0eQovLyBFeHRlbmRlZCBUYWJsZSBvZiBDb250ZW50cyBKYXZhU2NyaXB0IGZ1bmN0aW9uYWxpdHkKLy8gRGVzaWduZWQgdG8gYmUgaW5jbHVkZWQgZGlyZWN0bHkgaW4gYSA8c2NyaXB0PiB0YWcKLy8gVGhpcyBmaWxlIGNvbnRhaW5zIGFsbCB0aGUgSmF2YVNjcmlwdCBjb2RlIGZvciB0aGUgRXh0ZW5kZWRUYWJsZU9mQ29udGVudHMgZmVhdHVyZXMsIGJ1dCBpcyBub3QgcGVyIHNlIGEgdmFsaWQvZXhlY3V0YWJsZSBhcyBqYXZhc2NyaXB0IGRpcmVjdGx5Ci8vIFRoaXMgZmlsZSBhc3N1bWVzIHRoYXQgc29tZSB2YXJpYWJsZXMgYXJlIGFscmVhZHkgZGVmaW5lZCBpbiB0aGUgcHJlYW1ibGUgb2YgdGhlIDxzY3JpcHQ+IHRhZyBsaWtlIGBzY3JvbGxJbnRvVmlld2AsIHRoZXNlIGFyZSBkaXJlY3RseSBhZGRlZCBpbiB0aGUganVsaWEgZnVuY3Rpb24gaW4gYGV4dGVuZGVkX3RvY19zaW1wbGUuamxgCgpmdW5jdGlvbiBzY3JvbGxfdG8oaCwgY29uZmlnID0gewogICAgYmVoYXZpb3I6ICdzbW9vdGgnLCAKICAgIGJsb2NrOiAnc3RhcnQnLAp9KSB7CiAgICBzY3JvbGxJbnRvVmlldyhoLCBjb25maWcpLnRoZW4oKCkgPT4gCiAgICAgICAgLy8gc29tZXRpbWVzIGl0IGRvZXNuJ3Qgc2Nyb2xsIHRvIHRoZSByaWdodCBwbGFjZQogICAgICAgIC8vIHNvbHV0aW9uOiB0cnkgYSBzZWNvbmQgdGltZSEKICAgICAgICBzY3JvbGxJbnRvVmlldyhoLCBjb25maWcpCiAgICApCn0KCi8vIEJhc2ljIGZ1bmN0aW9uYWxpdHkKbGV0IGNlbGwgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3BsdXRvLWNlbGwnKQpsZXQgcGx1dG9fYWN0aW9ucyA9IGNlbGwuX2ludGVybmFsX3BsdXRvX2FjdGlvbnMKbGV0IHRvYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ25hdi5wbHV0b3VpLXRvYycpCgpmdW5jdGlvbiBnZXRSb3coZWwpIHsKICAgIGNvbnN0IHJvdyA9IGVsPy5jbG9zZXN0KCcudG9jLXJvdycpCiAgICByZXR1cm4gcm93Cn0KICAgIApmdW5jdGlvbiBnZXRfbGlua19pZChlbCkgewogICAgY29uc3Qgcm93ID0gZ2V0Um93KGVsKQogICAgaWYgKF8uaXNOaWwocm93KSkgeyByZXR1cm4gbnVsbCB9CiAgICByZXR1cm4gcm93LmxpbmtlZEhlYWRpbmdJZAp9CgpmdW5jdGlvbiBnZXRIZWFkaW5nTGV2ZWwocm93KSB7CiAgICBjb25zdCBhID0gcm93LnF1ZXJ5U2VsZWN0b3IoJ2EnKQogICAgLy8gV2UgcmV0dXJuIHRoZSBsaW5rIGNsYXNzIHdpdGhvdXQgdGhlIGZpcnN0IEgKICAgIHJldHVybiBOdW1iZXIoYS5jbGFzc0xpc3RbMF0uc2xpY2UoMSkpCn0KCmZ1bmN0aW9uIGdlbmVyYXRlQ2hlY2tlcihzZWxlY3RvcikgewogICAgc3dpdGNoICh0eXBlb2Ygc2VsZWN0b3IpIHsKICAgICAgICBjYXNlICdzdHJpbmcnOgogICAgICAgICAgICBjb25zdCBmdW5jID0gZWwgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIGVsLm1hdGNoZXMoc2VsZWN0b3IpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZ1bmMKICAgICAgICBjYXNlICdmdW5jdGlvbic6CiAgICAgICAgICAgIHJldHVybiBzZWxlY3RvcgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFRoZSB0eXBlICgke3R5cGVvZiBzZWxlY3Rvcn0pIG9mIHRoZSBwcm92aWRlZCBhcmd1bWVudCBpcyBub3QgdmFsaWRgKQogICAgfQp9CgovLyBHZXQgbmV4dCBhbmQgcHJldmlvdXMgc2libGluZywgYWRhcHRlZCBmcm9tOgovLyBodHRwczovL2dvbWFrZXRoaW5ncy5jb20vZmluZGluZy10aGUtbmV4dC1hbmQtcHJldmlvdXMtc2libGluZy1lbGVtZW50cy10aGF0LW1hdGNoLWEtc2VsZWN0b3Itd2l0aC12YW5pbGxhLWpzLwp2YXIgZ2V0TmV4dFNpYmxpbmcgPSBmdW5jdGlvbiAoZWxlbSwgc2VsZWN0b3IpIHsKCiAgICAvLyBBZGRlZCB0byByZXR1cm4gdW5kZWZpbmVkIGlzIGNhbGxlZCB3aXRoIHVuZGVmaW5lZAogICAgaWYgKF8uaXNOaWwoZWxlbSkpIHtyZXR1cm4gdW5kZWZpbmVkfQoKICAgIC8vIEdldCB0aGUgbmV4dCBzaWJsaW5nIGVsZW1lbnQKICAgIHZhciBzaWJsaW5nID0gZWxlbS5uZXh0RWxlbWVudFNpYmxpbmc7CgogICAgLy8gSWYgdGhlcmUncyBubyBzZWxlY3RvciwgcmV0dXJuIHRoZSBmaXJzdCBzaWJsaW5nCiAgICBpZiAoIXNlbGVjdG9yKSByZXR1cm4gc2libGluZzsKCiAgICBjb25zdCBjaGVja2VyID0gZ2VuZXJhdGVDaGVja2VyKHNlbGVjdG9yKQoKICAgIC8vIElmIHRoZSBzaWJsaW5nIG1hdGNoZXMgb3VyIHNlbGVjdG9yLCB1c2UgaXQKICAgIC8vIElmIG5vdCwganVtcCB0byB0aGUgbmV4dCBzaWJsaW5nIGFuZCBjb250aW51ZSB0aGUgbG9vcAogICAgd2hpbGUgKHNpYmxpbmcpIHsKICAgICAgICBpZiAoY2hlY2tlcihzaWJsaW5nKSkgcmV0dXJuIHNpYmxpbmc7CiAgICAgICAgc2libGluZyA9IHNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nCiAgICB9Cgp9Owp2YXIgZ2V0UHJldmlvdXNTaWJsaW5nID0gZnVuY3Rpb24gKGVsZW0sIHNlbGVjdG9yKSB7CgogICAgLy8gQWRkZWQgdG8gcmV0dXJuIHVuZGVmaW5lZCBpcyBjYWxsZWQgd2l0aCB1bmRlZmluZWQKICAgIGlmIChfLmlzTmlsKGVsZW0pKSB7cmV0dXJuIHVuZGVmaW5lZH0KICAgIAogICAgLy8gR2V0IHRoZSBuZXh0IHNpYmxpbmcgZWxlbWVudAogICAgdmFyIHNpYmxpbmcgPSBlbGVtLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7CgogICAgLy8gSWYgdGhlcmUncyBubyBzZWxlY3RvciwgcmV0dXJuIHRoZSBmaXJzdCBzaWJsaW5nCiAgICBpZiAoIXNlbGVjdG9yKSByZXR1cm4gc2libGluZzsKCiAgICBjb25zdCBjaGVja2VyID0gZ2VuZXJhdGVDaGVja2VyKHNlbGVjdG9yKQoKICAgIC8vIElmIHRoZSBzaWJsaW5nIG1hdGNoZXMgb3VyIHNlbGVjdG9yLCB1c2UgaXQKICAgIC8vIElmIG5vdCwganVtcCB0byB0aGUgbmV4dCBzaWJsaW5nIGFuZCBjb250aW51ZSB0aGUgbG9vcAogICAgd2hpbGUgKHNpYmxpbmcpIHsKICAgICAgICBpZiAoY2hlY2tlcihzaWJsaW5nKSkgcmV0dXJuIHNpYmxpbmc7CiAgICAgICAgc2libGluZyA9IHNpYmxpbmcucHJldmlvdXNFbGVtZW50U2libGluZzsKICAgIH0KCn07CgovLyBHZXQgdGhlIGxhc3QgdG9jIGVudHJ5IGRlc2NlbmRhbnQgZnJvbSB0aGUgcHJvdmlkZWQgb25lCmZ1bmN0aW9uIGdldExhc3REZXNjZW5kYW50KGVsKSB7CiAgICBjb25zdCByb3cgPSBnZXRSb3coZWwpCiAgICBpZiAoXy5pc05pbChyb3cpKSB7cmV0dXJufQogICAgY29uc3QgY2hpbGRyZW4gPSByb3cuZGlyZWN0Q2hpbGRyZW4KICAgIGlmIChfLmlzRW1wdHkoY2hpbGRyZW4pKSB7CiAgICAgICAgcmV0dXJuIHJvdwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZ2V0TGFzdERlc2NlbmRhbnQoXy5sYXN0KGNoaWxkcmVuKSkKICAgIH0KfQoKLy8gRmluZCBhbGwgdGhlIGNlbGwgaWRzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIHRhcmdldCB0b2Mgcm93cyBhbmQgYWxsIGl0cyBkZXNjZW5kYW50cwpmdW5jdGlvbiBnZXRCbG9ja0lkcyhlbCkgewogICAgY29uc3Qgcm93ID0gZ2V0Um93KGVsKQogICAgaWYgKF8uaXNOaWwocm93KSkge3JldHVybn0KICAgIGZ1bmN0aW9uIGdldEluZGV4KHJvdykgewogICAgICAgIHJldHVybiBlZGl0b3Jfc3RhdGUubm90ZWJvb2suY2VsbF9vcmRlci5pbmRleE9mKGdldF9saW5rX2lkKHJvdykpCiAgICB9CiAgICBjb25zdCBzdGFydCA9IGdldEluZGV4KHJvdykKCiAgICBjb25zdCBsYXN0Q2hpbGQgPSBnZXRMYXN0RGVzY2VuZGFudChyb3cpCiAgICBjb25zdCBlbmQgPSBnZXRJbmRleChnZXROZXh0U2libGluZyhsYXN0Q2hpbGQsICcudG9jLXJvdycpKQoKICAgIHJldHVybiBlZGl0b3Jfc3RhdGUubm90ZWJvb2suY2VsbF9vcmRlci5zbGljZShzdGFydCwgZW5kIDwgMCA/IEluZmluaXR5IDogZW5kKQp9Cgp3aW5kb3cudG9jX3V0aWxzID0gewogICAgZ2V0TmV4dFNpYmxpbmcsCiAgICBnZXRQcmV2aW91c1NpYmxpbmcsCiAgICBnZXRMYXN0RGVzY2VuZGFudCwKICAgIGdldEJsb2NrSWRzLAp9CgovLyBGdW5jdGlvbnMgdG8gc2V0IGFuZCBwcm9wYWdhdGUgaGlkZGVuIGFuZCBjb2xsYXBzZWQgc3RhdGVzCgpmdW5jdGlvbiBwcm9wYWdhdGVfcGFyZW50KGRpdiwgcGFyZW50PW51bGwpIHsKICAgIGlmIChwYXJlbnQgIT0gbnVsbCkgewogICAgICAgIGRpdi5hbGxQYXJlbnRzID0gXy51bmlvbihkaXYuYWxsUGFyZW50cywgW3BhcmVudF0pCQogICAgfQogICAgaWYgKF8uaXNFbXB0eShkaXYuZGlyZWN0Q2hpbGRyZW4pKSB7cmV0dXJufQogICAgZm9yIChjb25zdCBjaGlsZCBvZiBkaXYuZGlyZWN0Q2hpbGRyZW4pIHsKICAgICAgICBwcm9wYWdhdGVfcGFyZW50KGNoaWxkLCBwYXJlbnQgPz8gZGl2KQogICAgfQp9CgovLyBSZXR1cm5zIHRydWUgaWYgdGhlIGN1cnJlbnQgaGlkZGVuL2NvbGxhcHNlZCB0b2Mgc3RhdGUgaXMgZGlmZmVyZW50IGZyb20gdGhlIG9uZSBzYXZlZCBpbiB0aGUgZmlsZSB3aXRoaW4gY2VsbCBtZXRhZGF0YQpmdW5jdGlvbiBzdGF0ZURpZmZlcnNGaWxlKHN0YXRlKSB7CiAgICBmb3IgKGNvbnN0IFtpZCwgc3RdIG9mIF8uZW50cmllcyhzdGF0ZSkpIHsKICAgICAgICBpZiAoaGFzX2NlbGxfYXR0cmlidXRlKGlkLCAndG9jLWhpZGRlbicpICE9IHN0LmhpZGRlbikgeyByZXR1cm4gdHJ1ZSB9CiAgICAgICAgaWYgKGhhc19jZWxsX2F0dHJpYnV0ZShpZCwgJ3RvYy1jb2xsYXBzZWQnKSAhPSBzdC5jb2xsYXBzZWQpIHsgcmV0dXJuIHRydWUgfQogICAgfQogICAgcmV0dXJuIGZhbHNlCn0KCmZ1bmN0aW9uIHNldF9zdGF0ZShkaXYsIHN0YXRlLCB2YWx1ZSwgaW5pdCA9IGZhbHNlKSB7CiAgICBkaXYuY2xhc3NMaXN0LnRvZ2dsZShzdGF0ZSwgdmFsdWUpCiAgICBpZiAoIWluaXQpIHsKICAgICAgICB3aW5kb3cudG9jX3N0YXRlW2dldF9saW5rX2lkKGRpdildW3N0YXRlXSA9IHZhbHVlCiAgICAgICAgdG9jLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbGUtc3RhdGUtZGlmZmVycycsIHN0YXRlRGlmZmVyc0ZpbGUod2luZG93LnRvY19zdGF0ZSkpCiAgICB9CiAgICBpZiAoXy5pc0VtcHR5KGRpdi5kaXJlY3RDaGlsZHJlbikpIHtyZXR1cm59CiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGRpdi5kaXJlY3RDaGlsZHJlbikgewogICAgICAgIHByb3BhZ2F0ZV9zdGF0ZShjaGlsZCwgc3RhdGUpCiAgICB9Cn0KZnVuY3Rpb24gcHJvcGFnYXRlX3N0YXRlKGRpdiwgc3RhdGUpIHsKICAgIGxldCBuZXdfc3RhdGUgPSBgcGFyZW50LSR7c3RhdGV9YAogICAgZGl2LmNsYXNzTGlzdC50b2dnbGUobmV3X3N0YXRlLCBmYWxzZSkKICAgIC8vIENoZWNrIHRoZSBwYXJlbnRzIGZvciB0aGUgc3RhdGUKICAgIGZvciAoY29uc3QgcGFyZW50IG9mIGRpdi5hbGxQYXJlbnRzKSB7CiAgICAgICAgaWYgKHBhcmVudC5jbGFzc0xpc3QuY29udGFpbnMoc3RhdGUpKSB7CiAgICAgICAgICAgIGRpdi5jbGFzc0xpc3QudG9nZ2xlKG5ld19zdGF0ZSwgdHJ1ZSkKICAgICAgICAgICAgYnJlYWsKICAgICAgICB9CiAgICB9CiAgICBpZiAoXy5pc0VtcHR5KGRpdi5kaXJlY3RDaGlsZHJlbikpIHtyZXR1cm59CiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGRpdi5kaXJlY3RDaGlsZHJlbikgewogICAgICAgIHByb3BhZ2F0ZV9zdGF0ZShjaGlsZCwgc3RhdGUpCiAgICB9Cn0KCi8vIEZsb2F0aW5nIFVJIGZ1bmN0aW9uYWxpdHkKY29uc3QgZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb21AMS43LjQnKQoKLy8gQ2VsbCBhdHRyaWJ1dGVzIG1vZGlmaWNhdGlvbgpmdW5jdGlvbiBoYXNfY2VsbF9hdHRyaWJ1dGUoY2VsbF9pZCwgYXR0cikgewogICAgY29uc3QgbWQgPSBlZGl0b3Jfc3RhdGUubm90ZWJvb2suY2VsbF9pbnB1dHNbY2VsbF9pZF0ubWV0YWRhdGEKICAgIHJldHVybiBfLmluY2x1ZGVzKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cikKfQoKZnVuY3Rpb24gYWRkX2NlbGxfYXR0cmlidXRlcyhjZWxsX2lkLCBhdHRycykgewogICAgcGx1dG9fYWN0aW9ucy51cGRhdGVfbm90ZWJvb2soKG5vdGVib29rKSA9PiB7CiAgICAgICAgbGV0IG1kID0gbm90ZWJvb2suY2VsbF9pbnB1dHNbY2VsbF9pZF0ubWV0YWRhdGEKICAgICAgICBtZFsiY3VzdG9tX2F0dHJzIl0gPSBfLnVuaW9uKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cnMpCiAgICB9KQogICAgbGV0IGNlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjZWxsX2lkKQogICAgZm9yIChsZXQgYXR0ciBvZiBhdHRycykgewogICAgICAgIGNlbGwudG9nZ2xlQXR0cmlidXRlKGF0dHIsIHRydWUpCiAgICB9Cn0KCmZ1bmN0aW9uIHJlbW92ZV9jZWxsX2F0dHJpYnV0ZXMoY2VsbF9pZCwgYXR0cnMpIHsKICAgIHBsdXRvX2FjdGlvbnMudXBkYXRlX25vdGVib29rKChub3RlYm9vaykgPT4gewogICAgICAgIGxldCBtZCA9IG5vdGVib29rLmNlbGxfaW5wdXRzW2NlbGxfaWRdLm1ldGFkYXRhCiAgICAgICAgbGV0IGFmdGVyID0gXy5kaWZmZXJlbmNlKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cnMpCiAgICAgICAgaWYgKF8uaXNFbXB0eShhZnRlcikpIHsKICAgICAgICAgICAgZGVsZXRlIG1kWyJjdXN0b21fYXR0cnMiXQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1kWyJjdXN0b21fYXR0cnMiXSA9IGFmdGVyCiAgICAgICAgfQogICAgfSkKICAgIGxldCBjZWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2VsbF9pZCkKICAgIGZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHsKICAgICAgICBjZWxsLnRvZ2dsZUF0dHJpYnV0ZShhdHRyLCBmYWxzZSkKICAgIH0KfQoKZnVuY3Rpb24gdG9nZ2xlX2NlbGxfYXR0cmlidXRlKGNlbGxfaWQsIGF0dHIsIGZvcmNlPSd0b2dnbGUnKSB7CiAgICBwbHV0b19hY3Rpb25zLnVwZGF0ZV9ub3RlYm9vaygobm90ZWJvb2spID0+IHsKICAgICAgICBsZXQgbWQgPSBub3RlYm9vay5jZWxsX2lucHV0c1tjZWxsX2lkXS5tZXRhZGF0YQogICAgICAgIGxldCBmID0gZm9yY2UgPT0gJ3RvZ2dsZScgPyBfLnhvciA6IGZvcmNlID8gXy51bmlvbiA6IF8uZGlmZmVyZW5jZQogICAgICAgIGxldCBhZnRlciA9IGYobWRbImN1c3RvbV9hdHRycyJdLCBbYXR0cl0pCiAgICAgICAgaWYgKF8uaXNFbXB0eShhZnRlcikpIHsKICAgICAgICAgICAgZGVsZXRlIG1kWyJjdXN0b21fYXR0cnMiXQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1kWyJjdXN0b21fYXR0cnMiXSA9IGFmdGVyCiAgICAgICAgfQogICAgfSkKICAgIGxldCBjZWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2VsbF9pZCkKICAgIGZvcmNlID09ICd0b2dnbGUnID8gY2VsbC50b2dnbGVBdHRyaWJ1dGUoYXR0cikgOiBjZWxsLnRvZ2dsZUF0dHJpYnV0ZShhdHRyLCBmb3JjZSkKfQoKLy8gTm90ZWJvb2sgYXR0cmlidXRlcyBtb2RpZmljYXRpb24KZnVuY3Rpb24gYWRkX25vdGVib29rX2F0dHJpYnV0ZXMoYXR0cnMpIHsKICAgIHBsdXRvX2FjdGlvbnMudXBkYXRlX25vdGVib29rKChub3RlYm9vaykgPT4gewogICAgICAgIGxldCBtZCA9IG5vdGVib29rLm1ldGFkYXRhCiAgICAgICAgbWRbImN1c3RvbV9hdHRycyJdID0gXy51bmlvbihtZFsiY3VzdG9tX2F0dHJzIl0sIGF0dHJzKQogICAgfSkKICAgIGxldCBub3RlYm9vayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3BsdXRvLW5vdGVib29rJykKICAgIGZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHsKICAgICAgICBub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgdHJ1ZSkKICAgIH0KfQoKZnVuY3Rpb24gcmVtb3ZlX25vdGVib29rX2F0dHJpYnV0ZXMoYXR0cnMpIHsKICAgIHBsdXRvX2FjdGlvbnMudXBkYXRlX25vdGVib29rKChub3RlYm9vaykgPT4gewogICAgICAgIGxldCBtZCA9IG5vdGVib29rLm1ldGFkYXRhCiAgICAgICAgbGV0IGFmdGVyID0gXy5kaWZmZXJlbmNlKG1kWyJjdXN0b21fYXR0cnMiXSwgYXR0cnMpCiAgICAgICAgaWYgKF8uaXNFbXB0eShhZnRlcikpIHsKICAgICAgICAgICAgZGVsZXRlIG1kWyJjdXN0b21fYXR0cnMiXQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG1kWyJjdXN0b21fYXR0cnMiXSA9IGFmdGVyCiAgICAgICAgfQogICAgfSkKICAgIGxldCBub3RlYm9vayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3BsdXRvLW5vdGVib29rJykKICAgIGZvciAobGV0IGF0dHIgb2YgYXR0cnMpIHsKICAgICAgICBub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgZmFsc2UpCiAgICB9Cn0KCmZ1bmN0aW9uIHRvZ2dsZV9ub3RlYm9va19hdHRyaWJ1dGUoYXR0ciwgZm9yY2U9J3RvZ2dsZScpIHsKICAgIHBsdXRvX2FjdGlvbnMudXBkYXRlX25vdGVib29rKChub3RlYm9vaykgPT4gewogICAgICAgIGxldCBtZCA9IG5vdGVib29rLm1ldGFkYXRhCiAgICAgICAgbGV0IGYgPSBmb3JjZSA9PSAndG9nZ2xlJyA/IF8ueG9yIDogZm9yY2UgPyBfLnVuaW9uIDogXy5kaWZmZXJlbmNlCiAgICAgICAgbGV0IGFmdGVyID0gZihtZFsiY3VzdG9tX2F0dHJzIl0sIFthdHRyXSkKICAgICAgICBpZiAoXy5pc0VtcHR5KGFmdGVyKSkgewogICAgICAgICAgICBkZWxldGUgbWRbImN1c3RvbV9hdHRycyJdCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWRbImN1c3RvbV9hdHRycyJdID0gYWZ0ZXIKICAgICAgICB9CiAgICB9KQogICAgbGV0IG5vdGVib29rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncGx1dG8tbm90ZWJvb2snKQogICAgZm9yY2UgPT0gJ3RvZ2dsZScgPyBub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0cikgOiBub3RlYm9vay50b2dnbGVBdHRyaWJ1dGUoYXR0ciwgZm9yY2UpCn0KCmlmIChmb3JjZV9oaWRlX2VuYWJsZWQpIHsKICAgIHRvZ2dsZV9ub3RlYm9va19hdHRyaWJ1dGUoJ2hpZGUtZW5hYmxlZCcsdHJ1ZSkKfQoKLy8gTXV0YXRpb24gb2JzZXJ2ZXIgZnVuY3Rpb25hbGl0eQpmdW5jdGlvbiB0b2dnbGVfc3RhdGUobmFtZSkgewogICAgcmV0dXJuIChlKSA9PiB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKQogICAgICAgIGxldCBkaXYgPSBlLnRhcmdldC5jbG9zZXN0KCdkaXYnKQogICAgICAgIGNvbnN0IG5ld192YWwgPSAhZGl2LmNsYXNzTGlzdC5jb250YWlucyhuYW1lKQogICAgICAgIHNldF9zdGF0ZShkaXYsIG5hbWUsIG5ld192YWwpCiAgICB9Cn0KCi8vIFRoaXMgZnVuY3Rpb24gd2lsbCByZXR1cm4gYSB2ZWN0b3Igb2YgY2VsbHMgaW5kaWNlcyAoaW50ZW5kZWQgdG8gaW5kZXggdGhlIGxpc3Qgb2YgY2VsbHMgaW4gdGhlaXIgb3JkZXIgYXMgcmV0dXJuIGJ5IGBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdwbHV0by1jZWxsJylgKSB0byBpZGVudGlmeSBzdGFydCBhbmQgZW5kIGluZGV4IG9mIGNlbGxzIHRvIGhpZGUgYmVjYXVzZSB0aGVpciBjb3JyZXNwb25kaW5nIFRvQyByb3cgaXMgaGlkZGVuCmZ1bmN0aW9uIHRvY3Jvd3NfaGlkZGVuX2luZGljZXMoKSB7CiAgICBsZXQgaGlkZGVuX3N0YXJ0X3N0b3BfaWR4cyA9IFtdIC8vIFRoaXMgd2lsbCB0cmFjayB0aGUgc3RhcnQgYW5kIGVuZCBpbmRleCBvZiBjZWxscyB0byBoaWRlIGJlY2F1c2UgdGhlaXIgY29ycmVzcG9uZGluZyBUb0Mgcm93IGlzIGhpZGRlbi4gVGhlIGNlbGwgYXQgdGhlIGVuZCBpZHggc2hvdWxkIGFscmVhZHkgYmUgY29uc2lkZXJlZCBhcyBgc2hvd25gCiAgICBsZXQgY3VycmVudF9oaWRkZW5fc3RhdHVzID0gZmFsc2UgLy8gVGhpcyBzaWduYWxzIHdoZXRoZXIgdGhlIGN1cnJlbnQgaXMgaGlkZGVuIG9yIG5vdAogICAgaWYgKGhpZGVfcHJlYW1ibGUpIHsKICAgICAgICBoaWRkZW5fc3RhcnRfc3RvcF9pZHhzLnB1c2goLTEpCiAgICAgICAgY3VycmVudF9oaWRkZW5fc3RhdHVzID0gdHJ1ZQogICAgfQogICAgY29uc3QgZGl2cyA9IHRvYy5xdWVyeVNlbGVjdG9yQWxsKCdkaXYudG9jLXJvdycpCiAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3BsdXRvLWNlbGwnKQogICAgbGV0IHJ1bm5pbmdfaWR4ID0gMCAvLyBUaGlzIHdpbGwgdHJhY2sgdGhlIGluZGV4IG9mIHRoZSBtYWluIGNlbGwKICAgIGZvciAoY29uc3QgZGl2IG9mIGRpdnMpIHsKICAgICAgICBjb25zdCBoaWRkZW4gPSBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSB8fCBkaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdwYXJlbnQtaGlkZGVuJykKICAgICAgICBjb25zdCBsaW5rZWRfY2VsbF9pZCA9IGdldF9saW5rX2lkKGRpdikKICAgICAgICAvLyBXZSBpdGVyYXRlIHRocm91Z2ggdGhlIG1haW4gY2VsbHMgdGlsbCB3ZSBmaW5kIHRoZSBvbmUgd2l0aCB0aGUgbGlua2VkIGNlbGwgaWQKICAgICAgICB3aGlsZSAocnVubmluZ19pZHggPCBjZWxscy5sZW5ndGggJiYgY2VsbHNbcnVubmluZ19pZHhdLmlkICE9PSBsaW5rZWRfY2VsbF9pZCkgewogICAgICAgICAgICBydW5uaW5nX2lkeCsrCiAgICAgICAgfQogICAgICAgIGlmIChydW5uaW5nX2lkeCA+PSBjZWxscy5sZW5ndGgpIHsKICAgICAgICAgICAgY29uc29sZS53YXJuKGBDZWxsIHdpdGggaWQgJHtsaW5rZWRfY2VsbF9pZH0gbm90IGZvdW5kYCkKICAgICAgICAgICAgY29udGludWUKICAgICAgICB9CiAgICAgICAgaWYgKGhpZGRlbiAhPSBjdXJyZW50X2hpZGRlbl9zdGF0dXMpIHsKICAgICAgICAgICAgaGlkZGVuX3N0YXJ0X3N0b3BfaWR4cy5wdXNoKHJ1bm5pbmdfaWR4KQogICAgICAgICAgICBjdXJyZW50X2hpZGRlbl9zdGF0dXMgPSBoaWRkZW4KICAgICAgICB9CiAgICB9CiAgICAvLyBJZiB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGlzIG9kZCwgd2UganVzdCBhZGQgYXMgbGFzdCBlbGVtZW50IHRoZSBudW1iZXIgb2YgY2VsbHMgYXMgd2Ugd2FudCBjb25zaXN0ZW50IHN0YXJ0IGFuZCBzdG9wIGluZGljZXMKICAgIGlmIChoaWRkZW5fc3RhcnRfc3RvcF9pZHhzLmxlbmd0aCAlIDIgIT09IDApIHsKICAgICAgICBoaWRkZW5fc3RhcnRfc3RvcF9pZHhzLnB1c2goY2VsbHMubGVuZ3RoKQogICAgfQogICAgcmV0dXJuIGhpZGRlbl9zdGFydF9zdG9wX2lkeHMKfQoKLy8gVGhpcyBmdW5jdGlvbiB0YWtlcyBhcyBpbnB1dCBhIHZlY3RvciBvZiBzdGFydC9zdG9wIGluZGljZXMgb2YgaGlkZGVuIGNlbGxzIChiYXNlZCBvbiB0b2Mgcm93cykgYW5kIGFwcGx5IHRoZSBgdG9jLWhpZGRlbmAgY2VsbCBhdHRyaWJ1dGUgKHdlIGRvbid0IHVzZSBhIGNsYXNzIGFzIHBsdXRvIGNvbnN0YW50bHkgcmV3cml0ZXMgdGhlIGNlbGwgY2xhc3MpIHRvIGlkZW50aWZ5IHRoYXQgYSBjZWxsIG11c3QgYmUgaGlkZGVuCmZ1bmN0aW9uIGhpZGVfbWFpbl9jZWxscyhpbmRpY2VzKSB7CiAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3BsdXRvLWNlbGwnKQogICAgbGV0IGN1cnJlbnRfaGlkZGVuX3N0YXR1cyA9IGZhbHNlCiAgICBsZXQgbmV4dF90YXJnZXQgPSBpbmRpY2VzLnNoaWZ0KCkKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2VsbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3aGlsZSAoaSA+IG5leHRfdGFyZ2V0KSB7CiAgICAgICAgICAgIG5leHRfdGFyZ2V0ID0gaW5kaWNlcy5zaGlmdCgpCiAgICAgICAgICAgIGN1cnJlbnRfaGlkZGVuX3N0YXR1cyA9ICFjdXJyZW50X2hpZGRlbl9zdGF0dXMKICAgICAgICB9CiAgICAgICAgaWYgKGkgPT0gbmV4dF90YXJnZXQpIHsKICAgICAgICAgICAgbmV4dF90YXJnZXQgPSBpbmRpY2VzLnNoaWZ0KCkKICAgICAgICAgICAgY3VycmVudF9oaWRkZW5fc3RhdHVzID0gIWN1cnJlbnRfaGlkZGVuX3N0YXR1cwogICAgICAgIH0KICAgICAgICBjZWxsc1tpXS50b2dnbGVBdHRyaWJ1dGUoJ3RvYy1oaWRkZW4nLCBjdXJyZW50X2hpZGRlbl9zdGF0dXMpCiAgICB9Cn0KCndpbmRvdy50b2NfdXRpbHMudG9jcm93c19oaWRkZW5faW5kaWNlcyA9IHRvY3Jvd3NfaGlkZGVuX2luZGljZXMKCmZ1bmN0aW9uIHVwZGF0ZV9oaWRkZW5fdG9jcm93cygpIHsKICAgIGhpZGVfbWFpbl9jZWxscyh0b2Nyb3dzX2hpZGRlbl9pbmRpY2VzKCkpCn0KCi8vIFJlcG9zaXRpb24gdGhlIGhpZGVfY29udGFpbmVyIHVzaW5nIHRoZSBmbG9hdGluZy11aSBsaWJyYXJ5CmZ1bmN0aW9uIHJlcG9zaXRpb25Ub29sdGlwKGUpIHsKICAgIGNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBvZmZzZXQgfSA9IGZsb2F0aW5nX3VpCiAgICBjb25zdCByZWYgPSBlLnRhcmdldAogICAgY29uc3QgdG9vbHRpcCA9IHJlZi5xdWVyeVNlbGVjdG9yKCcudG9jLWhpZGUtY29udGFpbmVyJykKICAgIGlmIChfLmlzTmlsKHRvb2x0aXApKSB7CiAgICAgICAgY29uc29sZS53YXJuKCJTb21ldGhpbmcgd2VudCB3cm9uZywgbm8gdG9vbHRpcCBmb3VuZCIpCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAKICAgIC8vIEdldCB0aGUgc2Nyb2xsIGNvbnRhaW5lciAtIHRoaXMgaXMgY3J1Y2lhbCBmb3IgcHJvcGVyIG9mZnNldCBjYWxjdWxhdGlvbgogICAgY29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudAogICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQKICAgIAogICAgY29tcHV0ZVBvc2l0aW9uKHJlZiwgdG9vbHRpcCwgewogICAgICAgIHBsYWNlbWVudDogImxlZnQiLAogICAgICAgIHN0cmF0ZWd5OiAiZml4ZWQiLAogICAgfSkudGhlbihwb3MgPT4gewogICAgICAgIHRvb2x0aXAuc3R5bGUudG9wID0gcG9zLnkgLSBzY3JvbGxUb3AgKyAicHgiCiAgICB9KQp9CgpmdW5jdGlvbiBwcm9jZXNzX3JvdyhkaXYsIGhpc3RvcnksIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKSB7CgogICAgLy8gV2UgZmluZCBhbGwgdGhlIG1haW5IZWFkaW5ncyBhbmQgdG9jUm93cyB0byBmaW5kIG1hdGNoaW5nIHBhaXJzCgogICAgLy8gVHJ5IHRoZSBvcmlnaW5hbCBzZWxlY3RvciBmaXJzdAogICAgY29uc3QgdG9jUm93cyA9IEFycmF5LmZyb20odG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlY3Rpb24gZGl2LnRvYy1yb3cnKSkKCiAgICBjb25zdCBtYWluSGVhZGluZ3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ21haW4gaDEsIG1haW4gaDIsIG1haW4gaDMsIG1haW4gaDQsIG1haW4gaDUsIG1haW4gaDYnKSkKCiAgICBjb25zdCBoZWFkaW5nSWR4ID0gdG9jUm93cy5pbmRleE9mKGRpdikKCiAgICBjb25zdCBjb3JyZXNwb25kaW5nSGVhZGluZyA9IG1haW5IZWFkaW5nc1toZWFkaW5nSWR4XQoKICAgIGRpdi5saW5rZWRIZWFkaW5nID0gY29ycmVzcG9uZGluZ0hlYWRpbmcKICAgIGRpdi5saW5rZWRIZWFkaW5nSWQgPSBjb3JyZXNwb25kaW5nSGVhZGluZy5jbG9zZXN0KCdwbHV0by1jZWxsJykuaWQKCiAgICAvLyBXZSBhZGQgdGhlIHNlcGFyYXRvcgogICAgZGl2Lmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlYmVnaW4nLCBodG1sYDxkaXYgY2xhc3M9J3RvYy1yb3ctc2VwYXJhdG9yJz48L2Rpdj5gKQogICAgLy8gSWYgd2UgYXJlIGp1c3QgcHJvY2Vzc2luZyB0aGUgZmlyc3QgZWxlbWVudCAoc28gdGhlIGxhc3Qgcm93KSB3ZSBhbHNvIGFkZCBhIHNlcGFyYXRvciBhdCB0aGUgYm90dG9tCiAgICBpZiAoXy5pc0VtcHR5KG5ld19zdGF0ZSkgJiYgXy5ldmVyeShoaXN0b3J5LCBfLmlzRW1wdHkpKSB7CiAgICAgICAgZGl2Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBodG1sYDxkaXYgY2xhc3M9J3RvYy1yb3ctc2VwYXJhdG9yJz48L2Rpdj5gKQogICAgfQoKICAgIC8vIFdlIGFkZCB0aGUgcmVwb3NpdGlvbiBldmVudCB0byB0aGUgcm93CiAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHJlcG9zaXRpb25Ub29sdGlwKQogICAgCiAgICBsZXQgaWQgPSBnZXRfbGlua19pZChkaXYpCiAgICBjb25zdCBhID0gZGl2LnF1ZXJ5U2VsZWN0b3IoJ2EnKQogICAgbGV0IG9sZF9mID0gYS5vbmNsaWNrOwogICAgYS5vbmNsaWNrID0gKGUpID0+IHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCkKICAgICAgICAvLyBXZSBhdm9pZCB0cmlnZ2VyaW5nIHRoZSBjbGljayBpZiBjb21pbmcgb3V0IG9mIGEgZHJhZwogICAgICAgIGlmICh0b2MuY2xhc3NMaXN0LmNvbnRhaW5zKCdyZWNlbnQtZHJhZycpKSB7IHJldHVybiB9CiAgICAgICAgb2xkX2YoZSkKICAgIH0JCQkKICAgIGNvbnN0IGxldmVsID0gZ2V0SGVhZGluZ0xldmVsKGRpdikKICAgIGlmIChsZXZlbCA+IDEpIHsKICAgICAgICBoaXN0b3J5W2xldmVsXS51bnNoaWZ0KGRpdikKICAgIH0KICAgIC8vIFdlIGl0ZXJhdGUgdGhyb3VnaCB0aGUgaGlzdG9yeSBhbmQgYXNzaWduIHRoZSBkaXJlY3QgY2hpbGRyZW4gaWYgdGhleSBleGlzdCwgd2hpbGUgY2xlYXJpbmcgbG93ZXIgbGV2ZWxzIGhpc3RvcnkKICAgIGZvciAobGV0IGkgPSA2OyBpID4gbGV2ZWw7IGktLSkgewogICAgICAgIGlmIChfLmlzRW1wdHkoaGlzdG9yeVtpXSkpIHtjb250aW51ZX0KICAgICAgICBpZiAoZGl2LmRpcmVjdENoaWxkcmVuICE9IHVuZGVmaW5lZCkge3Rocm93KCdtdWx0aXBsZSBsZXZlbCB3aXRoIGNoaWxkcmVuLCB1bmV4cGVjdGVkIScpfQogICAgICAgIGRpdi5kaXJlY3RDaGlsZHJlbiA9IGhpc3RvcnlbaV0KICAgICAgICBoaXN0b3J5W2ldID0gW10gLy8gZW1wdHkgYXJyYXkKICAgIH0KICAgIGNvbnN0IGNvbGxhcHNlX3NwYW4gPSBhLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1pY29uIHRvYy1jb2xsYXBzZSc+YCkKICAgIGxldCBoaWRlX3N0eWxlID0gYC0taGVpZ2h0OiAke2EuY2xpZW50SGVpZ2h0fXB4YAogICAgY29uc3QgaGlkZV9jb250YWluZXIgPSBkaXYuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWhpZGUtY29udGFpbmVyJyBzdHlsZT0nJHtoaWRlX3N0eWxlfSc+YCkKICAgIGNvbnN0IGhpZGVfc3BhbiA9IGhpZGVfY29udGFpbmVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGh0bWxgPHNwYW4gY2xhc3M9J3RvYy1pY29uIHRvYy1oaWRlJz5gKQogICAgaGlkZV9zcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICB0b2dnbGVfc3RhdGUoJ2hpZGRlbicpKGUpCiAgICAgICAgdXBkYXRlX2hpZGRlbl90b2Nyb3dzKCkKICAgIH0pCiAgICBpZiAoZGl2LmRpcmVjdENoaWxkcmVuID09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbGxhcHNlX3NwYW4uY2xhc3NMaXN0LnRvZ2dsZSgnbm8tY2hpbGRyZW4nLCB0cnVlKQogICAgfSBlbHNlIHsKICAgICAgICBwcm9wYWdhdGVfcGFyZW50KGRpdikKICAgICAgICBjb2xsYXBzZV9zcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlX3N0YXRlKCdjb2xsYXBzZWQnKSkKICAgIH0KICAgIGxldCBtZCA9IGVkaXRvcl9zdGF0ZS5ub3RlYm9vay5jZWxsX2lucHV0c1tpZF0ubWV0YWRhdGEKICAgIGxldCBjb2xsYXBzZWQgPSBvbGRfc3RhdGVbaWRdPy5jb2xsYXBzZWQgPz8gIF8uaW5jbHVkZXMobWRbJ2N1c3RvbV9hdHRycyddLCAndG9jLWNvbGxhcHNlZCcpCiAgICBsZXQgaGlkZGVuID0gb2xkX3N0YXRlW2lkXT8uaGlkZGVuID8/IF8uaW5jbHVkZXMobWRbJ2N1c3RvbV9hdHRycyddLCAndG9jLWhpZGRlbicpCiAgICBzZXRfc3RhdGUoZGl2LCAnY29sbGFwc2VkJywgY29sbGFwc2VkLCB0cnVlKQogICAgc2V0X3N0YXRlKGRpdiwgJ2hpZGRlbicsIGhpZGRlbiwgdHJ1ZSkKICAgIG5ld19zdGF0ZVtpZF0gPSB7IGNvbGxhcHNlZCwgaGlkZGVuIH0KICAgIAp9Cgpjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHsKICAgIGNvbnNvbGUubG9nKCc9PT0gRXh0ZW5kZWRUYWJsZU9mQ29udGVudHMgTXV0YXRpb25PYnNlcnZlciB0cmlnZ2VyZWQgPT09JykKICAgIGNvbnN0IHJvd3MgPSB0b2MucXVlcnlTZWxlY3RvckFsbCgnc2VjdGlvbiBkaXYudG9jLXJvdycpCgogICAgbGV0IG9sZF9zdGF0ZSA9IHdpbmRvdy50b2Nfc3RhdGUgPz8ge30KICAgIGxldCBuZXdfc3RhdGUgPSB7fQogICAgbGV0IGhpc3RvcnkgPSB7CiAgICAgICAgICAgIDI6IFtdLAogICAgICAgICAgICAzOiBbXSwKICAgICAgICAgICAgNDogW10sCiAgICAgICAgICAgIDU6IFtdLAogICAgICAgICAgICA2OiBbXSwKICAgIH0KICAgIGZvciAoY29uc3Qgcm93IG9mIFsuLi5yb3dzXS5yZXZlcnNlKCkpIHsKICAgICAgICBwcm9jZXNzX3Jvdyhyb3csIGhpc3RvcnksIG9sZF9zdGF0ZSwgbmV3X3N0YXRlKQogICAgfQogICAgd2luZG93LnRvY19zdGF0ZSA9IG5ld19zdGF0ZQogICAgdG9jLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbGUtc3RhdGUtZGlmZmVycycsIHN0YXRlRGlmZmVyc0ZpbGUobmV3X3N0YXRlKSkKICAgIHVwZGF0ZV9oaWRkZW5fdG9jcm93cygpCn0pCgpvYnNlcnZlci5vYnNlcnZlKHRvYywge2NoaWxkTGlzdDogdHJ1ZX0pCgovLyBNb3ZlIGVudHJpZXMgaGFuZGxlciBmdW5jdGlvbmFsaXR5CmNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgovLyBXZSBoYXZlIHRvIGVuYWJsZSBkeW5hbWljRHJvcCB0byBoYXZlIGRyb3B6b25lIHJlY29tcHV0ZWQgb24gZHJhZ21vdmUKaW50ZXJhY3QuZHluYW1pY0Ryb3AodHJ1ZSkKCmZ1bmN0aW9uIGRyYWdFbmFibGVyKGUpIHsKICAgIGlmICghdG9jLmNsYXNzTGlzdC5jb250YWlucygnZHJhZ19lbmFibGVkJykgfHwgZS5rZXkgIT09ICdTaGlmdCcpIHsgcmV0dXJuIHRydWUgfQogICAgc3dpdGNoIChlLnR5cGUpIHsKICAgICAgICBjYXNlICJrZXlkb3duIjoKICAgICAgICAgICAgdG9jLmNsYXNzTGlzdC5hZGQoJ2FsbG93X2FsbF9kcm9wJykKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAia2V5dXAiOgogICAgICAgICAgICB0b2MuY2xhc3NMaXN0LnJlbW92ZSgnYWxsb3dfYWxsX2Ryb3AnKQogICAgICAgICAgICBicmVhazsKICAgIH0KICAgIHVwZGF0ZUFjdGl2ZVNlcGFyYXRvcigpCn0KCmNvbnN0IHdpbmRvd19ldmVudHMgPSB7CiAgICBrZXlkb3duOiBkcmFnRW5hYmxlciwKICAgIGtleXVwOiBkcmFnRW5hYmxlciwKfQoKLy8gRnVuY3Rpb24gdG8gYWRkIGFsbCBldmVudCBsaXN0ZW5lcnMgZnJvbSBhbiBldmVudHMgb2JqZWN0CmZ1bmN0aW9uIGFkZFdpbmRvd0V2ZW50TGlzdGVuZXJzKGV2ZW50cykgewogICAgZm9yIChjb25zdCBbZXZlbnRUeXBlLCBoYW5kbGVyXSBvZiBPYmplY3QuZW50cmllcyhldmVudHMpKSB7CiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBoYW5kbGVyKQogICAgfQp9CgovLyBGdW5jdGlvbiB0byByZW1vdmUgYWxsIGV2ZW50IGxpc3RlbmVycyBmcm9tIGFuIGV2ZW50cyBvYmplY3QKZnVuY3Rpb24gcmVtb3ZlV2luZG93RXZlbnRMaXN0ZW5lcnMoZXZlbnRzKSB7CiAgICBmb3IgKGNvbnN0IFtldmVudFR5cGUsIGhhbmRsZXJdIG9mIE9iamVjdC5lbnRyaWVzKGV2ZW50cykpIHsKICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIGhhbmRsZXIpCiAgICB9Cn0KCi8vIEFkZCBldmVudCBsaXN0ZW5lcnMgZGlyZWN0bHkKYWRkV2luZG93RXZlbnRMaXN0ZW5lcnMod2luZG93X2V2ZW50cykKCi8vIEludGVyYWN0LmpzIHBhcnQKCmxldCBhY3RpdmVEcm9wID0gdW5kZWZpbmVkCgpmdW5jdGlvbiB0YWdBZGphY2VudFNlcGFyYXRvcnMoZWwsIGFjdGl2ZSkgewogICAgY29uc3QgbmV4dCA9IGdldE5leHRTaWJsaW5nKGVsLCAnLnRvYy1yb3ctc2VwYXJhdG9yJykKICAgIGNvbnN0IHByZXYgPSBnZXRQcmV2aW91c1NpYmxpbmcoZWwsICcudG9jLXJvdy1zZXBhcmF0b3InKQogICAgaWYgKGFjdGl2ZSkgewogICAgICAgICAgbmV4dD8uY2xhc3NMaXN0LmFkZCgnbm9zaG93JykKICAgICAgICAgIHByZXY/LmNsYXNzTGlzdC5hZGQoJ25vc2hvdycpCiAgICB9IGVsc2UgewogICAgICAgICAgbmV4dD8uY2xhc3NMaXN0LnJlbW92ZSgnbm9zaG93JykKICAgICAgICAgIHByZXY/LmNsYXNzTGlzdC5yZW1vdmUoJ25vc2hvdycpCQkJCQogICAgfQp9CgpmdW5jdGlvbiBnZXRTZXBhcmF0b3Ioc3RhcnRFbGVtZW50LCBiZWxvdywgYWxsb3dBbGwsIGhlYWRpbmdMZXZlbCA9IDgpIHsKICAgIGxldCBzZXBhcmF0b3IKICAgIGlmIChiZWxvdykgewogICAgICAgIGNvbnN0IHNlbGVjdG9yID0gJy50b2Mtcm93Om5vdCgucGFyZW50LWNvbGxhcHNlZCknCiAgICAgICAgY29uc3QgY2hlY2tlckZ1bmMgPSBhbGxvd0FsbCA/IGdlbmVyYXRlQ2hlY2tlcihzZWxlY3RvcikgOiAoZWwpID0+IHsKICAgICAgICAgICAgaWYgKCFlbC5tYXRjaGVzKHNlbGVjdG9yKSkgeyByZXR1cm4gZmFsc2UgfQogICAgICAgICAgICAvLyBDaGVjayBmb3IgdGhlIHJpZ2h0IGhlYWRpbmcgbGV2ZWwKICAgICAgICAgICAgZm9yIChsZXQgaSA9IGhlYWRpbmdMZXZlbDsgaSA+IDA7IGktLSkgewogICAgICAgICAgICAgICAgY29uc3QgY2wgPSAiSCIgKyBpCiAgICAgICAgICAgICAgICBpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNsKSkgeyByZXR1cm4gdHJ1ZSB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICAgIGNvbnN0IHZhbGlkUm93ID0gZ2V0TmV4dFNpYmxpbmcoc3RhcnRFbGVtZW50LCBjaGVja2VyRnVuYykKICAgICAgICAvLyBJZiB0aGUgYWN0aXZlRHJvcCBpcyB0aGUgbGFzdCByb3cgb3IgdGhlIHRoZSBsYXN0IG5vbi1jb2xsYXBzZWQgb25lLCB0aGUgdmFsaWRSb3cgd2lsbCBiZSBgdW5kZWZpbmVkYCwgc28gaW4gdGhhdCBjYXNlIHdlIHRha2UgdGhlIGxhc3Qgc2VwYXJhdG9yCiAgICAgICAgc2VwYXJhdG9yID0gZ2V0UHJldmlvdXNTaWJsaW5nKHZhbGlkUm93LCAnLnRvYy1yb3ctc2VwYXJhdG9yJykgPz8gXy5sYXN0KHRvYy5xdWVyeVNlbGVjdG9yQWxsKCcudG9jLXJvdy1zZXBhcmF0b3InKSkKICAgIH0gZWxzZSB7CiAgICAgICAgc2VwYXJhdG9yID0gZ2V0UHJldmlvdXNTaWJsaW5nKHN0YXJ0RWxlbWVudCwgJy50b2Mtcm93LXNlcGFyYXRvcicpCiAgICB9CiAgICByZXR1cm4gc2VwYXJhdG9yCn0KCmZ1bmN0aW9uIGdldEhpZ2hlclBhcmVudChyb3csIGxldmVsKSB7CiAgICBjb25zdCBjdXJyZW50TGV2ZWwgPSBnZXRIZWFkaW5nTGV2ZWwocm93KQogICAgaWYgKGN1cnJlbnRMZXZlbCA8PSBsZXZlbCkge3JldHVybiByb3d9CiAgICBmb3IgKGNvbnN0IHBhciBvZiByb3cuYWxsUGFyZW50cykgewogICAgICAgIC8vIFBhcmVudHMgY3ljbGUgZnJvbSBoaWdoZXIgbGV2ZWwgdG8gbG93ZXIgbGV2ZWxzCiAgICAgICAgaWYgKGdldEhlYWRpbmdMZXZlbChwYXIpIDw9IGxldmVsKSB7cmV0dXJuIHBhcn0KICAgIH0KICAgIHJldHVybiByb3cKfQogICAgCmxldCB1bmNvbGxhcHNlZCA9IFtdCgpmdW5jdGlvbiByZUNvbGxhcHNlKHJvdykgewogICAgY29uc3QgcGFyZW50cyA9IHJvdz8uYWxsUGFyZW50cyA/PyBbXQogICAgY29uc3QgdG9SZW1vdmUgPSBfLmRpZmZlcmVuY2UodW5jb2xsYXBzZWQsIFsuLi5wYXJlbnRzLCByb3ddKQogICAgZm9yIChjb25zdCBlbCBvZiB0b1JlbW92ZSkgewogICAgICAgIC8vIGRlYnVnZ2VyCiAgICAgICAgc2V0X3N0YXRlKGVsLCAiY29sbGFwc2VkIiwgdHJ1ZSkKICAgICAgICBfLnJlbW92ZSh1bmNvbGxhcHNlZCwgeCA9PiB4ID09PSBlbCkKICAgIH0KfQoKZnVuY3Rpb24gdXBkYXRlRHJvcFpvbmUocm93KSB7CiAgICBjb25zdCBwcmV2ID0gdG9jLnF1ZXJ5U2VsZWN0b3IoJy50b2Mtcm93LmFjdGl2ZV9kcm9wJykKICAgIGlmIChfLmlzTmlsKHJvdykgfHwgcHJldiA9PT0gcm93KSB7cmV0dXJufQogICAgaWYgKHByZXY/LnRpbWVvdXRJZCkgewogICAgICAgIGNsZWFyVGltZW91dChwcmV2LnRpbWVvdXRJZCkKICAgICAgICBwcmV2LnRpbWVvdXRJZCA9IHVuZGVmaW5lZAogICAgfQogICAgcHJldj8uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlX2Ryb3AnKQogICAgcm93LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZV9kcm9wJykKICAgIHJlQ29sbGFwc2Uocm93KQogICAgaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbGxhcHNlZCcpKSB7CiAgICAgICAgcm93LnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB1bmNvbGxhcHNlZC5wdXNoKHJvdykKICAgICAgICAgICAgc2V0X3N0YXRlKHJvdywgImNvbGxhcHNlZCIsIGZhbHNlKQogICAgICAgICAgICB1cGRhdGVBY3RpdmVTZXBhcmF0b3IoKQogICAgICAgIH0sIDUwMCkKICAgIH0KICAgIGFjdGl2ZURyb3AgPSByb3cKfQoKZnVuY3Rpb24gdXBkYXRlQWN0aXZlU2VwYXJhdG9yKCkgewogICAgY29uc3QgZSA9IHRvYy5sYXN0RHJhZ0V2ZW50CiAgICBpZiAoXy5pc05pbChlKSkgeyByZXR1cm4gfQogICAgY29uc3QgZWxCZWxvdyA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZS5jbGllbnQueCwgZS5jbGllbnQueSkKICAgIGlmICghZWxCZWxvdy5tYXRjaGVzKCcucGx1dG91aS10b2MgOnNjb3BlJykpIHsKICAgICAgICAvLyBXZSBhcmUgb3V0IG9mIHRoZSBUb0MsIHJlY29sbGFwc2UgYW5kIHJlbW92ZSBhY3RpdmUgc2VwYXJhdG9yCiAgICAgICAgcmVDb2xsYXBzZSh1bmRlZmluZWQpCiAgICAgICAgdG9jLnF1ZXJ5U2VsZWN0b3IoJy50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUnKT8uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykKICAgICAgICByZXR1cm4KICAgIH0KICAgIGNvbnN0IHJvd0JlbG93ID0gZ2V0Um93KGVsQmVsb3cpCiAgICB1cGRhdGVEcm9wWm9uZShyb3dCZWxvdykKICAgIGlmIChfLmlzTmlsKGFjdGl2ZURyb3ApKSB7cmV0dXJufQogICAgY29uc3QgYWxsb3dBbGwgPSB0b2MuY2xhc3NMaXN0LmNvbnRhaW5zKCdhbGxvd19hbGxfZHJvcCcpCiAgICBjb25zdCBoZWFkaW5nTGV2ZWwgPSBnZXRIZWFkaW5nTGV2ZWwodG9jLmRyYWdnZWRFbGVtZW50KQogICAgY29uc3QgeyB5LCBoZWlnaHQgfSA9IGFjdGl2ZURyb3AuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKICAgIGxldCB0aHJlc2hvbGRZID0geSArIGhlaWdodC8yCiAgICBpZiAoIWFsbG93QWxsKSB7CiAgICAgICAgLy8gV2Ugb25seSBhbGxvdyBwdXR0aW5nIHRoZSBkcmFnZ2VkIGVsZW1lbnQgYWJvdmUvYmVsb3cgcm93cyB3aXRoIGVxdWFsIG9yIGhpZ2hlciBoZWFkaW5nIGxldmVsCiAgICAgICAgY29uc3QgY3VycmVudEhlYWRpbmdMZXZlbCA9IGdldEhlYWRpbmdMZXZlbChhY3RpdmVEcm9wKQogICAgICAgIGlmIChjdXJyZW50SGVhZGluZ0xldmVsID4gaGVhZGluZ0xldmVsKSB7CiAgICAgICAgICAgIC8vIFdlIHVwZGF0ZSB0aGUgdGhyZXNob2xkIGJhc2VkIG9uIHRoZSByZWxldmFudCBwYXJlbnQKICAgICAgICAgICAgY29uc3QgcGFyID0gZ2V0SGlnaGVyUGFyZW50KGFjdGl2ZURyb3AsIGhlYWRpbmdMZXZlbCkKICAgICAgICAgICAgY29uc3QgeyB5LCBoZWlnaHQgfSA9IHBhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQogICAgICAgICAgICB0aHJlc2hvbGRZID0geSArIGhlaWdodC8yCQkJCQkJCiAgICAgICAgfQogICAgfQogICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIG1vdXNlIGlzIGJlbG93IG9yIGFib3ZlIHRoZSBtaWRkbGUgb2YgdGhlIGFjdGl2ZSBkcm9wIHpvbmUKICAgIGNvbnN0IGlzQmVsb3cgPSBlLmNsaWVudC55ID4gdGhyZXNob2xkWQogICAgY29uc3QgbmV3U2VwID0gZ2V0U2VwYXJhdG9yKGFjdGl2ZURyb3AsIGlzQmVsb3csIGFsbG93QWxsLCBoZWFkaW5nTGV2ZWwpCiAgICBjb25zdCBjdXJyZW50U2VwID0gdG9jLnF1ZXJ5U2VsZWN0b3IoJy50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUnKSA/PyBuZXdTZXAKICAgIGlmIChjdXJyZW50U2VwICE9PSBuZXdTZXApIHsKICAgICAgICBjdXJyZW50U2VwLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpCiAgICB9CiAgICBuZXdTZXAuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJykKfQoKY29uc3QgZHJhZ0hhbmRsZXMgPSBpbnRlcmFjdCgnLnRvYy1yb3cnKS5kcmFnZ2FibGUoewogICAgY3Vyc29yQ2hlY2tlciAoYWN0aW9uLCBpbnRlcmFjdGFibGUsIGVsZW1lbnQsIGludGVyYWN0aW5nKSB7CiAgICAgICAgLy8gY29uc29sZS5sb2coe2FjdGlvbiwgaW50ZXJhY3RhYmxlLCBlbGVtZW50LCBpbnRlcmFjdGluZ30pCiAgICAgICAgcmV0dXJuIG51bGwKICAgIH0sCiAgICBtYW51YWxTdGFydDogdHJ1ZSwgLy8gbmVlZGVkIGZvciBjb25zaXN0ZW50IHN0YXJ0IGFmdGVyIGhvbGQKICAgIGxpc3RlbmVyczogewogICAgICAgIHN0YXJ0OiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICB0b2MuY2xhc3NMaXN0LmFkZCgnZHJhZ19lbmFibGVkJykKICAgICAgICAgICAgY29uc3Qgcm93ID0gZS50YXJnZXQKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3N0YXJ0OiAnLCBlKQogICAgICAgICAgICB0b2MubGFzdERyYWdFdmVudCA9IGUKICAgICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ2RyYWdnZWQnKQogICAgICAgICAgICB0b2MuZHJhZ2dlZEVsZW1lbnQgPSByb3cKICAgICAgICAgICAgdGFnQWRqYWNlbnRTZXBhcmF0b3JzKHJvdywgdHJ1ZSkKICAgICAgICB9LAogICAgICAgIG1vdmU6IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHRvYy5sYXN0RHJhZ0V2ZW50ID0gZQogICAgICAgICAgICB1cGRhdGVBY3RpdmVTZXBhcmF0b3IoKQogICAgICAgIH0sCiAgICAgICAgLy8gbW92ZTogZnVuY3Rpb24gKGUpIHtjb25zb2xlLmxvZygnbW92ZTogJyxlKX0sCiAgICAgICAgZW5kOiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBhY3RpdmVEcm9wID0gdW5kZWZpbmVkCiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKQogICAgICAgICAgICB0b2MubGFzdERyYWdFdmVudCA9IGUKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2VuZDogJywgZSkKICAgICAgICAgICAgY29uc3Qgcm93ID0gZS50YXJnZXQKICAgICAgICAgICAgLy8gQ2xlYW51cAogICAgICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dlZCcpCiAgICAgICAgICAgIHRvYy5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnX2VuYWJsZWQnKQkKICAgICAgICAgICAgZm9yIChjb25zdCBlbCBvZiB0b2MucXVlcnlTZWxlY3RvckFsbCgnLmFjdGl2ZV9kcm9wJykpIHsKICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZV9kcm9wJykKICAgICAgICAgICAgfQogICAgICAgICAgICByZUNvbGxhcHNlKCkJCQkJCiAgICAgICAgICAgIHRhZ0FkamFjZW50U2VwYXJhdG9ycyhyb3csIGZhbHNlKQkJCQkKICAgICAgICAgICAgdG9jLmNsYXNzTGlzdC5yZW1vdmUoJ2FsbG93X2FsbF9kcm9wJykKICAgICAgICAgICAgLy8gV2UgdGVtcG9yYXJ5IHNldCB0aGUgcmVjZW50RHJhZyBmbGFnCiAgICAgICAgICAgIHRvYy5jbGFzc0xpc3QuYWRkKCdyZWNlbnQtZHJhZycpCiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgdG9jLmNsYXNzTGlzdC5yZW1vdmUoJ3JlY2VudC1kcmFnJykKICAgICAgICAgICAgfSwgMzAwKQogICAgICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBhY3RpdmUgZHJvcHpvbmUKICAgICAgICAgICAgY29uc3QgZHJvcFpvbmUgPSB0b2MucXVlcnlTZWxlY3RvcignLnRvYy1yb3ctc2VwYXJhdG9yLmFjdGl2ZScpCiAgICAgICAgICAgIGlmIChfLmlzTmlsKGRyb3Bab25lKSB8fCBkcm9wWm9uZS5jbGFzc0xpc3QuY29udGFpbnMoJ25vc2hvdycpKSB7cmV0dXJufQogICAgICAgICAgICBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKQogICAgICAgICAgICAvLyBXZSBmaW5kIHRoZSBjZWxsIGFmdGVyIHRoZSBhY3RpdmUgc2VwYXJhdG9yIGFuZCBtb3ZlIHRoZSBkcmFnZ2VkIHJvdyBiZWZvcmUgdGhhdAogICAgICAgICAgICBjb25zdCByb3dBZnRlciA9IGdldE5leHRTaWJsaW5nKGRyb3Bab25lKQogICAgICAgICAgICBjb25zdCBjZWxsSWRzVG9Nb3ZlID0gZ2V0QmxvY2tJZHMocm93KQogICAgICAgICAgICAvLyBGaW5kIHRoZSBpbmRleCBvZiB0aGUgY2VsbCB0aGF0IHdpbGwgc3RheSBhZnRlciBvdXIgbW92ZWQgYmxvY2sKICAgICAgICAgICAgY29uc3QgZW5kID0gZWRpdG9yX3N0YXRlLm5vdGVib29rLmNlbGxfb3JkZXIuaW5kZXhPZihnZXRfbGlua19pZChyb3dBZnRlcikpCiAgICAgICAgICAgIC8vIElmIHdlIGdvdCAtMSwgaXQgbWVhbnMgd2UgaGF2ZSB0byBwdXQgdGhlIGNlbGxzIGF0IHRoZSBlbmQKICAgICAgICAgICAgcGx1dG9fYWN0aW9ucy5tb3ZlX3JlbW90ZV9jZWxscyhjZWxsSWRzVG9Nb3ZlLCBlbmQgPCAwID8gSW5maW5pdHkgOiBlbmQpCiAgICAgICAgICAgIHRvYy5kcmFnZ2VkRWxlbWVudCA9IHVuZGVmaW5lZAkJCiAgICAgICAgfSwKICAgIH0KfSkub24oJ2hvbGQnLGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVfdWknKSkgeyBjb25zb2xlLmxvZygnVUkgZGlzYWJsZWQsIG5vIGludGVyYWN0aW9uIScpOyByZXR1cm4gfQogICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpCiAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAvLyBjb25zb2xlLmxvZygndGhpcyBpcyBob2xkJywgZSkKICAgIHZhciBpbnRlcmFjdGlvbiA9IGUuaW50ZXJhY3Rpb24KCiAgICBpZiAoIWludGVyYWN0aW9uLmludGVyYWN0aW5nKCkpIHsKICAgICAgaW50ZXJhY3Rpb24uc3RhcnQoCiAgICAgICAgeyBuYW1lOiAnZHJhZycgfSwKICAgICAgICBlLmludGVyYWN0YWJsZSwKICAgICAgICBlLmN1cnJlbnRUYXJnZXQsCiAgICAgICkKICAgIH0KfSkKCi8vIEhlYWRlciBtYW5pcHVsYXRpb24gZnVuY3Rpb25hbGl0eQpjb25zdCBoZWFkZXIgPSB0b2MucXVlcnlTZWxlY3RvcignaGVhZGVyJykKY29uc3QgaGVhZGVyX2NvbnRhaW5lciA9IGhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBodG1sYDxzcGFuIGNsYXNzPSd0b2MtaGVhZGVyLWNvbnRhaW5lcic+YCkKCmNvbnN0IG5vdGVib29rX2hpZGVfaWNvbiA9IGhlYWRlcl9jb250YWluZXIuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdiZWZvcmVlbmQnLCBodG1sYDxzcGFuIGNsYXNzPSd0b2MtaGVhZGVyLWljb24gdG9jLWhlYWRlci1oaWRlJz5gKQoKY29uc3Qgc2F2ZV9maWxlX2ljb24gPSBoZWFkZXJfY29udGFpbmVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWhlYWRlci1pY29uIHRvYy1oZWFkZXItc2F2ZSc+YCkKc2F2ZV9maWxlX2ljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzYXZlX3RvX2ZpbGUpCgpoZWFkZXJfY29udGFpbmVyLmluc2VydEFkamFjZW50RWxlbWVudCgnYmVmb3JlZW5kJywgaHRtbGA8c3BhbiBjbGFzcz0ndG9jLWhlYWRlci1maWxsZXInPmApCgpoZWFkZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHsKICAgIGlmIChlLnRhcmdldCAhPSBoZWFkZXIpIHtyZXR1cm59CiAgICBzY3JvbGxfdG8oY2VsbCwge2Jsb2NrOiAnY2VudGVyJywgYmVoYXZpb3I6ICdzbW9vdGgnfSkKfSkKCmhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKGUpID0+IHsKICAgIGNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uIH0gPSBmbG9hdGluZ191aQogICAgCiAgICAvLyBHZXQgdGhlIHNjcm9sbCBjb250YWluZXIgLSB0aGlzIGlzIGNydWNpYWwgZm9yIHByb3BlciBvZmZzZXQgY2FsY3VsYXRpb24KICAgIGNvbnN0IHNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQKICAgIGNvbnN0IHNjcm9sbFRvcCA9IHNjcm9sbENvbnRhaW5lci5zY3JvbGxUb3AgfHwgd2luZG93LnBhZ2VZT2Zmc2V0CiAgICAKICAgIGNvbXB1dGVQb3NpdGlvbihoZWFkZXIsIGhlYWRlcl9jb250YWluZXIsIHsKICAgICAgICBwbGFjZW1lbnQ6ICJsZWZ0IiwKICAgICAgICBzdHJhdGVneTogImZpeGVkIiwKICAgIH0pLnRoZW4ocG9zID0+IHsKICAgICAgICBoZWFkZXJfY29udGFpbmVyLnN0eWxlLnRvcCA9IHBvcy55IC0gc2Nyb2xsVG9wICsgInB4IgogICAgICAgIC8vIGhlYWRlcl9jb250YWluZXIuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgogICAgICAgIC8vIGhlYWRlcl9jb250YWluZXIuc3R5bGUucmlnaHQgPSBgY2FsYygxcmVtICsgbWluKDgwdncsIDMwMHB4KSlgCiAgICB9KQp9KQoKbm90ZWJvb2tfaGlkZV9pY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgICAgICAvLyBXZSBmaW5kIHRoZSB4IGNvb3JkaW5hdGUgb2YgdGhlIHBsdXRvLW5vdGVib29rIGVsZW1lbnQsIHRvIGF2b2lkIG1pc3NpbmcgdGhlIGNlbGwgd2hlbiBVSSBpcyBkaXNhYmxlZAogICAgICAgIGNvbnN0IHsgeCB9ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncGx1dG8tbm90ZWJvb2snKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQogICAgICAgIGNvbnN0IHJlZiA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeCsxLDEwMCkuY2xvc2VzdCgncGx1dG8tY2VsbCcpCiAgICAgICAgY29uc3QgeyB5IH0gPSByZWYuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKICAgICAgICB0b2dnbGVfbm90ZWJvb2tfYXR0cmlidXRlKCdoaWRlLWVuYWJsZWQnKQogICAgICAgIGNvbnN0IGR5ID0gcmVmLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkgLSB5CiAgICAgICAgd2luZG93LnNjcm9sbEJ5KDAsIGR5KQp9KQoKLy8gU2F2ZSB0byBmaWxlIGZ1bmN0aW9uYWxpdHkKZnVuY3Rpb24gc2F2ZV90b19maWxlKCkgewogICAgY29uc3Qgc3RhdGUgPSB3aW5kb3cudG9jX3N0YXRlCiAgICBmb3IgKGNvbnN0IFtrLHZdIG9mIE9iamVjdC5lbnRyaWVzKHN0YXRlKSkgewogICAgICAgIHRvZ2dsZV9jZWxsX2F0dHJpYnV0ZShrLCAndG9jLWhpZGRlbicsIHYuaGlkZGVuKQkKICAgICAgICB0b2dnbGVfY2VsbF9hdHRyaWJ1dGUoaywgJ3RvYy1jb2xsYXBzZWQnLCB2LmNvbGxhcHNlZCkJCiAgICB9CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0b2MuY2xhc3NMaXN0LnRvZ2dsZSgnZmlsZS1zdGF0ZS1kaWZmZXJzJywgc3RhdGVEaWZmZXJzRmlsZShzdGF0ZSkpCiAgICB9LCA1MDApCn0KCi8vIE1ha2UgZnVuY3Rpb25zIGF2YWlsYWJsZSBnbG9iYWxseQp3aW5kb3cuc2Nyb2xsX3RvID0gc2Nyb2xsX3RvOwp3aW5kb3cuc2F2ZV90b19maWxlID0gc2F2ZV90b19maWxlOwp3aW5kb3cuZmxvYXRpbmdfdWkgPSBmbG9hdGluZ191aTsKCi8vIFNldCBjZWxsIGF0dHJpYnV0ZSBmb3IgYWx3YXlzLXNob3cKY2VsbC50b2dnbGVBdHRyaWJ1dGUoJ2Fsd2F5cy1zaG93JywgdHJ1ZSkKCmludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKQogICAgZHJhZ0hhbmRsZXMudW5zZXQoKQogICAgLy8gQ2xlYW4gdXAgZXZlbnQgbGlzdGVuZXJzCiAgICByZW1vdmVXaW5kb3dFdmVudExpc3RlbmVycyh3aW5kb3dfZXZlbnRzKQp9KQo8L3NjcmlwdD4KCjxzdHlsZT4KLyogTG9hZCBDU1Mgc3R5bGVzIGRpcmVjdGx5ICovCi8qIEV4dGVuZGVkIFRhYmxlIG9mIENvbnRlbnRzIENTUyBTdHlsZXMgKi8KCi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgIEhlYWRlciBTdHlsZXMKICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KCi5wbHV0b3VpLXRvYyBoZWFkZXIgewogICAgY3Vyc29yOiBwb2ludGVyOwp9CgpzcGFuLnRvYy1oZWFkZXItY29udGFpbmVyIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICAtLXNpemU6IDI1cHg7CiAgICBoZWlnaHQ6IGNhbGMoNTFweCAtIDFyZW0pOwogICAgZmxleC1kaXJlY3Rpb246IHJvdy1yZXZlcnNlOwogICAgcmlnaHQ6IGNhbGMoMXJlbSArIG1pbig4MHZoLCAzMDBweCkpOwp9CgoudG9jLWhlYWRlci1pY29uIHsKICAgIG1hcmdpbi1yaWdodDogMC4zcmVtOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKLnRvYy1oZWFkZXItZmlsbGVyIHsKICAgIG1hcmdpbjogLjI1cmVtOwp9CgpoZWFkZXI6aG92ZXIgc3Bhbi50b2MtaGVhZGVyLWNvbnRhaW5lciwKc3Bhbi50b2MtaGVhZGVyLWNvbnRhaW5lcjpob3ZlciB7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgoudG9jLWhlYWRlci1oaWRlIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2V5ZS1vdXRsaW5lLnN2Zyk7CiAgICBvcGFjaXR5OiA1MCU7CiAgICAtLXNpemU6IDFlbTsKfQoKLnRvYy1oZWFkZXItc2F2ZSB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9zYXZlLW91dGxpbmUuc3ZnKTsKICAgIG9wYWNpdHk6IDUwJTsKfQoKbmF2Om5vdCguZmlsZS1zdGF0ZS1kaWZmZXJzKSAudG9jLWhlYWRlci1zYXZlIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gc3Bhbi50b2MtaGVhZGVyLWhpZGUgewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXllLW9mZi1vdXRsaW5lLnN2Zyk7Cn0KCi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgIFRhYmxlIG9mIENvbnRlbnRzIFJvdyBTdHlsZXMKICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KCnNwYW4udG9jLWhpZGUtY29udGFpbmVyIHsKICAgIC0td2lkdGg6IG1pbig4MHZ3LCAzMDBweCk7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgcmlnaHQ6IGNhbGModmFyKC0td2lkdGgpICsgMXJlbSArIDIycHggLSAxMDBweCk7CiAgICBoZWlnaHQ6IHZhcigtLWhlaWdodCk7CiAgICB3aWR0aDogMTAwcHg7CiAgICB6LWluZGV4OiAtMTsKfQoKc3Bhbi50b2MtaGlkZSB7CiAgICB2aXNpYmlsaXR5OiBoaWRkZW47CiAgICBvcGFjaXR5OiA1MCU7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leWUtb3V0bGluZS5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9CgpkaXYudG9jLXJvdy5oaWRkZW4gc3Bhbi50b2MtaGlkZSB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leWUtb2ZmLW91dGxpbmUuc3ZnKTsKfQoKc3Bhbi50b2MtaGlkZS1jb250YWluZXI6aG92ZXIgPiAudG9jLWhpZGUsCmRpdi50b2Mtcm93OmhvdmVyIC50b2MtaGlkZSB7CiAgICB2aXNpYmlsaXR5OiB2aXNpYmxlOwp9CgpkaXYudG9jLXJvdyBhIHsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCnNwYW4udG9jLWljb24gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9CgpzcGFuLnRvYy1jb2xsYXBzZSB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIG1hcmdpbi1yaWdodDogM3B4OwogICAgbWluLXdpZHRoOiB2YXIoLS1zaXplKTsKfQoKLnBsdXRvdWktdG9jIHNlY3Rpb24gZGl2LnRvYy1yb3cuY29sbGFwc2VkIHNwYW4udG9jLWNvbGxhcHNlIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9CgoucGx1dG91aS10b2Mgc2VjdGlvbiBkaXYudG9jLXJvdyBhIHNwYW4udG9jLWNvbGxhcHNlLm5vLWNoaWxkcmVuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IG5vbmU7Cn0KCmRpdi50b2Mtcm93LnBhcmVudC1oaWRkZW4gewogICAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmUgZG90dGVkIC41cHg7CiAgICB0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDJweDsKfQoKZGl2LnRvYy1yb3cuaGlkZGVuIHsKICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lIGRhc2hlZCAxcHg7CiAgICB0ZXh0LXVuZGVybGluZS1vZmZzZXQ6IDJweDsKfQoKLnBsdXRvdWktdG9jIGRpdi5wYXJlbnQtY29sbGFwc2VkIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gZGl2LnRvYy1yb3cuaGlkZGVuLApwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIGRpdi50b2Mtcm93LnBhcmVudC1oaWRkZW4gewogICAgZGlzcGxheTogbm9uZTsKfQoKLmRyYWdfZW5hYmxlZCAudG9jLXJvdy5kcmFnZ2VkIHsKICAgIGJvcmRlcjogMnB4IGRhc2hlZCBncmV5Owp9CgovKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICBSb3cgU2VwYXJhdG9yIFN0eWxlcwogICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwoKZGl2LnRvYy1yb3ctc2VwYXJhdG9yIHsKICAgIGhlaWdodDogMnB4OwogICAgbWFyZ2luOiAzcHggMHB4OwogICAgYmFja2dyb3VuZDogI2FhYTsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCmRpdi50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUgewogICAgZGlzcGxheTogYmxvY2s7Cn0KCmRpdi50b2Mtcm93LXNlcGFyYXRvci5hY3RpdmUubm9zaG93IHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgIE1haW4gQ2VsbCBIaWRpbmdzCiAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCgpwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbdG9jLWhpZGRlbl0gewogICAgZGlzcGxheTogbm9uZTsKfQoKLyogVGhpcyBzdHlsZSBwZXJtaXRzIHRvIGhhdmUgYSBjZWxsIHdob3NlIG91dHB1dCBpcyBzdGlsbCBiZWluZyBzaG93biB3aGVuCiAgIHRoZSBjZWxsIGlzIGhpZGRlbi4gVGhpcyBpcyB1c2VmdWwgZm9yIGhhdmluZyBoaWRkZW4gY2VsbHMgdGhhdCBzdGlsbCBhcmUKICAgc2VuZGluZyBIVE1MIGFzIG91dHB1dCAobGlrZSBUb0MgYW5kIEJvbmRUYWJsZSkgKi8KCnBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdW3RvYy1oaWRkZW5dIHsKICAgIGRpc3BsYXk6IGJsb2NrOwp9CgpwbHV0by1ub3RlYm9va1toaWRlLWVuYWJsZWRdIHBsdXRvLWNlbGxbYWx3YXlzLXNob3ctb3V0cHV0XVt0b2MtaGlkZGVuXTpub3QoLmNvZGVfZGlmZmVycykgPiBwbHV0by1pbnB1dCwKcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF1bdG9jLWhpZGRlbl06bm90KC5jb2RlX2RpZmZlcnMpID4gcGx1dG8tc2hvdWxkZXIsCnBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdW3RvYy1oaWRkZW5dOm5vdCguY29kZV9kaWZmZXJzKSA+IHBsdXRvLXRyYWZmaWNsaWdodCwKcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF1bdG9jLWhpZGRlbl06bm90KC5jb2RlX2RpZmZlcnMpID4gcGx1dG8tcnVuYXJlYSwKcGx1dG8tbm90ZWJvb2tbaGlkZS1lbmFibGVkXSBwbHV0by1jZWxsW2Fsd2F5cy1zaG93LW91dHB1dF1bdG9jLWhpZGRlbl06bm90KC5jb2RlX2RpZmZlcnMpID4gYnV0dG9uIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnBsdXRvLW5vdGVib29rW2hpZGUtZW5hYmxlZF0gcGx1dG8tY2VsbFthbHdheXMtc2hvdy1vdXRwdXRdW3RvYy1oaWRkZW5dOm5vdCguY29kZV9kaWZmZXJzKSB7CiAgICBtYXJnaW4tdG9wOiAwcHg7Cn0KCjwvc3R5bGU+CqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZAB/ZaIbBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXN5T+1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5g6hlbGVtZW50c5OSoWGSoTGqdGV4dC9wbGFpbpKhYpKhMap0ZXh0L3BsYWlukqFjkqExqnRleHQvcGxhaW6kdHlwZapOYW1lZFR1cGxlqG9iamVjdGlksDJhOWMxNTZjYTU1ZTY3YzWkbWltZdkhYXBwbGljYXRpb24vdm5kLnBsdXRvLnRyZWUrb2JqZWN0rHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAJPh+GsHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZUO1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijQVNEqGVsZW1lbnRzlZKhYZKhMap0ZXh0L3BsYWlukqFikqE2qnRleHQvcGxhaW6SoWOSoiIiqnRleHQvcGxhaW6SoWSSoiIiqnRleHQvcGxhaW6SoWWSojIwqnRleHQvcGxhaW6kdHlwZaZzdHJ1Y3SscHJlZml4X3Nob3J0o0FTRKhvYmplY3RpZLAzMDBjOGZmOTNmNGEyNDE1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACT3/2rBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkZTdkNjc2NjItNzdiMy00ODJhLWIwMzItOGRiNGFmYmMwMWE2uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWU+tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAziqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoU8jxzY3JpcHQgaWQ9J2Zyb21wYWNrYWdlLXRleHQtcmVwbGFjZSc+CiAgLy8gV2UgaGF2ZSBhIG11dGF0aW9ub2JzZXJ2ZXIgZm9yIGVhY2ggY2VsbDoKICBjb25zdCBub3RlYm9vayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3BsdXRvLW5vdGVib29rJykKCiAgY29uc3QgbXV0X29ic2VydmVycyA9IHsKICAgIGN1cnJlbnQ6IFtdLAogIH0KICBjdXJyZW50U2NyaXB0Lm11dF9vYnNlcnZlcnMgPSBtdXRfb2JzZXJ2ZXJzCiAgZnVuY3Rpb24gcmVwbGFjZVRleHRJbk5vZGUobm9kZSwgcGF0dGVybiwgcmVwbGFjZW1lbnQsIG9yaWdpbmFscyA9IFtdKSB7CiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHsKICAgICAgY29uc3QgY29udGVudCA9IG5vZGUudGV4dENvbnRlbnQKICAgICAgaWYgKCFwYXR0ZXJuLnRlc3QoY29udGVudCkpIHtyZXR1cm59CiAgICAgIG9yaWdpbmFscy5wdXNoKHtub2RlLCBjb250ZW50fSkKICAgICAgbm9kZS50ZXh0Q29udGVudCA9IGNvbnRlbnQucmVwbGFjZShwYXR0ZXJuLCByZXBsYWNlbWVudCk7CiAgICB9IGVsc2UgewogICAgICBub2RlLmNoaWxkTm9kZXMuZm9yRWFjaChjaGlsZCA9PiByZXBsYWNlVGV4dEluTm9kZShjaGlsZCwgcGF0dGVybiwgcmVwbGFjZW1lbnQsIG9yaWdpbmFscykpOwogICAgfQogIH0KICBmdW5jdGlvbiBleGVjdXRlX2NlbGxfb2JzZXJ2ZXIob2JzZXJ2ZXIpIHsKICAgIGlmIChpbnZhbGlkYXRlZC5jdXJyZW50KSB7CiAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKQogICAgICByZXR1cm4KICAgIH0KICAgIGNvbnN0IHsgY2VsbCwgcmVnZXgsIHJlcGxhY2VtZW50LCBvcmlnaW5hbHMgfSA9IG9ic2VydmVyCiAgICBjb25zdCBvdXRwdXQgPSBjZWxsLnF1ZXJ5U2VsZWN0b3IoJ3BsdXRvLW91dHB1dCcpCiAgICBjb25zdCBjb250ZW50ID0gb3V0cHV0Lmxhc3RDaGlsZAogICAgcmVwbGFjZVRleHRJbk5vZGUoY29udGVudCwgcmVnZXgsIHJlcGxhY2VtZW50LCBvcmlnaW5hbHMpOwogIH0KCiAgZnVuY3Rpb24gcmV2ZXJ0X2NlbGxfb3JpZ2luYWxfdGV4dChvYnNlcnZlcikgewogICAgb2JzZXJ2ZXIub3JpZ2luYWxzPy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICBpdGVtLm5vZGUudGV4dENvbnRlbnQgPSBpdGVtLmNvbnRlbnQKICAgIH0pCiAgfQoKICBjdXJyZW50U2NyaXB0LnJldmVydF9vcmlnaW5hbF90ZXh0ID0gKCkgPT4gewogICAgbXV0X29ic2VydmVycy5jdXJyZW50LmZvckVhY2gocmV2ZXJ0X2NlbGxfb3JpZ2luYWxfdGV4dCkKICB9CgogIGNvbnN0IGludmFsaWRhdGVkID0geyBjdXJyZW50OiBmYWxzZSB9CgogIGNvbnN0IGNyZWF0ZUNlbGxPYnNlcnZlcnMgPSAoKSA9PiB7CiAgICBtdXRfb2JzZXJ2ZXJzLmN1cnJlbnQuZm9yRWFjaCgobykgPT4gby5kaXNjb25uZWN0KCkpCiAgICBtdXRfb2JzZXJ2ZXJzLmN1cnJlbnQgPSBBcnJheS5mcm9tKG5vdGVib29rLnF1ZXJ5U2VsZWN0b3JBbGwoInBsdXRvLWNlbGwiKSkubWFwKGVsID0+IHsKICAgICAgY29uc3QgbyA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMsIG9ic2VydmVyKSA9PiB7ZXhlY3V0ZV9jZWxsX29ic2VydmVyKG9ic2VydmVyKX0pCiAgICAgIG8uY2VsbCA9IGVsCiAgICAgIG8ucmVnZXggPSAvTWFpblwudmFyIndvcmtzcGFjZSM0NjEiXC52YXIiIyNUZW1wTW9kdWxlIzIzOTUiKFwuUGx1dG9FeHRyYXMpPy9nCiAgICAgIG8ucmVwbGFjZW1lbnQgPSAnUGx1dG9FeHRyYXMnCiAgICAgIG8ub3JpZ2luYWxzID0gW10KICAgICAgby5vYnNlcnZlKGVsLCB7IGF0dHJpYnV0ZUZpbHRlcjogWyJjbGFzcyJdIH0pCiAgICAgIGV4ZWN1dGVfY2VsbF9vYnNlcnZlcihvKQogICAgICByZXR1cm4gbwogICAgfSkKICB9CiAgY3JlYXRlQ2VsbE9ic2VydmVycygpCgogIC8vIEFuZCBvbmUgZm9yIHRoZSBub3RlYm9vaydzIGNoaWxkIGxpc3QsIHdoaWNoIHVwZGF0ZXMgb3VyIGNlbGwgb2JzZXJ2ZXJzOgogIGNvbnN0IG5vdGVib29rT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zLCBvYnNlcnZlcikgPT4gewogICAgaWYgKGludmFsaWRhdGlvbi5jdXJyZW50KSB7CiAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKQogICAgICByZXR1cm4KICAgIH0KICAgIGNyZWF0ZUNlbGxPYnNlcnZlcnMoKQogIH0pCiAgbm90ZWJvb2tPYnNlcnZlci5vYnNlcnZlKG5vdGVib29rLCB7IGNoaWxkTGlzdDogdHJ1ZSB9KQoKICBjb25zdCBjZWxsID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCdwbHV0by1jZWxsJykKCiAgaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewogICAgaW52YWxpZGF0ZWQuY3VycmVudCA9IHRydWUKICAgIGNvbnN0IHJldmVydCA9IGNlbGw/LnF1ZXJ5U2VsZWN0b3IoInNjcmlwdFtpZD0nZnJvbXBhY2thZ2UtdGV4dC1yZXBsYWNlJ10iKSA9PSBudWxsCiAgICBub3RlYm9va09ic2VydmVyLmRpc2Nvbm5lY3QoKQogICAgbXV0X29ic2VydmVycy5jdXJyZW50LmZvckVhY2goKG8pID0+IHsKICAgICAgcmV2ZXJ0ICYmIHJldmVydF9jZWxsX29yaWdpbmFsX3RleHQobykKICAgICAgby5kaXNjb25uZWN0KCkKICAgIH0pCiAgfSkKPC9zY3JpcHQ+CiAgIDxzY3JpcHQgaWQ9J2h0bWxfcmVsb2FkX2J1dHRvbic+CiAgY29uc3QgY29udGFpbmVyID0gaHRtbGA8ZnJvbXBhcmVudC1jb250YWluZXIgY2xhc3M9J1BsdXRvRXh0cmFzJz5gCiAgLy8gV2Ugc2V0IHRoZSBlcnJvcmVkIHN0YXRlCiAgY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2Vycm9yZWQnLCBmYWxzZSkKICBjb25zdCBzdHlsZSA9IGNvbnRhaW5lci5hcHBlbmRDaGlsZChodG1sYDxzdHlsZT5gKQogIHN0eWxlLmlubmVySFRNTCA9IGBmcm9tcGFyZW50LWNvbnRhaW5lciB7CiAgaGVpZ2h0OiAyMHB4OwogIHBvc2l0aW9uOiBmaXhlZDsKICB0b3A6IDQwcHg7CiAgcmlnaHQ6IDEwcHg7CiAgbWFyZ2luLXRvcDogNXB4OwogIHBhZGRpbmctcmlnaHQ6IDVweDsKICB6LWluZGV4OiAyMDA7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogIHBhZGRpbmc6IDVweCA4cHg7CiAgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tb3ZlcmxheS1idXR0b24tYm9yZGVyKTsKICBib3JkZXItcmFkaXVzOiAxMnB4OwogIGhlaWdodDogMzVweDsKICBmb250LWZhbWlseTogIlNlZ29lIFVJIEVtb2ppIiwgIlJvYm90byBNb25vIiwgbW9ub3NwYWNlOwogIGZvbnQtc2l6ZTogMC43NXJlbTsKICB2aXNpYmlsaXR5OiB2aXNpYmxlOwp9Cgpmcm9tcGFyZW50LWNvbnRhaW5lci5QbHV0b0Rldk1hY3JvcyB7CiAgcmlnaHQ6IGF1dG87CiAgbGVmdDogMTBweDsKfQpmcm9tcGFyZW50LWNvbnRhaW5lci5QbHV0b0Rldk1hY3JvczpiZWZvcmUgewogIGNvbnRlbnQ6ICJSZWxvYWQgUGx1dG9EZXZNYWNyb3MiCn0KCmZyb21wYXJlbnQtY29udGFpbmVyLmVycm9yZWQgewogIGJvcmRlci1jb2xvcjogdmFyKC0tZXJyb3ItY2VsbC1jb2xvcik7Cn0KZnJvbXBhcmVudC1jb250YWluZXI6aG92ZXIgewogIGZvbnQtd2VpZ2h0OiA4MDA7CiAgY3Vyc29yOiBwb2ludGVyOwp9CmJvZHkuZGlzYWJsZV91aSBmcm9tcGFyZW50LWNvbnRhaW5lciB7CiAgZGlzcGxheTogbm9uZTsKfQpmcm9tcGFyZW50LWNvbnRhaW5lcjpiZWZvcmUgewogIGNvbnRlbnQ6ICdSZWxvYWQgUGx1dG9FeHRyYXMnOwp9CiAgICBgCiAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCc5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDMnKQogIGNvbnN0IGFjdGlvbnMgPSBjZWxsLl9pbnRlcm5hbF9wbHV0b19hY3Rpb25zCiAgY29udGFpbmVyLm9uY2xpY2sgPSAoZSkgPT4gewogICAgaWYgKGUuY3RybEtleSkgewogICAgICBoaXN0b3J5LnB1c2hTdGF0ZSh7fSwgJycpCiAgICAgIGNlbGwuc2Nyb2xsSW50b1ZpZXcoewogICAgICAgIGJlaGF2aW9yOiAnYXV0bycsCiAgICAgICAgYmxvY2s6ICdjZW50ZXInLAogICAgICB9KQogICAgfSBlbHNlIHsKICAgICAgYWN0aW9ucy5zZXRfYW5kX3J1bl9tdWx0aXBsZShbJzk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwMyddKQogICAgfQogIH0KCiAgcmV0dXJuIGNvbnRhaW5lcgo8L3NjcmlwdD4KICAgIDxzY3JpcHQgaWQgPSAnUjNQeUdIZCcgY2xhc3M9J2hpZGUtdGhpcy1sb2cnPgogIGNvbnN0IGxvZ3NfcG9zaXRpb25lciA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgncGx1dG8tbG9nLWRvdC1wb3NpdGlvbmVyJykKICBpZiAobG9nc19wb3NpdGlvbmVyID09IHVuZGVmaW5lZCkgeyByZXR1cm4gfQogIGNvbnN0IGxvZ3MgPSBsb2dzX3Bvc2l0aW9uZXIucGFyZW50RWxlbWVudAogIGNvbnN0IGxvZ3NfY29udGFpbmVyID0gbG9ncy5wYXJlbnRFbGVtZW50CgogIGNvbnN0IHN0eWxlID0gaHRtbGA8c3R5bGU+CiAgICBwbHV0by1sb2dzLWNvbnRhaW5lcltoaWRkZW5dIHsKICAgICAgaGVpZ2h0OiAwcHg7CiAgICAgIHBhZGRpbmc6IDBweDsKICAgICAgdmlzaWJpbGl0eTogaGlkZGVuOwogICAgfQogICAgcGx1dG8tbG9nLWRvdC1wb3NpdGlvbmVyW2hpZGRlbl0gewogICAgICBoZWlnaHQ6IDBweDsKICAgICAgbWFyZ2luOiAwcHg7CiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsKICAgIH0KICAgIDwvc3R5bGU+YAogIAogIGZ1bmN0aW9uIGNhbGxCYWNrKG11dGF0aW9uTGlzdCwgb2JzZXJ2ZXIpIHsKICAgIGxldCBoaWRlX2NvbnRhaW5lciA9IHRydWUKICAgIGZvciAoY29uc3QgY2hpbGQgb2YgbG9ncy5jaGlsZHJlbikgewogICAgICAgIGNvbnN0IHNob3VsZF9oaWRlID0gY2hpbGQucXVlcnlTZWxlY3Rvcignc2NyaXB0LmhpZGUtdGhpcy1sb2cnKSAhPSB1bmRlZmluZWQKICAgICAgICBjaGlsZC50b2dnbGVBdHRyaWJ1dGUoJ2hpZGRlbicsIHNob3VsZF9oaWRlKQogICAgICAgIGhpZGVfY29udGFpbmVyID0gaGlkZV9jb250YWluZXIgJiYgc2hvdWxkX2hpZGUKICAgIH0KICAgIC8vIFdlIGV2ZW50dWFseSBoaWRlIHRoZSBjb250YWluZXIKICAgIGxvZ3NfY29udGFpbmVyLnRvZ2dsZUF0dHJpYnV0ZSgnaGlkZGVuJywgaGlkZV9jb250YWluZXIpCiAgfQoKICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGNhbGxCYWNrKQoKICBvYnNlcnZlci5vYnNlcnZlKGxvZ3MsIHsgc3VidHJlZTogdHJ1ZSwgYXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiB0cnVlIH0pCiAgbG9nc19wb3NpdGlvbmVyLnRvZ2dsZUF0dHJpYnV0ZSgnaGlkZGVuJywgdHJ1ZSkKICBpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CiAgICBjb25zb2xlLmxvZygnaW52YWxpZGF0aW9uIG9mIGxvZ3MgaGlkZXIgc2NyaXB0JykKICAgIGNhbGxCYWNrKCkKICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKQogIH0pCiAgcmV0dXJuIHN0eWxlCiAgICA8L3NjcmlwdD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAfO1ROwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lziFXAPG1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzeKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52UA8ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgxIGlkPSJAQm9uZHNMaXN0Ij5AQm9uZHNMaXN0PC9oMT4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2N6ar4sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYze5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4AA979tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYOoZWxlbWVudHOTkqFhkqExqnRleHQvcGxhaW6SoWKSoTGqdGV4dC9wbGFpbpKhY5KhMap0ZXh0L3BsYWlupHR5cGWqTmFtZWRUdXBsZahvYmplY3RpZLAyYTljMTU2Y2E1NWU2N2M1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACT3Oq7BwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWVCtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoEHTxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5JbiBzb21lIGNhc2VzLCBvbmUgZG9lcyBub3Qgd2FudCB0byBoYXZlIGEgc2luZ2xlIGJvbmQgd3JhcHBpbmcgZWl0aGVyIGEgU3RydWN0dXJlIG9yIGEgTmFtZWRUdXBsZSBiZWNhdXNlIHNpbmdsZSBpbmRlcGVuZGVudCBib25kcyBhcmUgbW9yZSBjb252ZW5pZW50LjwvcD4KPHA+PGNvZGU+QEJvbmRzTGlzdDwvY29kZT4gaXMgYSBjb252ZW5pZW5jZSBtYWNybyB0byBjcmVhdGUgYW4gb2JqZWN0IG9mIHR5cGUgPGNvZGU+Qm9uZHNMaXN0PC9jb2RlPiB3aGljaCBzaW1wbHkgYWxsb3cgdG8gYWRkIGEgZGVzY3JpcHRpb24gdG8gc2VwYXJhdGUgYm9uZHMgYW5kIGdyb3VwIHRoZW0gYWxsIHRvZ2V0aGVyIGluIGEgdGFibGUtbGlrZSBmb3JtYXQgZXF1aXZhbGVudCB0byB0aG9zZSBvZiA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPi48L3A+CjxkaXYgY2xhc3M9ImFkbW9uaXRpb24gbm90ZSI+PHAgY2xhc3M9ImFkbW9uaXRpb24tdGl0bGUiPk5vdGU8L3A+PHA+VW5saWtlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+LCBhIEJvbmRzTGlzdCBpcyBhbHJlYWR5IGNvbXBvc2VkIG9mIGJvbmQgY3JlYXRlZCB3aXRoIDxjb2RlPkBiaW5kPC9jb2RlPiBhbmQgaXQganVzdCBncm91cHMgdGhlbSB1cCB3aXRoIGEgZGVzY3JpcHRpb24uIFRoZSBvdXRwdXQgb2YgPGNvZGU+QEJvbmRzTGlzdDwvY29kZT4gaXMgbm90IHN1cHBvc2VkIHRvIGJlIGJvdW5kIHRvIGEgdmFyaWFibGUgdXNpbmcgPGNvZGU+QGJpbmQ8L2NvZGU+LjxiciAvPlRoZSBib25kcyBncm91cGVkIGluIGEgQm9uZHNMaXN0IHN0aWxsIGFjdCBhbmQgdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSBvbmUgYW5vdGhlci48L3A+CjwvZGl2Pgo8cD5TZWUgdGhlIGV4YW1wbGUgYmVsb3cgZm9yIHVuZGVyc3RhbmRpbmcgdGhlIHN5bnRoYXguIFRoZSBoZWFkZXIgb2YgYSBCb25kc0xpc3QgaXMgc2hvd24gaW4gYW4gb3JhbmdlIGJhY2tncm91bmQgdG8gZWFzaWx5IGRpZmZlcmVudGlhdGUgaXQgZnJvbSA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPi48L3A+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWNje4sNLBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOALsWLbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAYM8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhlIGFiaWxpdHkgdG8gYWxzbyB3cmFwIHByZS1leGlzdGluZyBib25kcyBhcm91bmQgU3RydWN0Qm9uZHMgaXMgY29udmVuaWVudCBmb3Igb3JnYW5pemluZyB0aGUgdmFyaW91cyBib25kcyBvbmUgaGF2ZSBpbiBhIDxjb2RlPkJvbmRzTGlzdDwvY29kZT4gb3IgPGNvZGU+Qm9uZFRhYmxlPC9jb2RlPjwvcD4KPHA+QXMgYW4gZXhhbXBsZSwgb25lIGNhbiBjcmVhdGUgYSA8Y29kZT5Cb25kc0xpc3Q8L2NvZGU+IGNvbnRhaW5pbmcgdGhlIHR3byA8Y29kZT5TdHJ1Y3RCb25kPC9jb2RlPiBib25kcyBnZW5lcmF0ZWQgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGlzIG5vdGVib29rIHdpdGggdGhlIGZvbGx3aW5nIGNvZGUuPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo1jY4os06wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAFzCW1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQxMzRkNjAzMy0yZjA4LTRmNDktOTgyOS02YTAyM2IzNjhhNzCKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52gJRPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPkEgc2ltaWxhciBhcHByb2FjaCBjYW4gYWxzbyBiZSBhY2hpZXZlZCBvbiBhIGZpZWxkIGJ5IGZpZWxkIGJhc2lzIGJ5IHVzaW5nIHRoZSA8Y29kZT5AdHY8L2NvZGU+IGRlY29yYXRvciAmIzQwO3doaWNoIGlzIG5vdCBhIG1hY3JvIHBlci1zZSBidXQgaXMgZGlyZWN0bHkgcHJvY2Vzc2VkIGR1cmluZyB0aGUgbWFjcm8gZXhwYW5zaW9uIG9mIDxjb2RlPkBOVEJvbmQ8L2NvZGU+JiM0MTsuPC9wPgo8cD48Y29kZT5AdHY8L2NvZGU+IGlzIGEgc2hvcnRoYW5kIGZvciB0cmFuc2Zvcm1lZF92YWx1ZSBhbmQgaXQgZXhwZWN0cyB0d28gYXJndW1lbnRzIGFmdGVyIGl0LCB0aGUgZmlyc3QgYmVpbmcgdGhlIGZ1bmN0aW9uIHRvIHByb2Nlc3MgdGhlIHZhbHVlIHJldHVybmVkIGJ5IHRoZSB3aWRnZXQsIGFuZCB0aGUgc2Vjb25kIGJlaW5nIHRoZSB3aWRnZXQgaXRzZWxmLjwvcD4KPHA+VGhpcyBjYW4gYmUgdXNlZCB0byBiZSBhIGJpdCBsZXNzIHZlcmJvc2Ugd2hlbiBvbmUgaXMgaW50ZXJlc3RlZCBpbiBvbmx5IHRyYW5zZm9ybWluZyBvbmUgb2YgbWFueSBmaWVsZHMgYXMgYmVsb3c6PC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo1pUkezsSwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAE3Lm1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ3MDVlMzBmZS03N2EzLTRiMDYtOGI5OS0xODA3MjkwZWRmZmKKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5ozE1MKRtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAk97g+wcGVyc2lzdF9qc19zdGF0ZcO3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lOLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaSq08Ym9uZCBkZWY9Im50IiB1bmlxdWVfaWQ9InhuY2NqaWFpdXZxeCI+PHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDAxJnF1b3Q7KSwgOmEsIDpiLCA6Yyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TXkgRmFuY3kgTlR1cGxlPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdhdXN1emdpbGZ5JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndGtjYXhpeWtpcCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd0a2NheGl5a2lwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidGtjYXhpeWtpcCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbmV4d2ZubnBocScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd1bWJ3c3FjZG5vJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3VtYndzcWNkbm8nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ1bWJ3c3FjZG5vIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd4enlkc2J0aGxuJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3h6eWRzYnRobG4nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ4enlkc2J0aGxuIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nbmV4d2ZubnBocSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm5leHdmbm5waHEiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE5hbWVkVHVwbGUiKQo8L3NjcmlwdD4KCTxzY3JpcHQgaWQ9J2F1c3V6Z2lsZnknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJhdXN1emdpbGZ5Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdmdGRkZ3BydXlzJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCiAgICAgICAgY29uc3QgY29sbGFwc2VfYnRuID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuY29sbGFwc2UtYnRuJykKCiAgICAgICAgcGFyZW50LmNvbGxhcHNlID0gKCkgPT4gewogICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKICAgICAgICB9CgogICAgICAgIGNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHBhcmVudC5jb2xsYXBzZSgpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgZmllbGQtaHRtbCB7CiAgICBkaXNwbGF5OiBjb250ZW50czsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICAvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwogICAgZmxleDogMTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAgZGlzcGxheTogZmxleDsKfQoKLmNvbGxhcHNlLWJ0biB7CiAgICBkaXNwbGF5OiBub25lOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQ+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgd2lkdGg6IDEwMCU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmRlc2NyaXB0aW9uIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBhbGlnbi1zZWxmOiBjZW50ZXIKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIrKiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nZ2RuZmlxd2hteSc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZadudF9ib25ksmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACF/qIbBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOEq2wf7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDViYjIyZjA3LWZiZWEtNDRhYi05NzgzLTljYTE2ZTBkYTExZYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZYjxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDMgaWQ9IlRyYW5zZm9ybS1vbmx5LWEtZmV3LWZpZWxkcyI+VHJhbnNmb3JtIG9ubHkgYSBmZXcgZmllbGRzPC9oMz4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNaUqrgCXsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ1YmIyMmYwNy1mYmVhLTQ0YWItOTc4My05Y2ExNmUwZGExMWW5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4AA24ftXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRkiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keaCkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2L0WT5sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRjYmZjNmVlYy04OTkxLTRhOWMtYWRhMC0yOTVjODA1Mjg1NGS5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc0i3bVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaI+o8Ym9uZHNsaXN0LWNvbnRhaW5lciBjbGFzcz0nbm8tcG9wb3V0Jz4KCTxib25kc2xpc3QtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdjb2xsYXBzZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbicgdGl0bGU9IlRoaXMgbGlzdCBjb250YWlucyBpbmRlcGVuZGVudCBib25kcyI+TXkgR3JvdXAgb2YgQm9uZHM8L3NwYW4+CgkJPHNwYW4gY2xhc3M9J3RvZ2dsZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJPC9ib25kc2xpc3QtaGVhZGVyPgoJPGJvbmRzbGlzdC1jb250ZW50cz4KCTxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBmcmVxYCc+CgkJRnJlcXVlbmN5IFtHSHpdCgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8Ym9uZCBkZWY9ImZyZXEiIHVuaXF1ZV9pZD0idWVsemhhZm1vZHF6Ij4KPHNjcmlwdD4KCWNvbnN0IGQzZm9ybWF0ID0gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKCWNvbnN0IGVscCA9IGh0bWxgCgk8c3BhbiBjbGFzcz0ibnVtYmVyX0VkaXRhYmxlIiBzdHlsZT0iCgl0b3VjaC1hY3Rpb246IG5vbmU7CglwYWRkaW5nOiAwZW0gLjJlbTsKCWJvcmRlci1yYWRpdXM6IC4zZW07Cglmb250LXdlaWdodDogYm9sZDsiPjxzcGFuIGNvbnRlbnRFZGl0YWJsZT10cnVlPjIwPC9zcGFuPiBHSHo8L3NwYW4+CglgCgoJY29uc3QgZm9ybWF0dGVyID0gcyA9PiBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpCgljb25zdCBlbCA9IGVscC5xdWVyeVNlbGVjdG9yKCJzcGFuIikKCglsZXQgbG9jYWxWYWwgPSBwYXJzZUZsb2F0KDIwKQoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDIwKQoJCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxwLCJ2YWx1ZSIsewoJCWdldDogKCkgPT4gbG9jYWxWYWwsCgkJc2V0OiB4ID0+IHsKCQkJbG9jYWxWYWwgPSBwYXJzZUZsb2F0KHgpCgkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcih4KQoJCX0KCX0pCgoJY29uc3QgZGlzcGF0Y2hFdmVudCA9IChlKSA9PiB7CgkJaWYgKGVsLmlubmVyVGV4dCA9PT0gIiIpIHsKCQkJZWxwLnZhbHVlID0gMjAgICAKCQl9IGVsc2UgewoJCQkvKiAKCQkJVGhlIHJlcGxhY2UgaXMgbmVlZGVkIGJlY2F1c2UgZDMtZm9ybWF0IG91dHB1dHMgJy0nIGFzIGluIFUrMjIxMiAobWF0aCBzeW1ib2wpIGJ1dCBmYWlscyB0byBwYXJzZSBuZWdhdGl2ZSBudW1iZXIgY29ycmVjdGx5IGlmIHRoZXkgaGF2ZSB0aGF0IHNpZ24gYXMgbmVnYXRpdmUgc2lnbi4gU28gd2UganVzdCByZXBsYWNlIGl0IHdpdGggdGhlIGRhc2ggVSswMDJEIHNpZ24gCgkJCSovCgkJCWVscC52YWx1ZSA9ICBlbC5pbm5lclRleHQucmVwbGFjZSgn4oiSJywgJy0nKQoJCX0KCQllbHAuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgl9CgoJLy8gRnVuY3Rpb24gdG8gYmx1ciB0aGUgZWxlbWVudCB3aGVuIHByZXNzaW5nIGVudGVyIGluc3RlYWQgb2YgYWRkaW5nIGEgbmV3bGluZQoJY29uc3Qgb25FbnRlciA9IChlKSA9PiB7CgkJaWYgKGUua2V5Q29kZSA9PT0gMTMpIHsKCQllLnByZXZlbnREZWZhdWx0KCk7CgkJZWwuYmx1cigpCgkJfQoJfQoKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywoZSkgPT4gewoJCWNvbnNvbGUubG9nKGUpCgkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKQoJfSkKCglmdW5jdGlvbiBzZWxlY3RUZXh0KGVsKXsKCQl2YXIgc2VsLCByYW5nZTsKCQlpZiAod2luZG93LmdldFNlbGVjdGlvbiAmJiBkb2N1bWVudC5jcmVhdGVSYW5nZSkgeyAvL0Jyb3dzZXIgY29tcGF0aWJpbGl0eQoJCXNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKCQlpZihzZWwudG9TdHJpbmcoKSA9PSAnJyl7IC8vbm8gdGV4dCBzZWxlY3Rpb24KCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCQkJCXJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsgLy9yYW5nZSBvYmplY3QKCQkJCXJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyhlbCk7IC8vc2V0cyBSYW5nZQoJCQkJc2VsLnJlbW92ZUFsbFJhbmdlcygpOyAvL3JlbW92ZSBhbGwgcmFuZ2VzIGZyb20gc2VsZWN0aW9uCgkJCQlzZWwuYWRkUmFuZ2UocmFuZ2UpOy8vYWRkIFJhbmdlIHRvIGEgU2VsZWN0aW9uLgoJCQl9LDEpOwoJCX0KCQl9ZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7IC8vb2xkZXIgaWUKCQkJc2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7CgkJCWlmKHNlbC50ZXh0ID09ICcnKXsgLy9ubyB0ZXh0IHNlbGVjdGlvbgoJCQkJcmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpOy8vQ3JlYXRlcyBUZXh0UmFuZ2Ugb2JqZWN0CgkJCQlyYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChlbCk7Ly9zZXRzIFJhbmdlCgkJCQlyYW5nZS5zZWxlY3QoKTsgLy9tYWtlIHNlbGVjdGlvbi4KCQkJfQoJCX0KCX0KCgkKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JyxkaXNwYXRjaEV2ZW50KQoJZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsb25FbnRlcikKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSkgPT4gZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSkgLy8gbW9kaWZ5IHRleHQKCWVscC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IHNlbGVjdFRleHQoZWwpKSAvLyBTZWxlY3QgYWxsIHRleHQKCglyZXR1cm4gZWxwCgo8L3NjcmlwdD4KPHN0eWxlPgoJQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogbGlnaHQpIHsKCQlzcGFuLm51bWJlcl9FZGl0YWJsZSB7CgkJCWJhY2tncm91bmQ6IGhzbCgyMDQsIDk1JSwgODQlKTsKCQl9Cgl9CglAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CgkJc3Bhbi5udW1iZXJfRWRpdGFibGUgewoJCQliYWNrZ3JvdW5kOiBoc2woMjA0LCA5NSUsIDQwJSk7CgkJfQoJfQo8L3N0eWxlPgo8L2JvbmQ+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYGFsdGAnPgoJCTxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5BbHRpdHVkZSA8c3BhbiBjbGFzcz0idGV4Ij4kaCQ8L3NwYW4+ICYjOTE7bSYjOTM7PC9wPgo8L2Rpdj4KCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxib25kIGRlZj0iYWx0IiB1bmlxdWVfaWQ9Inh5bHBjdmVoempybSI+PHNjcmlwdD4KCQkJLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4KCQkJd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCgkJCWNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQoJCQljb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgoJCQljb25zdCB2YWx1ZXMgPSBbMTAwLCAxMTAsIDEyMCwgMTMwLCAxNDAsIDE1MCwgMTYwLCAxNzAsIDE4MCwgMTkwLCAyMDBdCgoJCQljb25zdCBlbCA9IGh0bWxgCgkJCTxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKCQkJdG91Y2gtYWN0aW9uOiBub25lOwoJCQliYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CgkJCWNvbG9yOiBibGFjazsKCQkJcGFkZGluZzogMGVtIC4yZW07CgkJCWJvcmRlci1yYWRpdXM6IC4zZW07CgkJCWZvbnQtd2VpZ2h0OiBib2xkOwoJCQlmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgCQlmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwoJCQkiPjE1MDwvc3Bhbj4KCQkJYAoKCgoJCQlsZXQgb2xkX3ggPSAwCgkJCWxldCBvbGRfaW5kZXggPSAwCgkJCWNvbnN0IGluaXRpYWxfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgMTUwKQoJCQlsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCgkJCWNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgoJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCQkJCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJCQkJc2V0OiB4ID0+IHsKCQkJCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJfSwKCQkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQkJfSk7CgoJCQkvLyBpbml0aWFsIHZhbHVlCgkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcigxNTApCgoJCQljb25zdCBvblNjcnViID0gKGUpID0+IHsKCQkJCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94CgkJCQljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCQkJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJCQkJKSkKCgkJCQlpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQkJCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJCQkJfQoJCQl9CgoJCQljb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCQkJCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCgkJCQlvbGRfeCA9IGUuY2xpZW50WAoJCQkJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgoJCQljb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCQkJCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgoJCQljb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCgkJCX0KCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKCQkJZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgoJCQlpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgkJCX0pCgoJCQlyZXR1cm4gZWwKCgkJCTwvc2NyaXB0PjwvYm9uZD4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgoJCgk8L2JvbmRzbGlzdC1jb250ZW50cz4KCTxzY3JpcHQgaWQ9J2lxbG1vd2ltZ3EnPgoJCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnRhaW5lci5jb2xsYXBzZSA9IChmb3JjZSkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJywgZm9yY2UpCgkJfQoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuLmNvbGxhcHNlJykKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBjb250YWluZXIuY29sbGFwc2UoKQoJPC9zY3JpcHQ+Cgk8c3R5bGU+Cglib25kc2xpc3QtaGVhZGVyIHsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGRpc3BsYXk6IGZsZXg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwp9CmJvbmRzbGlzdC1oZWFkZXI6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMXB4OwogIGJvdHRvbTogMHB4OwogIGxlZnQ6IDBweDsKICByaWdodDogMHB4OwogIHotaW5kZXg6IC0xOwogIGJhY2tncm91bmQ6ICNmZmFjNDU0MDsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dCA+IGJvbmRzbGlzdC1oZWFkZXIgewogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgcGFkZGluZy10b3A6IDEycHg7CiAgbWFyZ2luLXRvcDogLTEycHg7CiAgei1pbmRleDogMTA7Cn0KYm9uZHNsaXN0LWNvbnRlbnRzIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dDpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGJsb2NrOwogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAganVzdGlmeS1zZWxmOiBjZW50ZXI7CiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkOwogIHBhZGRpbmctdG9wOiA1cHg7CiAgd2lkdGg6IDEwMCU7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgei1pbmRleDogMjA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5ib25kc2xpc3QtaWNvbiB7CiAgLS1zaXplOiAxN3B4OwogIGRpc3BsYXk6IGJsb2NrOwogIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgPiBib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAzMHB4OwogIG1hcmdpbjogMCAxMHB4Owp9CmJvbmRzbGlzdC1oZWFkZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgd2lkdGg6IDEwMCU7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIGZsZXgtZ3JvdzogMTsKICBmb250LXNpemU6IDE4cHg7CiAgZm9udC13ZWlnaHQ6IDYwMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgYWxpZ24tc2VsZjogY2VudGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkIGJvbmRzbGlzdC1oZWFkZXIgKyAqIHsKICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHJvdy1nYXA6IDVweDsKfQpib25kdGFibGUtY29udGFpbmVyIGJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CgkJCgk8L3N0eWxlPgo8L2JvbmRzbGlzdC1jb250YWluZXI+CqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWWiYmyybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAI6iSNsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmO5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4HeYa7tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keaMxNTCkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAJPlJUsHBlcnNpc3RfanNfc3RhdGXDt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZTu1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ0NjY5OTVhMi1kZmQ0LTQzNzQtODMzOS1iYzAyMzIwMzliMjeKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52U48ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgyIGlkPSJ0cmFuc2Zvcm1lZF92YWx1ZSI+dHJhbnNmb3JtZWRfdmFsdWU8L2gyPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo1jY1a+zuwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDQ2Njk5NWEyLWRmZDQtNDM3NC04MzM5LWJjMDIzMjAzOWIyN7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAESwa1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQyNzk3NzUyNi03NWRjLTQ0YzMtOTk3Ni1jMjJlOGNiZDk0ZGGKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5sjMuNzg1Mzk4MTYzMzk3NDQ4M6RtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAiQv+ywcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDI3OTc3NTI2LTc1ZGMtNDRjMy05OTc2LWMyMmU4Y2JkOTRkYblkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lPbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NoqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaAYw8ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+V2hlbiBwcm92aWRpbmcgYSBkZXNjcmlwdGlvbiB0aGF0IGlzIG5vdCBhIHN0cmluZywgYnkgZGVmYXVsdCB0aGUgZGVzY3JpcHRpb24gZmllbGQgaW5zaWRlIG9mIHRoZSByZXN1bHRpbmcgPGNvZGU+U3RydWN0Qm9uZDwvY29kZT4gaXMgc2V0IHRvIDxjb2RlPiZxdW90O05vIFN0cmluZyBEZXNjcmlwdGlvbiBQcm92aWRlZCZxdW90OzwvY29kZT4uPC9wPgo8cD5JZiBmb3Igc29tZSByZWFzb24gb25lIHdhbnRzIHRvIGN1c3RvbWl6ZSB0aGUgc3RyaW5nIGRlc2NyaXB0aW9uLCBhIHR1cGxlIHdpdGggPGNvZGU+JiM0MDtzdHJpbmdfZGVzY3JpcHRpb24sIGh0bWxfZGVzY3JpcHRpb24mIzQxOzwvY29kZT4gY2FuIGJlIHByb3ZpZGVkPC9wPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo1lCaMBM2wcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgAEkZu1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQwMmU1ODAxMi01YWY2LTRiOTEtYTlhNC0wOWM5ZGMwMzhmMTGKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52lu7PGJvbmQgZGVmPSJ0cmFuc2Zvcm1fc2luZ2xlX2ZpZWxkIiB1bmlxdWVfaWQ9InBvcWRsY2VuY2hiZCI+PHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA2JnF1b3Q7KSwgOmEsIDpiLCA6YywgOmQpfSc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGNsYXNzPSdjb2xsYXBzaWJsZSc+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgogICAgICAgIDxzcGFuIGNsYXNzPSdjb2xsYXBzZS1idG4nPjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPkZpZWxkIExldmVsIFRyYW5zZm9ybWVkIFZhbHVlPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSd0Z29ncW96aXdkJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdpbWxkdXphcmJpJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+QW5nbGUgW8KwXTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdqc3Z1bWdhcWlzJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc5MScgdmFsdWU9JzYxJz48c2NyaXB0PgoJCQkJCWNvbnN0IGlucHV0X2VsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJCQkJY29uc3Qgb3V0cHV0X2VsID0gY3VycmVudFNjcmlwdC5uZXh0RWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBkaXNwbGF5cyA9IFsiMCIsICIxIiwgIjIiLCAiMyIsICI0IiwgIjUiLCAiNiIsICI3IiwgIjgiLCAiOSIsICIxMCIsICIxMSIsICIxMiIsICIxMyIsICIxNCIsICIxNSIsICIxNiIsICIxNyIsICIxOCIsICIxOSIsICIyMCIsICIyMSIsICIyMiIsICIyMyIsICIyNCIsICIyNSIsICIyNiIsICIyNyIsICIyOCIsICIyOSIsICIzMCIsICIzMSIsICIzMiIsICIzMyIsICIzNCIsICIzNSIsICIzNiIsICIzNyIsICIzOCIsICIzOSIsICI0MCIsICI0MSIsICI0MiIsICI0MyIsICI0NCIsICI0NSIsICI0NiIsICI0NyIsICI0OCIsICI0OSIsICI1MCIsICI1MSIsICI1MiIsICI1MyIsICI1NCIsICI1NSIsICI1NiIsICI1NyIsICI1OCIsICI1OSIsICI2MCIsICI2MSIsICI2MiIsICI2MyIsICI2NCIsICI2NSIsICI2NiIsICI2NyIsICI2OCIsICI2OSIsICI3MCIsICI3MSIsICI3MiIsICI3MyIsICI3NCIsICI3NSIsICI3NiIsICI3NyIsICI3OCIsICI3OSIsICI4MCIsICI4MSIsICI4MiIsICI4MyIsICI4NCIsICI4NSIsICI4NiIsICI4NyIsICI4OCIsICI4OSIsICI5MCJdCgoJCQkJCWxldCB1cGRhdGVfb3V0cHV0ID0gKCkgPT4gewoJCQkJCQlvdXRwdXRfZWwudmFsdWUgPSBkaXNwbGF5c1tpbnB1dF9lbC52YWx1ZUFzTnVtYmVyIC0gMV0KCQkJCQl9CgkJCQkJCgkJCQkJaW5wdXRfZWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCS8vIFdlIGFsc28gcG9sbCBmb3IgY2hhbmdlcyBiZWNhdXNlIHRoZSBgaW5wdXRfZWwudmFsdWVgIGNhbiBjaGFuZ2UgZnJvbSB0aGUgb3V0c2lkZSwgZS5nLiBodHRwczovL2dpdGh1Yi5jb20vSnVsaWFQbHV0by9QbHV0b1VJLmpsL2lzc3Vlcy8yNzcKCQkJCQlsZXQgaWQgPSBzZXRJbnRlcnZhbCh1cGRhdGVfb3V0cHV0LCAyMDApCgkJCQkJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCQkJCQljbGVhckludGVydmFsKGlkKQoJCQkJCQlpbnB1dF9lbC5yZW1vdmVFdmVudExpc3RlbmVyKCJpbnB1dCIsIHVwZGF0ZV9vdXRwdXQpCgkJCQkJfSkKCQkJCQk8L3NjcmlwdD48b3V0cHV0IHN0eWxlPScKCQkJCQkJZm9udC1mYW1pbHk6IHN5c3RlbS11aTsKICAgIAkJCQkJZm9udC1zaXplOiAxNXB4OwogICAgCQkJCQltYXJnaW4tbGVmdDogM3B4OwogICAgCQkJCQl0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTRweCk7CiAgICAJCQkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsnPjYwPC9vdXRwdXQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nanN2dW1nYXFpcyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImpzdnVtZ2FxaXMiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2ltbGR1emFyYmknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2InPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2InIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGJgIj5iPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3Bxd3NrcGdrbmwnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0ncHF3c2twZ2tubCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInBxd3NrcGdrbmwiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2ltbGR1emFyYmknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5jPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2FzaGtuZWp5c3onIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nYXNoa25lanlzeic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImFzaGtuZWp5c3oiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2ltbGR1emFyYmknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj5kPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2QnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3BmandqY29mZngnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0ncGZqd2pjb2ZmeCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInBmandqY29mZngiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdpbWxkdXphcmJpJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaW1sZHV6YXJiaSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgTmFtZWRUdXBsZSIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0ndGdvZ3Fveml3ZCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInRnb2dxb3ppd2QiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J2VscWJuZXZ2bnknPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSd3cWtlamliYm9iJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAiBzgywcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDAyZTU4MDEyLTVhZjYtNGI5MS1hOWE0LTA5YzlkYzAzOGYxMblkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzg9wNp21cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ1NjQ5NjhmZS0wYTY4LTQ4YmMtOWUxMS1jNzczMmUyYmFlMDSKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5syJQbGFpbiBkZXNjcmlwdGlvbiKkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAIrZ6IsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ1NjQ5NjhmZS0wYTY4LTQ4YmMtOWUxMS1jNzczMmUyYmFlMDS5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc0BFrVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDM2ZmFmMThjLTExYzMtNDAxMi1hOTk2LTU1YzdjZGFlNzFhOIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnaRjc8Ym9uZCBkZWY9ImF0YW52YWwiIHVuaXF1ZV9pZD0icHhybmFhZWp2cHVuIj48c3RydWN0LWJvbmQgY2xhc3M9J05hbWVkVHVwbGV7KFN5bWJvbCgmcXVvdDsjIzI0MDImcXVvdDspLCA6eCwgOnkpfSc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGNsYXNzPSdjb2xsYXBzaWJsZSc+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgogICAgICAgIDxzcGFuIGNsYXNzPSdjb2xsYXBzZS1idG4nPjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5UaGlzIGlzIG1hdGgmIzMzOzogPHNwYW4gY2xhc3M9InRleCI+JFw7YXRhbiYjNDA7eCx5JiM0MTsgJiM0MzsgMyQ8L3NwYW4+PC9wPgo8L2Rpdj48L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3Z5c3FwbWtza3onIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2FqbWN2bGdhdG4nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J3gnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J3gnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYHhgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+PHNwYW4gY2xhc3M9InRleCI+JHgkPC9zcGFuPjwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J3gnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3RrZXlwbnZ2ZGcnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PHNjcmlwdD4KCQkJCQljb25zdCBpbnB1dF9lbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCQkJCWNvbnN0IG91dHB1dF9lbCA9IGN1cnJlbnRTY3JpcHQubmV4dEVsZW1lbnRTaWJsaW5nCgkJCQkJY29uc3QgZGlzcGxheXMgPSBbIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiwgIjciLCAiOCIsICI5IiwgIjEwIl0KCgkJCQkJbGV0IHVwZGF0ZV9vdXRwdXQgPSAoKSA9PiB7CgkJCQkJCW91dHB1dF9lbC52YWx1ZSA9IGRpc3BsYXlzW2lucHV0X2VsLnZhbHVlQXNOdW1iZXIgLSAxXQoJCQkJCX0KCQkJCQkKCQkJCQlpbnB1dF9lbC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIHVwZGF0ZV9vdXRwdXQpCgkJCQkJLy8gV2UgYWxzbyBwb2xsIGZvciBjaGFuZ2VzIGJlY2F1c2UgdGhlIGBpbnB1dF9lbC52YWx1ZWAgY2FuIGNoYW5nZSBmcm9tIHRoZSBvdXRzaWRlLCBlLmcuIGh0dHBzOi8vZ2l0aHViLmNvbS9KdWxpYVBsdXRvL1BsdXRvVUkuamwvaXNzdWVzLzI3NwoJCQkJCWxldCBpZCA9IHNldEludGVydmFsKHVwZGF0ZV9vdXRwdXQsIDIwMCkKCQkJCQlpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgkJCQkJCWNsZWFySW50ZXJ2YWwoaWQpCgkJCQkJCWlucHV0X2VsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImlucHV0IiwgdXBkYXRlX291dHB1dCkKCQkJCQl9KQoJCQkJCTwvc2NyaXB0PjxvdXRwdXQgc3R5bGU9JwoJCQkJCQlmb250LWZhbWlseTogc3lzdGVtLXVpOwogICAgCQkJCQlmb250LXNpemU6IDE1cHg7CiAgICAJCQkJCW1hcmdpbi1sZWZ0OiAzcHg7CiAgICAJCQkJCXRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNHB4KTsKICAgIAkJCQkJZGlzcGxheTogaW5saW5lLWJsb2NrOyc+MTwvb3V0cHV0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3RrZXlwbnZ2ZGcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ0a2V5cG52dmRnIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdham1jdmxnYXRuJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSd5Jz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSd5JyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGB5YCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPjxzcGFuIGNsYXNzPSJ0ZXgiPiR5JDwvc3Bhbj48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSd5Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSducGJka3JrdGRtJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjxzY3JpcHQ+CgkJCQkJY29uc3QgaW5wdXRfZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBvdXRwdXRfZWwgPSBjdXJyZW50U2NyaXB0Lm5leHRFbGVtZW50U2libGluZwoJCQkJCWNvbnN0IGRpc3BsYXlzID0gWyIxIiwgIjIiLCAiMyIsICI0IiwgIjUiLCAiNiIsICI3IiwgIjgiLCAiOSIsICIxMCJdCgoJCQkJCWxldCB1cGRhdGVfb3V0cHV0ID0gKCkgPT4gewoJCQkJCQlvdXRwdXRfZWwudmFsdWUgPSBkaXNwbGF5c1tpbnB1dF9lbC52YWx1ZUFzTnVtYmVyIC0gMV0KCQkJCQl9CgkJCQkJCgkJCQkJaW5wdXRfZWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCS8vIFdlIGFsc28gcG9sbCBmb3IgY2hhbmdlcyBiZWNhdXNlIHRoZSBgaW5wdXRfZWwudmFsdWVgIGNhbiBjaGFuZ2UgZnJvbSB0aGUgb3V0c2lkZSwgZS5nLiBodHRwczovL2dpdGh1Yi5jb20vSnVsaWFQbHV0by9QbHV0b1VJLmpsL2lzc3Vlcy8yNzcKCQkJCQlsZXQgaWQgPSBzZXRJbnRlcnZhbCh1cGRhdGVfb3V0cHV0LCAyMDApCgkJCQkJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCQkJCQljbGVhckludGVydmFsKGlkKQoJCQkJCQlpbnB1dF9lbC5yZW1vdmVFdmVudExpc3RlbmVyKCJpbnB1dCIsIHVwZGF0ZV9vdXRwdXQpCgkJCQkJfSkKCQkJCQk8L3NjcmlwdD48b3V0cHV0IHN0eWxlPScKCQkJCQkJZm9udC1mYW1pbHk6IHN5c3RlbS11aTsKICAgIAkJCQkJZm9udC1zaXplOiAxNXB4OwogICAgCQkJCQltYXJnaW4tbGVmdDogM3B4OwogICAgCQkJCQl0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTRweCk7CiAgICAJCQkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsnPjE8L291dHB1dD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSducGJka3JrdGRtJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibnBiZGtya3RkbSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2FqbWN2bGdhdG4nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJham1jdmxnYXRuIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQo8c2NyaXB0PgoJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCglkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBOYW1lZFR1cGxlIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSd2eXNxcG1rc2t6Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidnlzcXBta3NreiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nY3R1a2JndWR4bCc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2lyY3RxY2F0aHEnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWWrbWF0aF9udGJvbmSybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAIkHXRsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQzNmZhZjE4Yy0xMWMzLTQwMTItYTk5Ni01NWM3Y2RhZTcxYTi5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4MibwZtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNzg1M2NjN2YtNGU1OC00NGQxLThkM2ItZjhkNDc0NTU2NGU2iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kebIxLjAzMDM3NjgyNjUyNDMxMjWkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAI2v0vsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ3ODUzY2M3Zi00ZTU4LTQ0ZDEtOGQzYi1mOGQ0NzQ1NTY0ZTa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZS21cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijQVNEqGVsZW1lbnRzlZKhYZKhMap0ZXh0L3BsYWlukqFikqE2qnRleHQvcGxhaW6SoWOSoiIiqnRleHQvcGxhaW6SoWSSoiIiqnRleHQvcGxhaW6SoWWSojIwqnRleHQvcGxhaW6kdHlwZaZzdHJ1Y3SscHJlZml4X3Nob3J0o0FTRKhvYmplY3RpZLAzMDBjOGZmOTNmNGEyNDE1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACT28vrBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWU/tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNzg1NTgyNmUtY2NhYS00YzI3LWEwNjAtZjVjZWI5MjdiYmU4iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedo+xDxib25kIGRlZj0idHJhbnNmb3JtZWRfdmFsdWVfZXhhbXBsZSIgdW5pcXVlX2lkPSJqZXp1YXZod2R0b3YiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTmFtZWRUdXBsZXsoU3ltYm9sKCZxdW90OyMjMjM5OSZxdW90OyksIDphLCA6Yil9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPlRyYW5zZm9ybWVkJiMzMzs8L3A+CjwvZGl2Pjwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZmhreG9odXNoYicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naWRwaXdra2lzdicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPmE8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZmNuY3hjY3J0Yicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdmY25jeGNjcnRiJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZmNuY3hjY3J0YiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naWRwaXdra2lzdicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPmI8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0neWVjZ290cm51eScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd5ZWNnb3RybnV5Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAieWVjZ290cm51eSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2lkcGl3a2tpc3YnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJpZHBpd2traXN2Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQo8c2NyaXB0PgoJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCglkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBOYW1lZFR1cGxlIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdmaGt4b2h1c2hiJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZmhreG9odXNoYiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nYWpvb3V6bm94Yic+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2p5b3dxb294eWwnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACG/68LBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNzg1NTgyNmUtY2NhYS00YzI3LWEwNjAtZjVjZWI5MjdiYmU4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOEJIsarVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGY2NWIzMjMxLWYyYjItNDVkYy1iNzJlLTFhZDMxMDcwODNmY4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZTDxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDEgaWQ9IlN0cnVjdEJvbmRTZWxlY3QiPlN0cnVjdEJvbmRTZWxlY3Q8L2gxPgo8L2Rpdj6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo1jY11njSwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJGY2NWIzMjMxLWYyYjItNDVkYy1iNzJlLTFhZDMxMDcwODNmY7lkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgADy6W1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTaKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52wACuyoJPGJvbmR0YWJsZS1jb250YWluZXIga2V5PSdmZWViZGNhZGZiJyBjbGFzcz0nY29sbGFwc2VkJz4KCQk8Ym9uZHRhYmxlLWhlYWRlcj4KCQkJPHNwYW4gY2xhc3M9J3RhYmxlLWhlbHAgaWNvbic+PC9zcGFuPgoJCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPk15IEJvbmRzPC9zcGFuPgoJCQk8c3BhbiBjbGFzcz0ndGFibGUtY29sbGFwc2UgaWNvbic+PC9zcGFuPgoJCTwvYm9uZHRhYmxlLWhlYWRlcj4KCQk8Ym9uZHRhYmxlLWNvbnRlbnRzPgoJCQk8Ym9uZCBkZWY9ImFzZCIgdW5pcXVlX2lkPSJsc3lqYmZwb3BoY3oiPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtY255b3hkeXR1JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPk1hcmtkb3duIGRlc2NyaXB0aW9uLCBpbmNsdWRpbmcgPHNwYW4gY2xhc3M9InRleCI+JExhVGVYJDwvc3Bhbj48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdza2JoZHh3aWh3JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NrYmhkeHdpaHcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJza2JoZHh3aWh3Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naW1ueWxsYmdjZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNjcmlwdD4KCQkJLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4KCQkJd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCgkJCWNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQoJCQljb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgoJCQljb25zdCB2YWx1ZXMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTBdCgoJCQljb25zdCBlbCA9IGh0bWxgCgkJCTxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKCQkJdG91Y2gtYWN0aW9uOiBub25lOwoJCQliYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CgkJCWNvbG9yOiBibGFjazsKCQkJcGFkZGluZzogMGVtIC4yZW07CgkJCWJvcmRlci1yYWRpdXM6IC4zZW07CgkJCWZvbnQtd2VpZ2h0OiBib2xkOwoJCQlmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgCQlmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwoJCQkiPjY8L3NwYW4+CgkJCWAKCgoKCQkJbGV0IG9sZF94ID0gMAoJCQlsZXQgb2xkX2luZGV4ID0gMAoJCQljb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCgkJCWxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKCQkJY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJCQkJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCgkJCQlzZXQ6IHggPT4gewoJCQkJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQl9LAoJCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCQl9KTsKCgkJCS8vIGluaXRpYWwgdmFsdWUKCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgoJCQljb25zdCBvblNjcnViID0gKGUpID0+IHsKCQkJCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94CgkJCQljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCQkJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJCQkJKSkKCgkJCQlpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQkJCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJCQkJfQoJCQl9CgoJCQljb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCQkJCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCgkJCQlvbGRfeCA9IGUuY2xpZW50WAoJCQkJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgoJCQljb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCQkJCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgoJCQljb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCgkJCX0KCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKCQkJZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgoJCQlpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgkJCX0pCgoJCQlyZXR1cm4gZWwKCgkJCTwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ltbnlsbGJnY2YnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJpbW55bGxiZ2NmIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdjZXNkYmZjcmFvJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nY2VzZGJmY3Jhbyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImNlc2RiZmNyYW8iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2t4a215aWNnam4nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZnNic3ptbW9sYicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ZzYnN6bW1vbGInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJmc2Jzem1tb2xiIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlZ2F1eW93a2JrJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZWdhdXlvd2tiayc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVnYXV5b3drYmsiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdreGtteWljZ2puJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAia3hrbXlpY2dqbiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgQVNEIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdtY255b3hkeXR1Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibWNueW94ZHl0dSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nanhmZmN6eGltdic+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JnYWV2eXdleHcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjxib25kIGRlZj0ibnQiIHVuaXF1ZV9pZD0ieG5jY2ppYWl1dnF4Ij48c3RydWN0LWJvbmQgY2xhc3M9J05hbWVkVHVwbGV7KFN5bWJvbCgmcXVvdDsjIzI0MDEmcXVvdDspLCA6YSwgOmIsIDpjKX0nPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBjbGFzcz0nY29sbGFwc2libGUnPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KICAgICAgICA8c3BhbiBjbGFzcz0nY29sbGFwc2UtYnRuJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5NeSBGYW5jeSBOVHVwbGU8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2F1c3V6Z2lsZnknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J25leHdmbm5waHEnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2EnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2EnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGFgIj5EZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd0a2NheGl5a2lwJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3RrY2F4aXlraXAnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ0a2NheGl5a2lwIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPjxzdHJvbmc+Qm9sZDwvc3Ryb25nPiBmaWVsZDwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3VtYndzcWNkbm8nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0ndW1id3NxY2Rubyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInVtYndzcWNkbm8iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J25leHdmbm5waHEnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2MnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2MnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGNgIj5jPC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2MnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3h6eWRzYnRobG4nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0neHp5ZHNidGhsbic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInh6eWRzYnRobG4iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSduZXh3Zm5ucGhxJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibmV4d2ZubnBocSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgTmFtZWRUdXBsZSIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0nYXVzdXpnaWxmeSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImF1c3V6Z2lsZnkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J2Z0ZGRncHJ1eXMnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdnZG5maXF3aG15Jz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD48Ym9uZHNsaXN0LWNvbnRhaW5lciBjbGFzcz0nbm8tcG9wb3V0Jz4KCTxib25kc2xpc3QtaGVhZGVyPgoJCTxzcGFuIGNsYXNzPSdjb2xsYXBzZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbicgdGl0bGU9IlRoaXMgbGlzdCBjb250YWlucyBpbmRlcGVuZGVudCBib25kcyI+TXkgR3JvdXAgb2YgQm9uZHM8L3NwYW4+CgkJPHNwYW4gY2xhc3M9J3RvZ2dsZSBib25kc2xpc3QtaWNvbic+PC9zcGFuPgoJPC9ib25kc2xpc3QtaGVhZGVyPgoJPGJvbmRzbGlzdC1jb250ZW50cz4KCTxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBmcmVxYCc+CgkJRnJlcXVlbmN5IFtHSHpdCgk8L2JvbmQtZGVzY3JpcHRpb24+Cgk8Ym9uZC12YWx1ZT4KCQk8Ym9uZCBkZWY9ImZyZXEiIHVuaXF1ZV9pZD0idWVsemhhZm1vZHF6Ij4KPHNjcmlwdD4KCWNvbnN0IGQzZm9ybWF0ID0gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKCWNvbnN0IGVscCA9IGh0bWxgCgk8c3BhbiBjbGFzcz0ibnVtYmVyX0VkaXRhYmxlIiBzdHlsZT0iCgl0b3VjaC1hY3Rpb246IG5vbmU7CglwYWRkaW5nOiAwZW0gLjJlbTsKCWJvcmRlci1yYWRpdXM6IC4zZW07Cglmb250LXdlaWdodDogYm9sZDsiPjxzcGFuIGNvbnRlbnRFZGl0YWJsZT10cnVlPjIwPC9zcGFuPiBHSHo8L3NwYW4+CglgCgoJY29uc3QgZm9ybWF0dGVyID0gcyA9PiBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpCgljb25zdCBlbCA9IGVscC5xdWVyeVNlbGVjdG9yKCJzcGFuIikKCglsZXQgbG9jYWxWYWwgPSBwYXJzZUZsb2F0KDIwKQoJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDIwKQoJCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxwLCJ2YWx1ZSIsewoJCWdldDogKCkgPT4gbG9jYWxWYWwsCgkJc2V0OiB4ID0+IHsKCQkJbG9jYWxWYWwgPSBwYXJzZUZsb2F0KHgpCgkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcih4KQoJCX0KCX0pCgoJY29uc3QgZGlzcGF0Y2hFdmVudCA9IChlKSA9PiB7CgkJaWYgKGVsLmlubmVyVGV4dCA9PT0gIiIpIHsKCQkJZWxwLnZhbHVlID0gMjAgICAKCQl9IGVsc2UgewoJCQkvKiAKCQkJVGhlIHJlcGxhY2UgaXMgbmVlZGVkIGJlY2F1c2UgZDMtZm9ybWF0IG91dHB1dHMgJy0nIGFzIGluIFUrMjIxMiAobWF0aCBzeW1ib2wpIGJ1dCBmYWlscyB0byBwYXJzZSBuZWdhdGl2ZSBudW1iZXIgY29ycmVjdGx5IGlmIHRoZXkgaGF2ZSB0aGF0IHNpZ24gYXMgbmVnYXRpdmUgc2lnbi4gU28gd2UganVzdCByZXBsYWNlIGl0IHdpdGggdGhlIGRhc2ggVSswMDJEIHNpZ24gCgkJCSovCgkJCWVscC52YWx1ZSA9ICBlbC5pbm5lclRleHQucmVwbGFjZSgn4oiSJywgJy0nKQoJCX0KCQllbHAuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgl9CgoJLy8gRnVuY3Rpb24gdG8gYmx1ciB0aGUgZWxlbWVudCB3aGVuIHByZXNzaW5nIGVudGVyIGluc3RlYWQgb2YgYWRkaW5nIGEgbmV3bGluZQoJY29uc3Qgb25FbnRlciA9IChlKSA9PiB7CgkJaWYgKGUua2V5Q29kZSA9PT0gMTMpIHsKCQllLnByZXZlbnREZWZhdWx0KCk7CgkJZWwuYmx1cigpCgkJfQoJfQoKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywoZSkgPT4gewoJCWNvbnNvbGUubG9nKGUpCgkJZS5wcmV2ZW50RGVmYXVsdCgpCgkJZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKQoJfSkKCglmdW5jdGlvbiBzZWxlY3RUZXh0KGVsKXsKCQl2YXIgc2VsLCByYW5nZTsKCQlpZiAod2luZG93LmdldFNlbGVjdGlvbiAmJiBkb2N1bWVudC5jcmVhdGVSYW5nZSkgeyAvL0Jyb3dzZXIgY29tcGF0aWJpbGl0eQoJCXNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTsKCQlpZihzZWwudG9TdHJpbmcoKSA9PSAnJyl7IC8vbm8gdGV4dCBzZWxlY3Rpb24KCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCQkJCXJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTsgLy9yYW5nZSBvYmplY3QKCQkJCXJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyhlbCk7IC8vc2V0cyBSYW5nZQoJCQkJc2VsLnJlbW92ZUFsbFJhbmdlcygpOyAvL3JlbW92ZSBhbGwgcmFuZ2VzIGZyb20gc2VsZWN0aW9uCgkJCQlzZWwuYWRkUmFuZ2UocmFuZ2UpOy8vYWRkIFJhbmdlIHRvIGEgU2VsZWN0aW9uLgoJCQl9LDEpOwoJCX0KCQl9ZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7IC8vb2xkZXIgaWUKCQkJc2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7CgkJCWlmKHNlbC50ZXh0ID09ICcnKXsgLy9ubyB0ZXh0IHNlbGVjdGlvbgoJCQkJcmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpOy8vQ3JlYXRlcyBUZXh0UmFuZ2Ugb2JqZWN0CgkJCQlyYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChlbCk7Ly9zZXRzIFJhbmdlCgkJCQlyYW5nZS5zZWxlY3QoKTsgLy9tYWtlIHNlbGVjdGlvbi4KCQkJfQoJCX0KCX0KCgkKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JyxkaXNwYXRjaEV2ZW50KQoJZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsb25FbnRlcikKCWVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSkgPT4gZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSkgLy8gbW9kaWZ5IHRleHQKCWVscC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IHNlbGVjdFRleHQoZWwpKSAvLyBTZWxlY3QgYWxsIHRleHQKCglyZXR1cm4gZWxwCgo8L3NjcmlwdD4KPHN0eWxlPgoJQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogbGlnaHQpIHsKCQlzcGFuLm51bWJlcl9FZGl0YWJsZSB7CgkJCWJhY2tncm91bmQ6IGhzbCgyMDQsIDk1JSwgODQlKTsKCQl9Cgl9CglAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CgkJc3Bhbi5udW1iZXJfRWRpdGFibGUgewoJCQliYWNrZ3JvdW5kOiBoc2woMjA0LCA5NSUsIDQwJSk7CgkJfQoJfQo8L3N0eWxlPgo8L2JvbmQ+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYGFsdGAnPgoJCTxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5BbHRpdHVkZSA8c3BhbiBjbGFzcz0idGV4Ij4kaCQ8L3NwYW4+ICYjOTE7bSYjOTM7PC9wPgo8L2Rpdj4KCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxib25kIGRlZj0iYWx0IiB1bmlxdWVfaWQ9Inh5bHBjdmVoempybSI+PHNjcmlwdD4KCQkJLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4KCQkJd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCgkJCWNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQoJCQljb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgoJCQljb25zdCB2YWx1ZXMgPSBbMTAwLCAxMTAsIDEyMCwgMTMwLCAxNDAsIDE1MCwgMTYwLCAxNzAsIDE4MCwgMTkwLCAyMDBdCgoJCQljb25zdCBlbCA9IGh0bWxgCgkJCTxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKCQkJdG91Y2gtYWN0aW9uOiBub25lOwoJCQliYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CgkJCWNvbG9yOiBibGFjazsKCQkJcGFkZGluZzogMGVtIC4yZW07CgkJCWJvcmRlci1yYWRpdXM6IC4zZW07CgkJCWZvbnQtd2VpZ2h0OiBib2xkOwoJCQlmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgCQlmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwoJCQkiPjE1MDwvc3Bhbj4KCQkJYAoKCgoJCQlsZXQgb2xkX3ggPSAwCgkJCWxldCBvbGRfaW5kZXggPSAwCgkJCWNvbnN0IGluaXRpYWxfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgMTUwKQoJCQlsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCgkJCWNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgoJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCQkJCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJCQkJc2V0OiB4ID0+IHsKCQkJCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJfSwKCQkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQkJfSk7CgoJCQkvLyBpbml0aWFsIHZhbHVlCgkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcigxNTApCgoJCQljb25zdCBvblNjcnViID0gKGUpID0+IHsKCQkJCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94CgkJCQljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCQkJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJCQkJKSkKCgkJCQlpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQkJCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJCQkJfQoJCQl9CgoJCQljb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCQkJCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCgkJCQlvbGRfeCA9IGUuY2xpZW50WAoJCQkJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgoJCQljb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCQkJCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgoJCQljb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCgkJCX0KCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKCQkJZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgoJCQlpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgkJCX0pCgoJCQlyZXR1cm4gZWwKCgkJCTwvc2NyaXB0PjwvYm9uZD4KCTwvYm9uZC12YWx1ZT4KCTxzdHlsZT4KCQlib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgMC40ZnIpOwogIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7Cn0KYm9uZHRhYmxlLWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiwKYm9uZHNsaXN0LWNvbnRlbnRzIGJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KYm9uZC12YWx1ZSBib25kIHsKICBkaXNwbGF5OiBmbGV4OyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KYm9uZC12YWx1ZSBpbnB1dCB7CiAgd2lkdGg6IDEwMCU7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQoKCTwvc3R5bGU+CjwvYm9uZC13aXRoLWRlc2NyaXB0aW9uPgoJCgk8L2JvbmRzbGlzdC1jb250ZW50cz4KCTxzY3JpcHQgaWQ9J2lxbG1vd2ltZ3EnPgoJCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnRhaW5lci5jb2xsYXBzZSA9IChmb3JjZSkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJywgZm9yY2UpCgkJfQoJCWNvbnN0IGNvbGxhcHNlX2J0biA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuLmNvbGxhcHNlJykKCQljb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBjb250YWluZXIuY29sbGFwc2UoKQoJPC9zY3JpcHQ+Cgk8c3R5bGU+Cglib25kc2xpc3QtaGVhZGVyIHsKICBncmlkLWNvbHVtbjogMSAvIC0xOwogIGRpc3BsYXk6IGZsZXg7CiAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwp9CmJvbmRzbGlzdC1oZWFkZXI6YmVmb3JlIHsKICBjb250ZW50OiAiIjsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgcG9zaXRpb246IGFic29sdXRlOwogIHRvcDogMXB4OwogIGJvdHRvbTogMHB4OwogIGxlZnQ6IDBweDsKICByaWdodDogMHB4OwogIHotaW5kZXg6IC0xOwogIGJhY2tncm91bmQ6ICNmZmFjNDU0MDsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dCA+IGJvbmRzbGlzdC1oZWFkZXIgewogIGFsaWduLXNlbGY6IHN0YXJ0OwogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwcHg7CiAgcGFkZGluZy10b3A6IDEycHg7CiAgbWFyZ2luLXRvcDogLTEycHg7CiAgei1pbmRleDogMTA7Cn0KYm9uZHNsaXN0LWNvbnRlbnRzIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kc2xpc3QtY29udGFpbmVyLm5vLXBvcG91dDpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGJsb2NrOwogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAganVzdGlmeS1zZWxmOiBjZW50ZXI7CiAgYm9yZGVyLWJvdHRvbTogMnB4IHNvbGlkOwogIHBhZGRpbmctdG9wOiA1cHg7CiAgd2lkdGg6IDEwMCU7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgei1pbmRleDogMjA7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5ib25kc2xpc3QtaWNvbiB7CiAgLS1zaXplOiAxN3B4OwogIGRpc3BsYXk6IGJsb2NrOwogIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgPiBib25kc2xpc3QtaGVhZGVyID4gLmNvbGxhcHNlIHsKICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHdpZHRoOiAzMHB4OwogIG1hcmdpbjogMCAxMHB4Owp9CmJvbmRzbGlzdC1oZWFkZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgd2lkdGg6IDEwMCU7Cn0KYm9uZHNsaXN0LWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIGZsZXgtZ3JvdzogMTsKICBmb250LXNpemU6IDE4cHg7CiAgZm9udC13ZWlnaHQ6IDYwMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLnRvZ2dsZSB7CiAgYWxpZ24tc2VsZjogY2VudGVyOwp9CmJvbmRzbGlzdC1jb250YWluZXIuY29sbGFwc2VkIGJvbmRzbGlzdC1oZWFkZXIgKyAqIHsKICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHJvdy1nYXA6IDVweDsKfQpib25kdGFibGUtY29udGFpbmVyIGJvbmRzbGlzdC1jb250YWluZXIgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CgkJCgk8L3N0eWxlPgo8L2JvbmRzbGlzdC1jb250YWluZXI+Cjxib25kc2xpc3QtY29udGFpbmVyIGNsYXNzPSduby1wb3BvdXQnPgoJPGJvbmRzbGlzdC1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2NvbGxhcHNlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJyB0aXRsZT0iVGhpcyBsaXN0IGNvbnRhaW5zIGluZGVwZW5kZW50IGJvbmRzIj5Qb3BvdXQgQ29udGFpbmVyPC9zcGFuPgoJCTxzcGFuIGNsYXNzPSd0b2dnbGUgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCTwvYm9uZHNsaXN0LWhlYWRlcj4KCTxib25kc2xpc3QtY29udGVudHM+Cgk8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgYXNkYCc+CgkJU3RydWN0dXJlIEFTRAoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSdzZ3lsbGJrbWtlJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3BvamhuemFjemknIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxib25kIGRlZj0iYXNkIiB1bmlxdWVfaWQ9ImxzeWpiZnBvcGhjeiI+PHN0cnVjdC1ib25kIGNsYXNzPSdNYWluLnZhciZxdW90O3dvcmtzcGFjZSM0NjMmcXVvdDsuQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtY255b3hkeXR1JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPk1hcmtkb3duIGRlc2NyaXB0aW9uLCBpbmNsdWRpbmcgPHNwYW4gY2xhc3M9InRleCI+JExhVGVYJDwvc3Bhbj48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdza2JoZHh3aWh3JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NrYmhkeHdpaHcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJza2JoZHh3aWh3Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naW1ueWxsYmdjZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNjcmlwdD4KCQkJLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4KCQkJd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCgkJCWNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQoJCQljb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgoJCQljb25zdCB2YWx1ZXMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTBdCgoJCQljb25zdCBlbCA9IGh0bWxgCgkJCTxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKCQkJdG91Y2gtYWN0aW9uOiBub25lOwoJCQliYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CgkJCWNvbG9yOiBibGFjazsKCQkJcGFkZGluZzogMGVtIC4yZW07CgkJCWJvcmRlci1yYWRpdXM6IC4zZW07CgkJCWZvbnQtd2VpZ2h0OiBib2xkOwoJCQlmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgCQlmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwoJCQkiPjY8L3NwYW4+CgkJCWAKCgoKCQkJbGV0IG9sZF94ID0gMAoJCQlsZXQgb2xkX2luZGV4ID0gMAoJCQljb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCgkJCWxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKCQkJY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJCQkJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCgkJCQlzZXQ6IHggPT4gewoJCQkJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQl9LAoJCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCQl9KTsKCgkJCS8vIGluaXRpYWwgdmFsdWUKCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgoJCQljb25zdCBvblNjcnViID0gKGUpID0+IHsKCQkJCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94CgkJCQljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCQkJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJCQkJKSkKCgkJCQlpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQkJCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJCQkJfQoJCQl9CgoJCQljb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCQkJCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCgkJCQlvbGRfeCA9IGUuY2xpZW50WAoJCQkJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgoJCQljb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCQkJCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgoJCQljb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCgkJCX0KCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKCQkJZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgoJCQlpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgkJCX0pCgoJCQlyZXR1cm4gZWwKCgkJCTwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ltbnlsbGJnY2YnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJpbW55bGxiZ2NmIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdjZXNkYmZjcmFvJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nY2VzZGJmY3Jhbyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImNlc2RiZmNyYW8iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2t4a215aWNnam4nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZnNic3ptbW9sYicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ZzYnN6bW1vbGInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJmc2Jzem1tb2xiIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlZ2F1eW93a2JrJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZWdhdXlvd2tiayc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVnYXV5b3drYmsiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdreGtteWljZ2puJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAia3hrbXlpY2dqbiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgQVNEIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdtY255b3hkeXR1Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibWNueW94ZHl0dSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nanhmZmN6eGltdic+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JnYWV2eXdleHcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0nc2d5bGxia21rZSc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb21AMS43LjQnKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewogICAgICAgIC8vIERlYWwgd2l0aCBzY3JvbGxpbmcKICAgICAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJykgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQKCgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFsKICAgICAgICAgICAgICAgIGF1dG9QbGFjZW1lbnQoKSwKICAgICAgICAgICAgXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSAtIHNjcm9sbFRvcCArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgkvLyBDcmVhdGUgYSByZXVzYWJsZSBkZWJvdW5jZWQgY2xhc3MgcmVtb3ZhbCBmdW5jdGlvbgoJY29uc3QgY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyID0gKGNvbnRhaW5lciwgY2xhc3NOYW1lLCBkZWxheSkgPT4gewoJCXJldHVybiBfLmRlYm91bmNlKCgpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCBmYWxzZSkKCQl9LCBkZWxheSkKCX0KCgljb25zdCBkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyID0gY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyKGNvbnRhaW5lciwgJ2NvbnRlbnRzLWhvdmVyJywgMzAwKQoJY29uc3QgZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnaGVhZGVyLWhvdmVyJywgMzAwKQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCQlkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyLmNhbmNlbCgpCgl9Cgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIoKQoJfQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyLmNhbmNlbCgpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IHsKCQlkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlcigpCgl9Cjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdwb2pobnphY3ppJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAicG9qaG56YWN6aSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+Cjxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBudGAnPgoJCU5hbWVkVHVwbGUKCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwb3BvdXQtY29udGFpbmVyIGtleT0nbXZmd3FsdGl4eSc+Cgk8cG9wb3V0LWhlYWRlcj48c3BhbiBjbGFzcz0ncG9wb3V0LWljb24gcG9wb3V0Jz48L3NwYW4+PC9wb3BvdXQtaGVhZGVyPgoJPHBvcG91dC1jb250ZW50cz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlcm5jbXBuZnhiJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48Ym9uZCBkZWY9Im50IiB1bmlxdWVfaWQ9InhuY2NqaWFpdXZxeCI+PHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDAxJnF1b3Q7KSwgOmEsIDpiLCA6Yyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TXkgRmFuY3kgTlR1cGxlPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdhdXN1emdpbGZ5JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndGtjYXhpeWtpcCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd0a2NheGl5a2lwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidGtjYXhpeWtpcCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbmV4d2ZubnBocScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd1bWJ3c3FjZG5vJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3VtYndzcWNkbm8nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ1bWJ3c3FjZG5vIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd4enlkc2J0aGxuJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3h6eWRzYnRobG4nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ4enlkc2J0aGxuIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nbmV4d2ZubnBocSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm5leHdmbm5waHEiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE5hbWVkVHVwbGUiKQo8L3NjcmlwdD4KCTxzY3JpcHQgaWQ9J2F1c3V6Z2lsZnknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJhdXN1emdpbGZ5Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdmdGRkZ3BydXlzJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCiAgICAgICAgY29uc3QgY29sbGFwc2VfYnRuID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuY29sbGFwc2UtYnRuJykKCiAgICAgICAgcGFyZW50LmNvbGxhcHNlID0gKCkgPT4gewogICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKICAgICAgICB9CgogICAgICAgIGNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHBhcmVudC5jb2xsYXBzZSgpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgZmllbGQtaHRtbCB7CiAgICBkaXNwbGF5OiBjb250ZW50czsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICAvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwogICAgZmxleDogMTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAgZGlzcGxheTogZmxleDsKfQoKLmNvbGxhcHNlLWJ0biB7CiAgICBkaXNwbGF5OiBub25lOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQ+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgd2lkdGg6IDEwMCU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmRlc2NyaXB0aW9uIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBhbGlnbi1zZWxmOiBjZW50ZXIKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIrKiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nZ2RuZmlxd2hteSc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdtdmZ3cWx0aXh5Jz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbUAxLjcuNCcpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkJLy8gV2UgdXNlIHRoZSBpbnRlcmFjdGpzIGxpYnJhcnkgdG8gcHJvdmlkZSBkcmFnIGFuZCByZXNpemUgaGFuZGxpbmcgYWNyb3NzIGRldmljZXMKCWNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgoJY29udGVudHMub2Zmc2V0ID0gY29udGVudHMub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuZGVzY3JpcHRpb24sIGJvbmRzbGlzdC1oZWFkZXIgLmRlc2NyaXB0aW9uJykpLmRyYWdnYWJsZSh7CgkJbGlzdGVuZXJzOiB7CgkJCXN0YXJ0IChldmVudCkgewoJCQkJY29udGVudHMub2Zmc2V0LnkgPSBzdGFydFBvc2l0aW9uLnkgPSBjb250ZW50cy5vZmZzZXRUb3AKCQkJCWNvbnRlbnRzLm9mZnNldC54ID0gc3RhcnRQb3NpdGlvbi54ID0gY29udGVudHMub2Zmc2V0TGVmdAoJCQl9LAoJCQltb3ZlIChldmVudCkgewoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGVudHMub2Zmc2V0LnkgKz0gZXZlbnQuZHkKCQkKCQkgICAgICBjb250ZW50cy5zdHlsZS50b3AgPSBgbWluKDk1dmgsICR7Y29udGVudHMub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGVudHMuc3R5bGUubGVmdCA9IGBtaW4oOTV2dywgJHtjb250ZW50cy5vZmZzZXQueH1weGAKCQkgICAgfSwKCQl9Cgl9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIGhlYWRlciByZXNldCB0aGUgcG9zaXRpb24KCQljb250YWluZXIucG9wb3V0KCkKCX0pCglpbnRlcmFjdChjb250ZW50cykKCSAgLnJlc2l6YWJsZSh7CgkgICAgZWRnZXM6IHsgdG9wOiB0cnVlLCBsZWZ0OiBmYWxzZSwgYm90dG9tOiB0cnVlLCByaWdodDogdHJ1ZSB9LAoJICAgIGxpc3RlbmVyczogewoJICAgICAgbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7CQkKCSAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudC50YXJnZXQuc3R5bGUsIHsKCSAgICAgICAgICB3aWR0aDogYCR7ZXZlbnQucmVjdC53aWR0aH1weGAsCgkgICAgICAgICAgaGVpZ2h0OiBgJHtldmVudC5yZWN0LmhlaWdodH1weGAsCgkgICAgICAgIH0pCgkgICAgICB9CgkgICAgfQoJICB9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIHJlc2l6ZSByZXNldCB0aGUgd2lkdGgKCQkJY29udGVudHMuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRlbnRzLnN0eWxlLmhlaWdodCA9ICcnCgkgIH0pCgoKCWZ1bmN0aW9uIHBvc2l0aW9uQ29udGVudHMoKSB7CiAgICAgICAgLy8gRGVhbCB3aXRoIHNjcm9sbGluZwogICAgICAgIGNvbnN0IHNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQKICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSBzY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wIHx8IHdpbmRvdy5wYWdlWU9mZnNldAoKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogWwogICAgICAgICAgICAgICAgYXV0b1BsYWNlbWVudCgpLAogICAgICAgICAgICBdLAoJCX0pLnRoZW4oKHBvcykgPT4gewoJCQljb250ZW50cy5zdHlsZS5sZWZ0ID0gcG9zLnggKyAicHgiCgkJCWNvbnRlbnRzLnN0eWxlLnRvcCA9IHBvcy55IC0gc2Nyb2xsVG9wICsgInB4IgoJCX0pCgl9CgoJY29udGFpbmVyLnBvcG91dCA9IChmb3JjZSA9IHVuZGVmaW5lZCkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdwb3BwZWQnLCBmb3JjZSkKCQlwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCgloZWFkZXIub25jbGljayA9IChlKSA9PiB7Y29udGFpbmVyLnBvcG91dCgpfQoKCS8vIENyZWF0ZSBhIHJldXNhYmxlIGRlYm91bmNlZCBjbGFzcyByZW1vdmFsIGZ1bmN0aW9uCgljb25zdCBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIgPSAoY29udGFpbmVyLCBjbGFzc05hbWUsIGRlbGF5KSA9PiB7CgkJcmV0dXJuIF8uZGVib3VuY2UoKCkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIGZhbHNlKQoJCX0sIGRlbGF5KQoJfQoKCWNvbnN0IGRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnY29udGVudHMtaG92ZXInLCAzMDApCgljb25zdCBkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlciA9IGNyZWF0ZURlYm91bmNlZENsYXNzUmVtb3Zlcihjb250YWluZXIsICdoZWFkZXItaG92ZXInLCAzMDApCgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCB0cnVlKQoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIuY2FuY2VsKCkKCX0KCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiB7CgkJZGVib3VuY2VkUmVtb3ZlQ29udGVudHNIb3ZlcigpCgl9CgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgkJZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIuY2FuY2VsKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyKCkKCX0KPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J2VybmNtcG5meGInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJlcm5jbXBuZnhiIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYHNic2AnPgoJCVN0cnVjdEJvbmRTZWxlY3QKCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwb3BvdXQtY29udGFpbmVyIGtleT0naGRmeW56emF5cyc+Cgk8cG9wb3V0LWhlYWRlcj48c3BhbiBjbGFzcz0ncG9wb3V0LWljb24gcG9wb3V0Jz48L3NwYW4+PC9wb3BvdXQtaGVhZGVyPgoJPHBvcG91dC1jb250ZW50cz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdodmFmdmFrZHhhJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48Ym9uZCBkZWY9InNicyIgdW5pcXVlX2lkPSJ5bHdyaHl0YWNqbG4iPjx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlIHN0cnVjdGJvbmQtc2VsZWN0Jz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+U3RydWN0Qm9uZFNlbGVjdDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ncnNnc2hiYmRnYycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHN0cnVjdGJvbmQtc2VsZWN0PgogICAgPHNwYW4gY2xhc3M9InNlbGVjdG9yIj4KICAgICAgICA8c3BhbiBjbGFzcz0iZGVzY3JpcHRpb24iPk9wdGlvbnM6PC9zcGFuPgogICAgICAgIDxzZWxlY3Q+PG9wdGlvbiB2YWx1ZT0ncHVpc2VsZWN0LTEnPmNvcyhhcmcpPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT0ncHVpc2VsZWN0LTInIHNlbGVjdGVkPScnPmF0YW4oeSx4KTwvb3B0aW9uPjwvc2VsZWN0PgogICAgPC9zcGFuPgogICAgPHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA0JnF1b3Q7KSwgOmFyZyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+Y29zKGFyZyk8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2hmYm9tYm95angnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J3aXl4aWdsd2MnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2FyZyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYXJnJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhcmdgIj5hcmc8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYXJnJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd5cWNjemlqcXdhJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMDAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd5cWNjemlqcXdhJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAieXFjY3ppanF3YSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2J3aXl4aWdsd2MnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJid2l5eGlnbHdjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQo8c2NyaXB0PgoJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCglkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBOYW1lZFR1cGxlIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdoZmJvbWJveWp4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaGZib21ib3lqeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0ndGZuZHl4Y2tndCc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2Znc3p0dHVpYXgnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA1JnF1b3Q7KSwgOngsIDp5KX0nPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBjbGFzcz0nY29sbGFwc2libGUnPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KICAgICAgICA8c3BhbiBjbGFzcz0nY29sbGFwc2UtYnRuJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5hdGFuKHkseCk8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2F5ZWZ5d2Z0emEnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2JmaGpmc2Zvd2UnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J3gnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J3gnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYHhgIj54PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J3gnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2N0cGVkZHltcnMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwMScgdmFsdWU9JzMxJz48c2NyaXB0PgoJCQkJCWNvbnN0IGlucHV0X2VsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJCQkJY29uc3Qgb3V0cHV0X2VsID0gY3VycmVudFNjcmlwdC5uZXh0RWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBkaXNwbGF5cyA9IFsiMC4wIiwgIjAuMSIsICIwLjIiLCAiMC4zIiwgIjAuNCIsICIwLjUiLCAiMC42IiwgIjAuNyIsICIwLjgiLCAiMC45IiwgIjEuMCIsICIxLjEiLCAiMS4yIiwgIjEuMyIsICIxLjQiLCAiMS41IiwgIjEuNiIsICIxLjciLCAiMS44IiwgIjEuOSIsICIyLjAiLCAiMi4xIiwgIjIuMiIsICIyLjMiLCAiMi40IiwgIjIuNSIsICIyLjYiLCAiMi43IiwgIjIuOCIsICIyLjkiLCAiMy4wIiwgIjMuMSIsICIzLjIiLCAiMy4zIiwgIjMuNCIsICIzLjUiLCAiMy42IiwgIjMuNyIsICIzLjgiLCAiMy45IiwgIjQuMCIsICI0LjEiLCAiNC4yIiwgIjQuMyIsICI0LjQiLCAiNC41IiwgIjQuNiIsICI0LjciLCAiNC44IiwgIjQuOSIsICI1LjAiLCAiNS4xIiwgIjUuMiIsICI1LjMiLCAiNS40IiwgIjUuNSIsICI1LjYiLCAiNS43IiwgIjUuOCIsICI1LjkiLCAiNi4wIiwgIjYuMSIsICI2LjIiLCAiNi4zIiwgIjYuNCIsICI2LjUiLCAiNi42IiwgIjYuNyIsICI2LjgiLCAiNi45IiwgIjcuMCIsICI3LjEiLCAiNy4yIiwgIjcuMyIsICI3LjQiLCAiNy41IiwgIjcuNiIsICI3LjciLCAiNy44IiwgIjcuOSIsICI4LjAiLCAiOC4xIiwgIjguMiIsICI4LjMiLCAiOC40IiwgIjguNSIsICI4LjYiLCAiOC43IiwgIjguOCIsICI4LjkiLCAiOS4wIiwgIjkuMSIsICI5LjIiLCAiOS4zIiwgIjkuNCIsICI5LjUiLCAiOS42IiwgIjkuNyIsICI5LjgiLCAiOS45IiwgIjEwLjAiXQoKCQkJCQlsZXQgdXBkYXRlX291dHB1dCA9ICgpID0+IHsKCQkJCQkJb3V0cHV0X2VsLnZhbHVlID0gZGlzcGxheXNbaW5wdXRfZWwudmFsdWVBc051bWJlciAtIDFdCgkJCQkJfQoJCQkJCQoJCQkJCWlucHV0X2VsLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgdXBkYXRlX291dHB1dCkKCQkJCQkvLyBXZSBhbHNvIHBvbGwgZm9yIGNoYW5nZXMgYmVjYXVzZSB0aGUgYGlucHV0X2VsLnZhbHVlYCBjYW4gY2hhbmdlIGZyb20gdGhlIG91dHNpZGUsIGUuZy4gaHR0cHM6Ly9naXRodWIuY29tL0p1bGlhUGx1dG8vUGx1dG9VSS5qbC9pc3N1ZXMvMjc3CgkJCQkJbGV0IGlkID0gc2V0SW50ZXJ2YWwodXBkYXRlX291dHB1dCwgMjAwKQoJCQkJCWludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCQkJCQkJY2xlYXJJbnRlcnZhbChpZCkKCQkJCQkJaW5wdXRfZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCX0pCgkJCQkJPC9zY3JpcHQ+PG91dHB1dCBzdHlsZT0nCgkJCQkJCWZvbnQtZmFtaWx5OiBzeXN0ZW0tdWk7CiAgICAJCQkJCWZvbnQtc2l6ZTogMTVweDsKICAgIAkJCQkJbWFyZ2luLWxlZnQ6IDNweDsKICAgIAkJCQkJdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC00cHgpOwogICAgCQkJCQlkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Jz4zLjA8L291dHB1dD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdjdHBlZGR5bXJzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiY3RwZWRkeW1ycyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYmZoamZzZm93ZScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0neSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0neScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgeWAiPnk8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0neSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYmhtc2F0ZWJwdycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAxJyB2YWx1ZT0nNTEnPjxzY3JpcHQ+CgkJCQkJY29uc3QgaW5wdXRfZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBvdXRwdXRfZWwgPSBjdXJyZW50U2NyaXB0Lm5leHRFbGVtZW50U2libGluZwoJCQkJCWNvbnN0IGRpc3BsYXlzID0gWyIwLjAiLCAiMC4xIiwgIjAuMiIsICIwLjMiLCAiMC40IiwgIjAuNSIsICIwLjYiLCAiMC43IiwgIjAuOCIsICIwLjkiLCAiMS4wIiwgIjEuMSIsICIxLjIiLCAiMS4zIiwgIjEuNCIsICIxLjUiLCAiMS42IiwgIjEuNyIsICIxLjgiLCAiMS45IiwgIjIuMCIsICIyLjEiLCAiMi4yIiwgIjIuMyIsICIyLjQiLCAiMi41IiwgIjIuNiIsICIyLjciLCAiMi44IiwgIjIuOSIsICIzLjAiLCAiMy4xIiwgIjMuMiIsICIzLjMiLCAiMy40IiwgIjMuNSIsICIzLjYiLCAiMy43IiwgIjMuOCIsICIzLjkiLCAiNC4wIiwgIjQuMSIsICI0LjIiLCAiNC4zIiwgIjQuNCIsICI0LjUiLCAiNC42IiwgIjQuNyIsICI0LjgiLCAiNC45IiwgIjUuMCIsICI1LjEiLCAiNS4yIiwgIjUuMyIsICI1LjQiLCAiNS41IiwgIjUuNiIsICI1LjciLCAiNS44IiwgIjUuOSIsICI2LjAiLCAiNi4xIiwgIjYuMiIsICI2LjMiLCAiNi40IiwgIjYuNSIsICI2LjYiLCAiNi43IiwgIjYuOCIsICI2LjkiLCAiNy4wIiwgIjcuMSIsICI3LjIiLCAiNy4zIiwgIjcuNCIsICI3LjUiLCAiNy42IiwgIjcuNyIsICI3LjgiLCAiNy45IiwgIjguMCIsICI4LjEiLCAiOC4yIiwgIjguMyIsICI4LjQiLCAiOC41IiwgIjguNiIsICI4LjciLCAiOC44IiwgIjguOSIsICI5LjAiLCAiOS4xIiwgIjkuMiIsICI5LjMiLCAiOS40IiwgIjkuNSIsICI5LjYiLCAiOS43IiwgIjkuOCIsICI5LjkiLCAiMTAuMCJdCgoJCQkJCWxldCB1cGRhdGVfb3V0cHV0ID0gKCkgPT4gewoJCQkJCQlvdXRwdXRfZWwudmFsdWUgPSBkaXNwbGF5c1tpbnB1dF9lbC52YWx1ZUFzTnVtYmVyIC0gMV0KCQkJCQl9CgkJCQkJCgkJCQkJaW5wdXRfZWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCS8vIFdlIGFsc28gcG9sbCBmb3IgY2hhbmdlcyBiZWNhdXNlIHRoZSBgaW5wdXRfZWwudmFsdWVgIGNhbiBjaGFuZ2UgZnJvbSB0aGUgb3V0c2lkZSwgZS5nLiBodHRwczovL2dpdGh1Yi5jb20vSnVsaWFQbHV0by9QbHV0b1VJLmpsL2lzc3Vlcy8yNzcKCQkJCQlsZXQgaWQgPSBzZXRJbnRlcnZhbCh1cGRhdGVfb3V0cHV0LCAyMDApCgkJCQkJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCQkJCQljbGVhckludGVydmFsKGlkKQoJCQkJCQlpbnB1dF9lbC5yZW1vdmVFdmVudExpc3RlbmVyKCJpbnB1dCIsIHVwZGF0ZV9vdXRwdXQpCgkJCQkJfSkKCQkJCQk8L3NjcmlwdD48b3V0cHV0IHN0eWxlPScKCQkJCQkJZm9udC1mYW1pbHk6IHN5c3RlbS11aTsKICAgIAkJCQkJZm9udC1zaXplOiAxNXB4OwogICAgCQkJCQltYXJnaW4tbGVmdDogM3B4OwogICAgCQkJCQl0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTRweCk7CiAgICAJCQkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsnPjUuMDwvb3V0cHV0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JobXNhdGVicHcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJiaG1zYXRlYnB3Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYmZoamZzZm93ZSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJmaGpmc2Zvd2UiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE5hbWVkVHVwbGUiKQo8L3NjcmlwdD4KCTxzY3JpcHQgaWQ9J2F5ZWZ5d2Z0emEnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJheWVmeXdmdHphIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdwcmh5c3p6YW92Jz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCiAgICAgICAgY29uc3QgY29sbGFwc2VfYnRuID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuY29sbGFwc2UtYnRuJykKCiAgICAgICAgcGFyZW50LmNvbGxhcHNlID0gKCkgPT4gewogICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKICAgICAgICB9CgogICAgICAgIGNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHBhcmVudC5jb2xsYXBzZSgpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgZmllbGQtaHRtbCB7CiAgICBkaXNwbGF5OiBjb250ZW50czsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICAvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwogICAgZmxleDogMTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAgZGlzcGxheTogZmxleDsKfQoKLmNvbGxhcHNlLWJ0biB7CiAgICBkaXNwbGF5OiBub25lOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQ+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgd2lkdGg6IDEwMCU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmRlc2NyaXB0aW9uIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBhbGlnbi1zZWxmOiBjZW50ZXIKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIrKiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nem9yemR5cW51aic+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgoKICAgIDxzY3JpcHQ+CiAgICAgICAgY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KICAgICAgICBjb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwogICAgICAgIAogICAgICAgIC8vIFRoaXMgaXMgdGhlIGVsZW1lbnQgb2YgdGhlIHNlbGVjdCBkcm9wZG93bgogICAgICAgIGNvbnN0IHNlbGVjdCA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCJzZWxlY3QiKQoKICAgICAgICAvLyBUaGlzIHdpbGwgaG9sZCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHN0cnVjdGJvbmQgZWxlbWVudAogICAgICAgIGxldCBzZWxlY3RlZAoKICAgICAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldF9zZWxlY3RfdmFsdWUoKSB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0X2lucHV0X3ZhbHVlKHNlbGVjdCkKICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLnN1YnN0cmluZygxMCkpCiAgICAgICAgfQoKICAgICAgICBjb25zdCBjaGFuZ2Vfc2VsZWN0aW9uID0gKHZhbHVlLCB0cmlnZ2VyX2V2ZW50ID0gdHJ1ZSkgPT4gewogICAgICAgICAgICBzZXRfaW5wdXRfdmFsdWUoc2VsZWN0LCBgcHVpc2VsZWN0LSR7dmFsdWV9YCkKICAgICAgICAgICAgY29uc3QgYm9uZHMgPSBwYXJlbnQucXVlcnlTZWxlY3RvckFsbCgic3RydWN0LWJvbmQiKQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvbmRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoaSAhPSB2YWx1ZSAtIDEpIHsKICAgICAgICAgICAgICAgICAgICBib25kc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRkZW4iLCB0cnVlKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBib25kc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRkZW4iLCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGJvbmRzW2ldCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRyaWdnZXJfZXZlbnQpIHsKICAgICAgICAgICAgICAgIHVwZGF0ZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNoYW5nZV9zZWxlY3Rpb24oZ2V0X3NlbGVjdF92YWx1ZSgpLCBmYWxzZSkKCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgInZhbHVlIiwgewogICAgICAgICAgICBnZXQ6ICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZ2V0X3NlbGVjdF92YWx1ZSgpCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldF9pbnB1dF92YWx1ZShzZWxlY3RlZCkKICAgICAgICAgICAgICAgIHJldHVybiBbaW5kZXgsIHZhbHVlXQogICAgICAgICAgICB9LAogICAgICAgICAgICBzZXQ6IChuZXd2YWwpID0+IHsKICAgICAgICAgICAgICAgIGNoYW5nZV9zZWxlY3Rpb24obmV3dmFsWzBdLCBmYWxzZSkKICAgICAgICAgICAgICAgIHNldF9pbnB1dF92YWx1ZShzZWxlY3RlZCwgbmV3dmFsWzFdKQogICAgICAgICAgICB9LAogICAgICAgIH0pCgogICAgICAgIC8vIFdlIGFkZCBhIGxpc3RlbmVyIHRoYXQgZXh0cmFjdCB0aGUgZm9yd2FyZCB0aGUgaW5wdXQgZXZlbnQgaW4gY2FzZSB0aGUgdGFyZ2V0IG9mIHRoZSBldmVudCBpcyB0aGUgc2VsZWN0ZWQgYm9uZAogICAgICAgIGZvciAobGV0IGJvbmQgb2YgcGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInN0cnVjdC1ib25kIikpIHsKICAgICAgICAgICAgYm9uZC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgICAgICBpZiAoYm9uZCA9PSBzZWxlY3RlZCkgewogICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfQoKICAgICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCAoZSkgPT4gewogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgIGNoYW5nZV9zZWxlY3Rpb24oZ2V0X3NlbGVjdF92YWx1ZSgpKQogICAgICAgIH0pCiAgICA8L3NjcmlwdD4KICAgIDxzdHlsZT4KICAgICAgICBzdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI6Zmlyc3Qtb2YtdHlwZS5uby1wb3BvdXQ6YmVmb3JlIHsKICBkaXNwbGF5OiBub25lOwp9CgpzdHJ1Y3Rib25kLXNlbGVjdCA+IHN0cnVjdC1ib25kLmhpZGRlbiB7CiAgZGlzcGxheTogbm9uZTsKfQoKc3RydWN0Ym9uZC1zZWxlY3QsCnN0cnVjdGJvbmQtc2VsZWN0ID4gc3RydWN0LWJvbmQsCnN0cnVjdGJvbmQtc2VsZWN0IHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQoKc3RydWN0Ym9uZC1zZWxlY3QgPiAuc2VsZWN0b3IgLmRlc2NyaXB0aW9uIHsKICBjb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yLCAjNDA0MDQwKTsKfQoKc3RydWN0Ym9uZC1zZWxlY3QgPnN0cnVjdC1ib25kPnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogIGRpc3BsYXk6IG5vbmU7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCB7CiAgICBwYWRkaW5nOiA2cHggMTJweDsKICAgIGJvcmRlcjogMnB4IHNvbGlkICNlN2U3ZTc7CiAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBjb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yLCAjNDA0MDQwKTsKICAgIGZvbnQtZmFtaWx5OiBpbmhlcml0OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjJzOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgCiAgICAvKiBTaXplIGNvbnN0cmFpbnRzICovCiAgICBtYXgtd2lkdGg6IDUwcHg7IAogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIAogICAgLyogQ3VzdG9tIGFycm93IHN0eWxpbmcgKi8KICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAtbW96LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAvKiBMaWdodCBtb2RlIGFycm93IC0gIzQwNDA0MCAqLwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD1VVEYtOCwlM2NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMjQgMjQnIGZpbGw9J25vbmUnIHN0cm9rZT0nJTIzNDA0MDQwJyBzdHJva2Utd2lkdGg9JzInIHN0cm9rZS1saW5lY2FwPSdyb3VuZCcgc3Ryb2tlLWxpbmVqb2luPSdyb3VuZCclM2UlM2Nwb2x5bGluZSBwb2ludHM9JzYgOSAxMiAxNSAxOCA5JyUzZSUzYy9wb2x5bGluZSUzZSUzYy9zdmclM2UiKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiByaWdodCA4cHggY2VudGVyOwogICAgYmFja2dyb3VuZC1zaXplOiAxNnB4OwogICAgcGFkZGluZy1yaWdodDogMzJweDsKICAgIG1pbi13aWR0aDogMTIwcHg7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdDpob3ZlciB7CiAgICBib3JkZXItY29sb3I6ICNkMGQwZDA7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdDpmb2N1cyB7CiAgICBib3JkZXItY29sb3I6ICNjMGMwYzA7Cn0KCkBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHsKICAgIHN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCB7CiAgICAgICAgYm9yZGVyLWNvbG9yOiAjN2Q3ZDdkOwogICAgICAgIGNvbG9yOiB2YXIoLS1wbHV0by1vdXRwdXQtY29sb3IsICNjNGM0YzQpOwogICAgICAgIC8qIERhcmsgbW9kZSBhcnJvdyAtICNjNGM0YzQgKi8KICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PVVURi04LCUzY3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAyNCAyNCcgZmlsbD0nbm9uZScgc3Ryb2tlPSclMjNjNGM0YzQnIHN0cm9rZS13aWR0aD0nMicgc3Ryb2tlLWxpbmVjYXA9J3JvdW5kJyBzdHJva2UtbGluZWpvaW49J3JvdW5kJyUzZSUzY3BvbHlsaW5lIHBvaW50cz0nNiA5IDEyIDE1IDE4IDknJTNlJTNjL3BvbHlsaW5lJTNlJTNjL3N2ZyUzZSIpOwogICAgfQogICAgCiAgICBzdHJ1Y3Rib25kLXNlbGVjdCA+IC5zZWxlY3RvciBzZWxlY3Q6aG92ZXIgewogICAgICAgIGJvcmRlci1jb2xvcjogIzhhOGE4YTsKICAgIH0KICAgIAogICAgc3RydWN0Ym9uZC1zZWxlY3QgPiAuc2VsZWN0b3Igc2VsZWN0OmZvY3VzIHsKICAgICAgICBib3JkZXItY29sb3I6ICM3ZDdkN2Q7CiAgICB9Cn0KCi8qIEFkZCBzdHlsaW5nIGZvciBkcm9wZG93biBvcHRpb25zICovCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCBvcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuc3RydWN0Ym9uZC1zZWxlY3QgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDFweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjYzhlZGQ1OyAgCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5zdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB6LWluZGV4OiAxMDsKfQoKQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykgewogIHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5zdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI6YmVmb3JlIHsKICAgIGJhY2tncm91bmQ6ICMyNjU4MmU7ICAKICB9Cn0KICAgIDwvc3R5bGU+Cjwvc3RydWN0Ym9uZC1zZWxlY3Q+CjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlVzZSB0aGUgc2VsZWN0b3IgdG8gY2hvb3NlIHdoaWNoIFN0cnVjdEJvbmQgdG8gZGlzcGxheSBhbmQgdXNlLiIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0ncnNnc2hiYmRnYyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInJzZ3NoYmJkZ2MiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J29oam5oY2RzbnYnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0naGRmeW56emF5cyc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb21AMS43LjQnKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewogICAgICAgIC8vIERlYWwgd2l0aCBzY3JvbGxpbmcKICAgICAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJykgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQKCgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFsKICAgICAgICAgICAgICAgIGF1dG9QbGFjZW1lbnQoKSwKICAgICAgICAgICAgXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSAtIHNjcm9sbFRvcCArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgkvLyBDcmVhdGUgYSByZXVzYWJsZSBkZWJvdW5jZWQgY2xhc3MgcmVtb3ZhbCBmdW5jdGlvbgoJY29uc3QgY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyID0gKGNvbnRhaW5lciwgY2xhc3NOYW1lLCBkZWxheSkgPT4gewoJCXJldHVybiBfLmRlYm91bmNlKCgpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCBmYWxzZSkKCQl9LCBkZWxheSkKCX0KCgljb25zdCBkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyID0gY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyKGNvbnRhaW5lciwgJ2NvbnRlbnRzLWhvdmVyJywgMzAwKQoJY29uc3QgZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnaGVhZGVyLWhvdmVyJywgMzAwKQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCQlkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyLmNhbmNlbCgpCgl9Cgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIoKQoJfQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyLmNhbmNlbCgpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IHsKCQlkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlcigpCgl9Cjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdodmFmdmFrZHhhJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaHZhZnZha2R4YSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+CgkKCTwvYm9uZHNsaXN0LWNvbnRlbnRzPgoJPHNjcmlwdCBpZD0nZ2h6Y2VudGRqZic+CgkJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29udGFpbmVyLmNvbGxhcHNlID0gKGZvcmNlKSA9PiB7CgkJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnLCBmb3JjZSkKCQl9CgkJY29uc3QgY29sbGFwc2VfYnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4uY29sbGFwc2UnKQoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IGNvbnRhaW5lci5jb2xsYXBzZSgpCgk8L3NjcmlwdD4KCTxzdHlsZT4KCWJvbmRzbGlzdC1oZWFkZXIgewogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgZGlzcGxheTogZmxleDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7Cn0KYm9uZHNsaXN0LWhlYWRlcjpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAxcHg7CiAgYm90dG9tOiAwcHg7CiAgbGVmdDogMHB4OwogIHJpZ2h0OiAwcHg7CiAgei1pbmRleDogLTE7CiAgYmFja2dyb3VuZDogI2ZmYWM0NTQwOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0ID4gYm9uZHNsaXN0LWhlYWRlciB7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBwYWRkaW5nLXRvcDogMTJweDsKICBtYXJnaW4tdG9wOiAtMTJweDsKICB6LWluZGV4OiAxMDsKfQpib25kc2xpc3QtY29udGVudHMgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0OmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogYmxvY2s7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBqdXN0aWZ5LXNlbGY6IGNlbnRlcjsKICBib3JkZXItYm90dG9tOiAycHggc29saWQ7CiAgcGFkZGluZy10b3A6IDVweDsKICB3aWR0aDogMTAwJTsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICB6LWluZGV4OiAyMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLmJvbmRzbGlzdC1pY29uIHsKICAtLXNpemU6IDE3cHg7CiAgZGlzcGxheTogYmxvY2s7CiAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogIHdpZHRoOiB2YXIoLS1zaXplKTsKICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogIGN1cnNvcjogcG9pbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCA+IGJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgd2lkdGg6IDMwcHg7CiAgbWFyZ2luOiAwIDEwcHg7Cn0KYm9uZHNsaXN0LWhlYWRlciB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICB3aWR0aDogMTAwJTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgZmxleC1ncm93OiAxOwogIGZvbnQtc2l6ZTogMThweDsKICBmb250LXdlaWdodDogNjAwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBhbGlnbi1zZWxmOiBjZW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgYm9uZHNsaXN0LWhlYWRlciArICogewogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQpib25kc2xpc3QtY29udGFpbmVyIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgcm93LWdhcDogNXB4Owp9CmJvbmR0YWJsZS1jb250YWluZXIgYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCQkKCTwvc3R5bGU+CjwvYm9uZHNsaXN0LWNvbnRhaW5lcj4KCgkJPC9ib25kdGFibGUtY29udGVudHM+Cgk8L2JvbmR0YWJsZS1jb250YWluZXI+Cgk8c2NyaXB0IGlkPSdmZWViZGNhZGZiJz4KCQljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcignYm9uZHRhYmxlLWNvbnRhaW5lcicpCgkJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgkJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCQljb25zdCBjZWxsID0gY29udGFpbmVyLmNsb3Nlc3QoJ3BsdXRvLWNlbGwnKQoKICAgICAgICAvLyBUaGlzIGlzIG9ubHkgdXNlZCB0byBsZXZlcmFnZSB0aGUgcGx1dG8ganMgZnVuY3Rpb25hbGl0eSBmb3IgcGVyc2lzdGVuY3kgaW4gSlMKICAgICAgICBjb25zdCByZXR1cm5fZWxlbWVudCA9IHRoaXMgPz8gaHRtbGA8c3BhbiBjbGFzcz0nc2NyaXB0LXJldHVybic+PC9zcGFuPmAKCiAgICAgICAgaWYgKHJldHVybl9lbGVtZW50LmNvbGxhcHNlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHJldHVybl9lbGVtZW50LmNvbGxhcHNlZCA9IHVuZGVmaW5lZCA/PyBmYWxzZQogICAgICAgIH0KCgkJY29uc3QgaGVscF9idG4gPSBoZWFkZXIuZmlyc3RFbGVtZW50Q2hpbGQKCQljb25zdCBjb2xsYXBzZV9idG4gPSBoZWFkZXIubGFzdEVsZW1lbnRDaGlsZAoKCQljb250YWluZXIuY29sbGFwc2UgPSAoZm9yY2UpID0+IHsKICAgICAgICAgICAgcmV0dXJuX2VsZW1lbnQuY29sbGFwc2VkID0gZm9yY2UgPz8gIXJldHVybl9lbGVtZW50LmNvbGxhcHNlZAoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJywgcmV0dXJuX2VsZW1lbnQuY29sbGFwc2VkKQoJCX0KICAgICAgICAvLyBGb3JjZSB0aGUgaW5pdGlhbCBzdGF0dXMKICAgICAgICBjb250YWluZXIuY29sbGFwc2UocmV0dXJuX2VsZW1lbnQuY29sbGFwc2VkKQoKCQljb2xsYXBzZV9idG4ub25jbGljayA9IGUgPT4gY29udGFpbmVyLmNvbGxhcHNlKCkKCgkJLy8gTG9hZCB0aGUgaW50ZXJhY3Qgc2NyaXB0CgkJCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRhaW5lci5vZmZzZXQgPSBjb250YWluZXIub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdib25kdGFibGUtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRhaW5lci5vZmZzZXQueSA9IHN0YXJ0UG9zaXRpb24ueSA9IGNvbnRhaW5lci5vZmZzZXRUb3AKCQkJCWNvbnRhaW5lci5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRhaW5lci5vZmZzZXRMZWZ0CgkJCX0sCgkJCW1vdmUgKGV2ZW50KSB7CgkJICAgICAgY29udGFpbmVyLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGFpbmVyLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IGBtaW4oOTV2aCwgJHtjb250YWluZXIub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGFpbmVyLm9mZnNldC54fXB4YAoJCSAgICB9LAoJCX0KCX0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gaGVhZGVyIHJlc2V0IHRoZSBwb3NpdGlvbgoJCWNvbnRhaW5lci5zdHlsZS50b3AgPSAnJwoJCWNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gJycKCX0pCglpbnRlcmFjdChjb250YWluZXIpCgkgIC5yZXNpemFibGUoewoJCWlnbm9yZUZyb206ICdwb3BvdXQtY29udGFpbmVyJywKCSAgICBlZGdlczogeyB0b3A6IHRydWUsIGxlZnQ6IGZhbHNlLCBib3R0b206IHRydWUsIHJpZ2h0OiB0cnVlIH0sCgkgICAgbGlzdGVuZXJzOiB7CgkgICAgICBtb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHsJCQoJICAgICAgICBPYmplY3QuYXNzaWduKGV2ZW50LnRhcmdldC5zdHlsZSwgewoJICAgICAgICAgIHdpZHRoOiBgJHtldmVudC5yZWN0LndpZHRofXB4YCwKCSAgICAgICAgICBoZWlnaHQ6IGAke2V2ZW50LnJlY3QuaGVpZ2h0fXB4YCwKCQkJICBtYXhIZWlnaHQ6ICdub25lJywKCSAgICAgICAgfSkKCSAgICAgIH0KCSAgICB9CgkgIH0pLm9uKCdkb3VibGV0YXAnLCBmdW5jdGlvbiAoZXZlbnQpIHsKCQkgIC8vIERvdWJsZS10YXAgb24gcmVzaXplIHJlc2V0IHRoZSB3aWR0aAoJCQljb250YWluZXIuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnJwoJCSAgCWNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSAnJwoJICB9KQoKCgkJLy8gTm93IHdlIGFzc2lnbiBhIHNwZWNpZmljIGNsYXNzIHRvIGFsbCB0b2dnbGUtY29udGFpbmVyIHRoYXQgYXJlIGRpcmVjdCBjaGlsZHJlbgoJCWZvciAoY29uc3QgdHIgb2YgY29udGVudHMucXVlcnlTZWxlY3RvckFsbCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykpIHsKCQkJdHIuY2xvc2VzdCgncG9wb3V0LWNvbnRhaW5lcicpID8/IHRyLmNsYXNzTGlzdC50b2dnbGUoJ25vLXBvcG91dCcsIHRydWUpCgkJfQoJCS8vIFdlIGFsc28gZmxhZyB0aGUgZmlyc3QgdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGluIHRoZSB0YWJsZQoJCWNvbnRlbnRzLmZpcnN0RWxlbWVudENoaWxkLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5uby1wb3BvdXQnKT8uY2xhc3NMaXN0LnRvZ2dsZSgnZmlyc3QnLHRydWUpCgoJCS8vIENsaWNrIHRvIGdvIHRvIGRlZmluaXRpb24KCQljb250YWluZXIuanVtcFRvQ2VsbCA9ICgpID0+IHsKCQkJY2VsbC5zY3JvbGxJbnRvVmlldygpCgkJfQoJCWhlbHBfYnRuLm9uY2xpY2sgPSBjb250YWluZXIuanVtcFRvQ2VsbAoKICAgICAgICByZXR1cm4gcmV0dXJuX2VsZW1lbnQKCTwvc2NyaXB0PgoJPHN0eWxlPgoJYm9uZHRhYmxlLWNvbnRhaW5lciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHRvcDogNTBweDsKICAgIGxlZnQ6IDEwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCAjZTdlN2U3OwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmctbGVmdDogOHB4OwogICAgcGFkZGluZy10b3A6IDhweDsKICAgIHotaW5kZXg6IDYwMDsKICAgIHdpZHRoOiA0MDBweDsKICAgIG1heC1oZWlnaHQ6IDYwMHB4OwogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDMwMG1zIGN1YmljLWJlemllcigwLjE4LCAwLjg5LCAwLjQ1LCAxLjEyKTsKfQpib25kdGFibGUtY29udGFpbmVyOm5vdCguY29sbGFwc2VkKSA+ICogewogICAgcGFkZGluZy1yaWdodDogOHB4Owp9CmJvbmR0YWJsZS1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBwYWRkaW5nLWJvdHRvbTogOHB4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIG92ZXJmbG93OiBhdXRvOwp9CmJvbmR0YWJsZS1jb250ZW50cyB0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIubm8tcG9wb3V0LApib25kdGFibGUtY29udGVudHMgPiAqLCAKYm9uZHRhYmxlLWNvbnRlbnRzIHN0cnVjdC1ib25kIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzCn0KdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLm5vLXBvcG91dDpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBqdXN0aWZ5LXNlbGY6IGNlbnRlcjsKICAgIGJvcmRlci1ib3R0b206IDJweCBzb2xpZDsKICAgIHBhZGRpbmctdG9wOiA1cHg7CiAgICB3aWR0aDogMTAwJTsKICAgIGFsaWduLXNlbGY6IHN0YXJ0OwogICAgcG9zaXRpb246IHN0aWNreTsKICAgIHRvcDogMHB4OwogICAgYmFja2dyb3VuZDogdmFyKC0tb3ZlcmxheS1idXR0b24tYmcpOwogICAgei1pbmRleDogMjA7Cn0KdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLm5vLXBvcG91dCA+IHRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBhbGlnbi1zZWxmOiBzdGFydDsKICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICB0b3A6IDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIHBhZGRpbmctdG9wOiAxMnB4OwogICAgbWFyZ2luLXRvcDogLTEycHg7CiAgICB6LWluZGV4OiAxMDsKfQpib25kdGFibGUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWl0ZW1zOiBzdHJldGNoOwp9CmJvbmR0YWJsZS1oZWFkZXIgPiAuZGVzY3JpcHRpb24gewogICAgZmxleC1ncm93OiAxOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZm9udC1zaXplOiAyMHB4OwogICAgZm9udC13ZWlnaHQ6IDgwMDsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9CmJvbmR0YWJsZS1oZWFkZXIgPiAuaWNvbiB7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9CmJvbmR0YWJsZS1oZWFkZXIgLnRhYmxlLWNvbGxhcHNlIHsKICAgIC0tc2l6ZTogMjNweDsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9hcnJvdy1iYWNrLnN2ZyIpOwp9CmJvbmR0YWJsZS1jb250YWluZXIuY29sbGFwc2VkIC50YWJsZS1jb2xsYXBzZSB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvb3B0aW9ucy1vdXRsaW5lLnN2ZyIpOwogICAgbWFyZ2luLXJpZ2h0OiAwcHg7Cn0KYm9uZHRhYmxlLWNvbnRhaW5lci5jb2xsYXBzZWQgLnRhYmxlLWNvbGxhcHNlOmhvdmVyIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9hcnJvdy1mb3J3YXJkLnN2ZyIpOwp9CmJvbmR0YWJsZS1jb250YWluZXIuY29sbGFwc2VkIHsKICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWChjYWxjKC0xMDAlICsgMzVweCkpOwogICAgaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7CiAgICBsZWZ0OiAwcHggIWltcG9ydGFudDsKICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICBwYWRkaW5nOiA1cHg7Cn0KYm9uZHRhYmxlLWNvbnRhaW5lci5jb2xsYXBzZWQgYm9uZHRhYmxlLWNvbnRlbnRzLApib25kdGFibGUtY29udGFpbmVyLmNvbGxhcHNlZCBzZXBhcmF0b3IgewogICAgZGlzcGxheTogbm9uZTsKfQpAbWVkaWEgKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKSB7CiAgICBib25kdGFibGUtY29udGFpbmVyIHsKICAgICAgICBib3JkZXItY29sb3I6ICM3ZDdkN2Q7CiAgICB9Cn0KPC9zdHlsZT4KCgkKPHNjcmlwdD4KCWNvbnN0IGNlbGwgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3BsdXRvLWNlbGwnKQoJY2VsbC50b2dnbGVBdHRyaWJ1dGUoJ2Fsd2F5cy1zaG93LW91dHB1dCcsIHRydWUpCgoJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCWNlbGwudG9nZ2xlQXR0cmlidXRlKCdhbHdheXMtc2hvdy1vdXRwdXQnLCBmYWxzZSkKCX0pCjwvc2NyaXB0PgqkbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAkTALSwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzgFXH8i1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2aKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52mvMPGJvbmQgZGVmPSJhc2QiIHVuaXF1ZV9pZD0ibHN5amJmcG9waGN6Ij48c3RydWN0LWJvbmQgY2xhc3M9J0FTRCc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGNsYXNzPSdjb2xsYXBzaWJsZSc+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgogICAgICAgIDxzcGFuIGNsYXNzPSdjb2xsYXBzZS1idG4nPjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPkFTRDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbWNueW94ZHl0dScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na3hrbXlpY2dqbicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5NYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIDxzcGFuIGNsYXNzPSJ0ZXgiPiRMYVRlWCQ8L3NwYW4+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nc2tiaGR4d2lodycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdza2JoZHh3aWh3Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAic2tiaGR4d2lodyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na3hrbXlpY2dqbicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxzcGFuPkZpZWxkIHdpdGggPGI+SFRNTDwvYj4gZGVzY3JpcHRpb248L3NwYW4+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2InPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2ltbnlsbGJnY2YnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzY3JpcHQ+CgkJCS8vIHdlaXJkIGltcG9ydCB0byBtYWtlIGl0IGZhc3Rlci4gVGhlIGBhd2FpdCBpbXBvcnRgIGNhbiBzdGlsbCBkZWxheSBleGVjdXRpb24gYnkgb25lIGZyYW1lIGlmIGl0IGlzIGFscmVhZHkgbG9hZGVkLi4uCgkJCXdpbmRvdy5kM2Zvcm1hdCA9IHdpbmRvdy5kM2Zvcm1hdCA/PyBhd2FpdCBpbXBvcnQoImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZDMtZm9ybWF0QDIvK2VzbSIpCgoJCQljb25zdCBhcmdtaW4gPSB4cyA9PiB4cy5pbmRleE9mKE1hdGgubWluKC4uLnhzKSkKCQkJY29uc3QgY2xvc2VzdF9pbmRleCA9ICh4cywgeSkgPT4gYXJnbWluKHhzLm1hcCh4ID0+IE1hdGguYWJzKHgteSkpKQoKCQkJY29uc3QgdmFsdWVzID0gWzEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwXQoKCQkJY29uc3QgZWwgPSBodG1sYAoJCQk8c3BhbiB0aXRsZT0iQ2xpY2sgYW5kIGRyYWcgdGhpcyBudW1iZXIgbGVmdCBvciByaWdodCEiIHN0eWxlPSJjdXJzb3I6IGNvbC1yZXNpemU7CgkJCXRvdWNoLWFjdGlvbjogbm9uZTsKCQkJYmFja2dyb3VuZDogcmdiKDI1MiwgMjA5LCAyMDQpOwoJCQljb2xvcjogYmxhY2s7CgkJCXBhZGRpbmc6IDBlbSAuMmVtOwoJCQlib3JkZXItcmFkaXVzOiAuM2VtOwoJCQlmb250LXdlaWdodDogYm9sZDsKCQkJZm9udC1mYW1pbHk6IHN5c3RlbS11aSwgc2Fucy1zZXJpZjsKICAgIAkJZm9udC12YXJpYW50LW51bWVyaWM6IHRhYnVsYXItbnVtczsKCQkJIj42PC9zcGFuPgoJCQlgCgoKCgkJCWxldCBvbGRfeCA9IDAKCQkJbGV0IG9sZF9pbmRleCA9IDAKCQkJY29uc3QgaW5pdGlhbF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCA2KQoJCQlsZXQgY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCgkJCWNvbnN0IGZvcm1hdHRlciA9IHMgPT4gIiIgKyBkM2Zvcm1hdC5mb3JtYXQoIiIpKHMpICsgIiIKCgoJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoZWwsICd2YWx1ZScsIHsKCQkJCWdldDogKCkgPT4gdmFsdWVzW2N1cnJlbnRfaW5kZXhdLAoJCQkJc2V0OiB4ID0+IHsKCQkJCQljdXJyZW50X2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIHgpCgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJfSwKCQkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQkJfSk7CgoJCQkvLyBpbml0aWFsIHZhbHVlCgkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcig2KQoKCQkJY29uc3Qgb25TY3J1YiA9IChlKSA9PiB7CgkJCQljb25zdCBvZmZzZXQgPSBlLmNsaWVudFggLSBvbGRfeAoJCQkJY29uc3QgbmV3X2luZGV4ID0gTWF0aC5taW4odmFsdWVzLmxlbmd0aC0xLCBNYXRoLm1heCgwLCAKCQkJCQlNYXRoLnJvdW5kKG9mZnNldC8xMCkgKyBvbGRfaW5kZXgKCQkJCSkpCgoJCQkJaWYobmV3X2luZGV4ICE9PSBjdXJyZW50X2luZGV4KSB7CgkJCQkJY3VycmVudF9pbmRleCA9IG5ld19pbmRleAoJCQkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQkJCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCQkJCX0KCQkJfQoKCQkJY29uc3Qgb25wb2ludGVyZG93biA9IChlKSA9PiB7CgkJCQl3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkoKQoJCQkJb2xkX3ggPSBlLmNsaWVudFgKCQkJCW9sZF9pbmRleCA9IGN1cnJlbnRfaW5kZXgKCQkJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCgkJCX0KCQkJZWwuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoKCQkJY29uc3Qgb25kYmxjbGljayA9IChlKSA9PiB7CgkJCQljdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgkJCX0KCQkJZWwuYWRkRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoKCQkJY29uc3Qgb25wb2ludGVydXAgPSAoKSA9PiB7CgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQoJCQl9CgkJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCgkJCWVsLm9uc2VsZWN0c3RhcnQgPSAoKSA9PiBmYWxzZQoKCQkJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCQkJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcmRvd24iLCBvbnBvaW50ZXJkb3duKQoJCQkJZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZGJsY2xpY2siLCBvbmRibGNsaWNrKQoJCQkJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoJCQl9KQoKCQkJcmV0dXJuIGVsCgoJCQk8L3NjcmlwdD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdpbW55bGxiZ2NmJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaW1ueWxsYmdjZiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na3hrbXlpY2dqbicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYycgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgY2AiPk5vcm1hbCBTdHJpbmcgRGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nY2VzZGJmY3Jhbycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2Nlc2RiZmNyYW8nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJjZXNkYmZjcmFvIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdkJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdkJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBkYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPlRoaXMgZmllbGQgaXMgPGVtPnNwZWNpYWw8L2VtPjwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2QnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2ZzYnN6bW1vbGInIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSd0ZXh0JyB2YWx1ZT0nJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdmc2Jzem1tb2xiJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZnNic3ptbW9sYiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na3hrbXlpY2dqbicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nZSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nZScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgZWAiPmU8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZWdhdXlvd2tiaycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nNicgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2VnYXV5b3drYmsnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJlZ2F1eW93a2JrIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0na3hrbXlpY2dqbic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImt4a215aWNnam4iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIEFTRCIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0nbWNueW94ZHl0dSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm1jbnlveGR5dHUiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J2p4ZmZjenhpbXYnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdyZ2Fldnl3ZXh3Jz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAgSunywcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lzhfmKfm1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NziKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5haZwcmVmaXijQVNEqGVsZW1lbnRzlZKhYZKhMap0ZXh0L3BsYWlukqFikqE2qnRleHQvcGxhaW6SoWOSoiIiqnRleHQvcGxhaW6SoWSSoiIiqnRleHQvcGxhaW6SoWWSojIwqnRleHQvcGxhaW6kdHlwZaZzdHJ1Y3SscHJlZml4X3Nob3J0o0FTRKhvYmplY3RpZLAzMDBjOGZmOTNmNGEyNDE1pG1pbWXZIWFwcGxpY2F0aW9uL3ZuZC5wbHV0by50cmVlK29iamVjdKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACT41brBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMDNlOWQ3NWUtZTZjOS00MTk5LTkzM2ItMmJlMzA2ZGFmOTc4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWVJtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkMDY1YmFkNzMtNWZhOC00NDk2LWJhMzMtOWU2Njk0MGI1ODA2iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keYWmcHJlZml4o0xPTKhlbGVtZW50c5KSoWGSoTGqdGV4dC9wbGFpbpKhYpKhNqp0ZXh0L3BsYWlupHR5cGWmc3RydWN0rHByZWZpeF9zaG9ydKNMT0yob2JqZWN0aWSwZDc3MDUwNzI3OTdmNGVkMaRtaW1l2SFhcHBsaWNhdGlvbi92bmQucGx1dG8udHJlZStvYmplY3Sscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAkFmTGwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNrlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lJLVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmmMi4wZTEwpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACT5EdLBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMzuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWU+tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkYTg5OTUyMjQtODNjNi00ZjgyLWI1YTUtODdhNmY4NmZjN2EwiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoB0zxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5HZW5lcmF0aW5nIGF1dG9tYXRpYyB3aWRnZXRzIGZvciBjdXN0b20gc3RydWN0cyBpcyBxdWl0ZSBzdHJhaWdodGZvcndhcmQgd2l0aCB0aGUgYWlkIG9mIHRoZSA8Y29kZT5AZmllbGRkYXRhPC9jb2RlPiBtYWNybyBhbmQgdGhlIDxjb2RlPlN0cnVjdEJvbmQ8L2NvZGU+IHR5cGUuPC9wPgo8cD5UaGUgdG9wLWxlZnQgYXJyb3cgY2FuIGJlIHVzZWQgdG8gc2hvdy1oaWRlIHRoZSBmaWVsZCBlbGVtZW50cyAmIzQwO3VzZWZ1bCBpbnNpZGUgYSA8Y29kZT5Cb25kVGFibGU8L2NvZGU+LCBzaG93biBiZWxvdyYjNDE7LCB3aGlsZSB0aGUgZ3JlZW4gdG9nZ2xlIG9uIHRoZSB0b3AtcmlnaHQgY2FuIGJlIHVzZWQgdG8gZGlzYWJsZSB0ZW1wb3JhcmlseSB0aGUgc3luY2ggYmV0d2VlbiB0aGUgSlMgd2lkZ2V0cyBhbmQgdGhlIGJvbmQgdmFsdWVzIGluIFBsdXRvLjwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2L1/d3sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTC5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABTQJtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkY2Y4MDdjYjMtNWQ3NS00MDQwLWJmZDEtMDVmZTcwZDI2ZTg5iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoyijxzdHJ1Y3QtYm9uZCBjbGFzcz0nTmFtZWRUdXBsZXsoU3ltYm9sKCZxdW90OyMjMjM5OCZxdW90OyksIDphKX0nPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBjbGFzcz0nY29sbGFwc2libGUnPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KICAgICAgICA8c3BhbiBjbGFzcz0nY29sbGFwc2UtYnRuJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz48c3Bhbj5IVE1MIERlc2NyaXB0aW9uPC9zcGFuPjwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0neXdraHFwY21icCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ncG55eW1tcXdyeicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPmE8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndWJseGx3eHNuZycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd1Ymx4bHd4c25nJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidWJseGx3eHNuZyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J3BueXltbXF3cnonPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJwbnl5bW1xd3J6Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQo8c2NyaXB0PgoJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCglkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBOYW1lZFR1cGxlIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSd5d2tocXBjbWJwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAieXdraHFwY21icCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0naXh0cGNvZXFqbCc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JkcXFvbGltZ2EnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZbh0dXBsZV9kZXNjcmlwdGlvbl9udGJvbmSybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAIrPRBsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRjZjgwN2NiMy01ZDc1LTQwNDAtYmZkMS0wNWZlNzBkMjZlODm5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4Pr/E3tXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEyiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedlUPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxoMiBpZD0iRGVmYXVsdC1UeXBlLVdpZGdldHMiPkRlZmF1bHQgVHlwZSBXaWRnZXRzPC9oMj4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2MqB3isHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SRmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTK5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4AA+fatXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOWQ0NDU1YWYtOTZmMS00NmQ3LWE0ZjMtNDM0NDk1YjExYzhhiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedk8PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxoMSBpZD0iUGFja2FnZXMiPlBhY2thZ2VzPC9oMT4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2LsiAIsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGG5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABT8DtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNzliZWJhODgtOTMyZi00MTQ3LWIzYTAtZDgyMWVmMWJjMWUyiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedoDmDxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5UaGUgc3RydWN0dXJlcyBhYm92ZSBjYW4gYWxzbyBiZSB1c2VkIG5lc3RlZCB3aXRoaW4gb25lIGFub3RoZXIuIFRvIGZhY2lsaXRhdGUgYWNjZXNzaW5nIG5lc3RlZCBzdHJ1Y3R1cmVzLCBvbmUgY2FuIHVzZSB0aGUgPGNvZGU+UG9wb3V0PC9jb2RlPiB0eXBlLjwvcD4KPHA+SW4gaXRzIHNpbXBsZSBmb3JtLCB5b3UgY2FuIGdpdmUgYW4gaW5zdGFuY2Ugb2YgYSBTdHJ1Y3RCb25kLCBhIGJvbmQgd3JhcHBpbmcgYSBTdHJ1Y3RCb25kIG9yIGEgQm9uZHNMaXN0IGFzIGlucHV0IHRvIFBvcG91dCB0byBjcmVhdGUgYSB0YWJsZSB0aGF0IGlzIGhpZGRlbiBiZWhpbmQgYSBwb3B1cCB3aW5kb3cuIElmIGFuIGluc3RhbmNlIHByZXNlbnQsIGJ1dCB5b3Ugd2FudCBhIGN1c3RvbSB0eXBlIGZvciB3aGljaCB5b3UgaGF2ZSBkZWZpbmVkIGN1c3RvbSBib25kcyBhbmQgZGVzY3JpcHRpb25zIHdpdGggPGNvZGU+QGZpZWxkZGF0YTwvY29kZT4gdG8gYXBwZWFyIGFzIHBvcG91dCwgeW91IGNhbiB1c2UgdGhlIGZ1bmN0aW9uIDxjb2RlPnBvcG91dHdyYXAmIzQwO1RZUEUmIzQxOzwvY29kZT4gdG8gZ2VuZXJhdGUgYSBzbWFsbCBpY29uIHdoaWNoIGhpZGVzIGEgcG9wdXAgY29udGFpbmluZyB0aGUgPGNvZGU+U3RydWN0Qm9uZDwvY29kZT4gb2YgdGhlIHByb3ZpZGVkIHR5cGUgPGNvZGU+VFlQRTwvY29kZT4uPC9wPgo8cD5UaGUgU3RydWN0Qm9uZCB0YWJsZSBhcHBlYXJzIG9uIGhvdmVyIHVwb24gdGhlIGljb24sIGNhbiBiZSBtYWRlIGZpeGVkIGJ5IGNsaWNraW5nIG9uIHRoZSBpY29uIGFuZCBjYW4gdGhlbiBiZSBtb3ZlZCBhcm91bmQgb3IgcmVzaXplZC4gQSBkb3VibGUgY2xpY2sgb24gdGhlIGhlYWRlciBvZiB0aGUgcG9wb3V0IGhpZGVzIGl0IGFnYWluOjwvcD4KPC9kaXY+pG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNY2OCaicsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTK5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4ABV3QtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhmiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keaCkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNZKtzx2XsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGa5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4FpU3utXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ4iqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedqALDxib25kIGRlZj0iYm9oIiB1bmlxdWVfaWQ9ImNubWh3bXZrbGV2eCI+PHN0cnVjdC1ib25kIGNsYXNzPSdCT0gnPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBjbGFzcz0nY29sbGFwc2libGUnPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KICAgICAgICA8c3BhbiBjbGFzcz0nY29sbGFwc2UtYnRuJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5CT0g8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2Vkb3Bqcmllc2YnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3FxcHBzZ3B3cWgnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J21haCc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nbWFoJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBtYWhgIj5tYWg8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nbWFoJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdpdnZ3ZHJldW93JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cG9wb3V0LWNvbnRhaW5lciBrZXk9J2hnYXFkcXNvcm0nPgoJPHBvcG91dC1oZWFkZXI+PHNwYW4gY2xhc3M9J3BvcG91dC1pY29uIHBvcG91dCc+PC9zcGFuPjwvcG9wb3V0LWhlYWRlcj4KCTxwb3BvdXQtY29udGVudHM+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZ2dja3Nic3BvZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHN0cnVjdC1ib25kIGNsYXNzPSdNYWluLnZhciZxdW90O3dvcmtzcGFjZSM0NjMmcXVvdDsuTUFIJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TUFIPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSducWpwY2NkcG1qJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdnbHB4eHlxem9lJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+YTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdrb3R5Y2VuZXJkJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2tvdHljZW5lcmQnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJrb3R5Y2VuZXJkIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nZ2xweHh5cXpvZSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImdscHh4eXF6b2UiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE1BSCIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0nbnFqcGNjZHBtaic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm5xanBjY2RwbWoiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J3J6am16bXpqcmYnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdhemV3b3Foa3djJz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0naGdhcWRxc29ybSc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb21AMS43LjQnKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewogICAgICAgIC8vIERlYWwgd2l0aCBzY3JvbGxpbmcKICAgICAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJykgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQKCgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFsKICAgICAgICAgICAgICAgIGF1dG9QbGFjZW1lbnQoKSwKICAgICAgICAgICAgXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSAtIHNjcm9sbFRvcCArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgkvLyBDcmVhdGUgYSByZXVzYWJsZSBkZWJvdW5jZWQgY2xhc3MgcmVtb3ZhbCBmdW5jdGlvbgoJY29uc3QgY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyID0gKGNvbnRhaW5lciwgY2xhc3NOYW1lLCBkZWxheSkgPT4gewoJCXJldHVybiBfLmRlYm91bmNlKCgpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCBmYWxzZSkKCQl9LCBkZWxheSkKCX0KCgljb25zdCBkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyID0gY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyKGNvbnRhaW5lciwgJ2NvbnRlbnRzLWhvdmVyJywgMzAwKQoJY29uc3QgZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnaGVhZGVyLWhvdmVyJywgMzAwKQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCQlkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyLmNhbmNlbCgpCgl9Cgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIoKQoJfQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyLmNhbmNlbCgpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IHsKCQlkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlcigpCgl9Cjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdnZ2Nrc2JzcG9mJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZ2dja3Nic3BvZiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2l2dndkcmV1b3cnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJpdnZ3ZHJldW93Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0ncXFwcHNncHdxaCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInFxcHBzZ3B3cWgiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIEJPSCIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0nZWRvcGpyaWVzZic+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVkb3Bqcmllc2YiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J2J0cXpwaWlzZnknPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KCgk8c2NyaXB0IGlkPSdpY3Zoanhkb2p3Jz4KCQkKCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCB3aWRnZXQgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQoJCS8vIE92ZXJ3cml0ZSB0aGUgZGVzY3JpcHRpb24KCQljb25zdCBkZXNjID0gd2lkZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCgkKCQkvLyBTZXQtR2V0IGJvbmQKCQoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBnZXRfaW5wdXRfdmFsdWUod2lkZ2V0KSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlzZXRfaW5wdXRfdmFsdWUod2lkZ2V0LCBuZXd2YWwpCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCQoJCWNvbnN0IG9sZF9vbmlucHV0ID0gd2lkZ2V0Lm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQl3aWRnZXQub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCTwvc2NyaXB0PgoJPHN0eWxlPgoJCS8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCgkJc3RydWN0LWJvbmQgewogIAkJCWZsZXg6IDE7CgkJfQoJPC9zdHlsZT4KCTwvc3RydWN0LWJvbmQ+CjwvYm9uZD6kbWltZal0ZXh0L2h0bWyscm9vdGFzc2lnbmVlwLJsYXN0X3J1bl90aW1lc3RhbXDLQdo2QAhDgAqwcGVyc2lzdF9qc19zdGF0ZcK3aGFzX3BsdXRvX2hvb2tfZmVhdHVyZXPCp2NlbGxfaWTZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOLlkZXBlbmRzX29uX2Rpc2FibGVkX2NlbGxzwqdydW50aW1lziVFUN61cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQxZDU1NzNlZS04NzJlLTRkZmItYTc4NS0xYWM5ZTgzNmFkOTiKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R5oTKkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAIcDw6sHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQxZDU1NzNlZS04NzJlLTRkZmItYTc4NS0xYWM5ZTgzNmFkOTi5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZS21cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDWKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52T48ZGl2IGNsYXNzPSJtYXJrZG93biI+PGgxIGlkPSJCb25kVGFibGUiPkJvbmRUYWJsZTwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWNjjeL/LBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAANPH7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNYqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnbAAHIhjxib25kc2xpc3QtY29udGFpbmVyIGNsYXNzPSduby1wb3BvdXQnPgoJPGJvbmRzbGlzdC1oZWFkZXI+CgkJPHNwYW4gY2xhc3M9J2NvbGxhcHNlIGJvbmRzbGlzdC1pY29uJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJyB0aXRsZT0iVGhpcyBsaXN0IGNvbnRhaW5zIGluZGVwZW5kZW50IGJvbmRzIj5Qb3BvdXQgQ29udGFpbmVyPC9zcGFuPgoJCTxzcGFuIGNsYXNzPSd0b2dnbGUgYm9uZHNsaXN0LWljb24nPjwvc3Bhbj4KCTwvYm9uZHNsaXN0LWhlYWRlcj4KCTxib25kc2xpc3QtY29udGVudHM+Cgk8Ym9uZC13aXRoLWRlc2NyaXB0aW9uPgoJPGJvbmQtZGVzY3JpcHRpb24gdGl0bGU9J1RoaXMgYm9uZCBpcyBhc3NpZ25lZCB0byB2YXJpYWJsZSBgYXNkYCc+CgkJU3RydWN0dXJlIEFTRAoJPC9ib25kLWRlc2NyaXB0aW9uPgoJPGJvbmQtdmFsdWU+CgkJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSdzZ3lsbGJrbWtlJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2Z5aWJxc3lmdXInIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxib25kIGRlZj0iYXNkIiB1bmlxdWVfaWQ9ImxzeWpiZnBvcGhjeiI+PHN0cnVjdC1ib25kIGNsYXNzPSdNYWluLnZhciZxdW90O3dvcmtzcGFjZSM0NjMmcXVvdDsuQVNEJz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+QVNEPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdtY255b3hkeXR1JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+PGRpdiBjbGFzcz0ibWFya2Rvd24iPjxwPk1hcmtkb3duIGRlc2NyaXB0aW9uLCBpbmNsdWRpbmcgPHNwYW4gY2xhc3M9InRleCI+JExhVGVYJDwvc3Bhbj48L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdhJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdza2JoZHh3aWh3JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3NrYmhkeHdpaHcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJza2JoZHh3aWh3Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdiJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdiJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBiYCI+PHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYic+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0naW1ueWxsYmdjZicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNjcmlwdD4KCQkJLy8gd2VpcmQgaW1wb3J0IHRvIG1ha2UgaXQgZmFzdGVyLiBUaGUgYGF3YWl0IGltcG9ydGAgY2FuIHN0aWxsIGRlbGF5IGV4ZWN1dGlvbiBieSBvbmUgZnJhbWUgaWYgaXQgaXMgYWxyZWFkeSBsb2FkZWQuLi4KCQkJd2luZG93LmQzZm9ybWF0ID0gd2luZG93LmQzZm9ybWF0ID8/IGF3YWl0IGltcG9ydCgiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JtYXRAMi8rZXNtIikKCgkJCWNvbnN0IGFyZ21pbiA9IHhzID0+IHhzLmluZGV4T2YoTWF0aC5taW4oLi4ueHMpKQoJCQljb25zdCBjbG9zZXN0X2luZGV4ID0gKHhzLCB5KSA9PiBhcmdtaW4oeHMubWFwKHggPT4gTWF0aC5hYnMoeC15KSkpCgoJCQljb25zdCB2YWx1ZXMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTBdCgoJCQljb25zdCBlbCA9IGh0bWxgCgkJCTxzcGFuIHRpdGxlPSJDbGljayBhbmQgZHJhZyB0aGlzIG51bWJlciBsZWZ0IG9yIHJpZ2h0ISIgc3R5bGU9ImN1cnNvcjogY29sLXJlc2l6ZTsKCQkJdG91Y2gtYWN0aW9uOiBub25lOwoJCQliYWNrZ3JvdW5kOiByZ2IoMjUyLCAyMDksIDIwNCk7CgkJCWNvbG9yOiBibGFjazsKCQkJcGFkZGluZzogMGVtIC4yZW07CgkJCWJvcmRlci1yYWRpdXM6IC4zZW07CgkJCWZvbnQtd2VpZ2h0OiBib2xkOwoJCQlmb250LWZhbWlseTogc3lzdGVtLXVpLCBzYW5zLXNlcmlmOwogICAgCQlmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwoJCQkiPjY8L3NwYW4+CgkJCWAKCgoKCQkJbGV0IG9sZF94ID0gMAoJCQlsZXQgb2xkX2luZGV4ID0gMAoJCQljb25zdCBpbml0aWFsX2luZGV4ID0gY2xvc2VzdF9pbmRleCh2YWx1ZXMsIDYpCgkJCWxldCBjdXJyZW50X2luZGV4ID0gaW5pdGlhbF9pbmRleAoKCQkJY29uc3QgZm9ybWF0dGVyID0gcyA9PiAiIiArIGQzZm9ybWF0LmZvcm1hdCgiIikocykgKyAiIgoKCgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlbCwgJ3ZhbHVlJywgewoJCQkJZ2V0OiAoKSA9PiB2YWx1ZXNbY3VycmVudF9pbmRleF0sCgkJCQlzZXQ6IHggPT4gewoJCQkJCWN1cnJlbnRfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgeCkKCQkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQl9LAoJCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCQl9KTsKCgkJCS8vIGluaXRpYWwgdmFsdWUKCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKDYpCgoJCQljb25zdCBvblNjcnViID0gKGUpID0+IHsKCQkJCWNvbnN0IG9mZnNldCA9IGUuY2xpZW50WCAtIG9sZF94CgkJCQljb25zdCBuZXdfaW5kZXggPSBNYXRoLm1pbih2YWx1ZXMubGVuZ3RoLTEsIE1hdGgubWF4KDAsIAoJCQkJCU1hdGgucm91bmQob2Zmc2V0LzEwKSArIG9sZF9pbmRleAoJCQkJKSkKCgkJCQlpZihuZXdfaW5kZXggIT09IGN1cnJlbnRfaW5kZXgpIHsKCQkJCQljdXJyZW50X2luZGV4ID0gbmV3X2luZGV4CgkJCQkJZWwuaW5uZXJUZXh0ID0gZm9ybWF0dGVyKGVsLnZhbHVlKQoJCQkJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJCQkJfQoJCQl9CgoJCQljb25zdCBvbnBvaW50ZXJkb3duID0gKGUpID0+IHsKCQkJCXdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpCgkJCQlvbGRfeCA9IGUuY2xpZW50WAoJCQkJb2xkX2luZGV4ID0gY3VycmVudF9pbmRleAoJCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgoJCQljb25zdCBvbmRibGNsaWNrID0gKGUpID0+IHsKCQkJCWN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQllbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKCQkJfQoJCQllbC5hZGRFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgoJCQljb25zdCBvbnBvaW50ZXJ1cCA9ICgpID0+IHsKCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVybW92ZSIsIG9uU2NydWIpCgkJCX0KCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJ1cCIsIG9ucG9pbnRlcnVwKQoKCQkJZWwub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlCgoJCQlpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7CgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVyZG93biIsIG9ucG9pbnRlcmRvd24pCgkJCQllbC5yZW1vdmVFdmVudExpc3RlbmVyKCJkYmxjbGljayIsIG9uZGJsY2xpY2spCgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgkJCX0pCgoJCQlyZXR1cm4gZWwKCgkJCTwvc2NyaXB0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ltbnlsbGJnY2YnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJpbW55bGxiZ2NmIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+Tm9ybWFsIFN0cmluZyBEZXNjcmlwdGlvbjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdjZXNkYmZjcmFvJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ndGV4dCcgdmFsdWU9Jyc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nY2VzZGJmY3Jhbyc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImNlc2RiZmNyYW8iCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2t4a215aWNnam4nIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2QnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2QnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGRgIj48ZGl2IGNsYXNzPSJtYXJrZG93biI+PHA+VGhpcyBmaWVsZCBpcyA8ZW0+c3BlY2lhbDwvZW0+PC9wPgo8L2Rpdj48L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nZCc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nZnNic3ptbW9sYicgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3RleHQnIHZhbHVlPScnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2ZzYnN6bW1vbGInPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJmc2Jzem1tb2xiIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSdreGtteWljZ2puJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdlJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdlJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBlYCI+ZTwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdlJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdlZ2F1eW93a2JrJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PSc2JyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0nZWdhdXlvd2tiayc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImVnYXV5b3drYmsiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdreGtteWljZ2puJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAia3hrbXlpY2dqbiIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgQVNEIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdtY255b3hkeXR1Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibWNueW94ZHl0dSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0nanhmZmN6eGltdic+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J3JnYWV2eXdleHcnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0nc2d5bGxia21rZSc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb21AMS43LjQnKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewogICAgICAgIC8vIERlYWwgd2l0aCBzY3JvbGxpbmcKICAgICAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJykgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQKCgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFsKICAgICAgICAgICAgICAgIGF1dG9QbGFjZW1lbnQoKSwKICAgICAgICAgICAgXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSAtIHNjcm9sbFRvcCArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgkvLyBDcmVhdGUgYSByZXVzYWJsZSBkZWJvdW5jZWQgY2xhc3MgcmVtb3ZhbCBmdW5jdGlvbgoJY29uc3QgY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyID0gKGNvbnRhaW5lciwgY2xhc3NOYW1lLCBkZWxheSkgPT4gewoJCXJldHVybiBfLmRlYm91bmNlKCgpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCBmYWxzZSkKCQl9LCBkZWxheSkKCX0KCgljb25zdCBkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyID0gY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyKGNvbnRhaW5lciwgJ2NvbnRlbnRzLWhvdmVyJywgMzAwKQoJY29uc3QgZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnaGVhZGVyLWhvdmVyJywgMzAwKQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCQlkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyLmNhbmNlbCgpCgl9Cgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIoKQoJfQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyLmNhbmNlbCgpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IHsKCQlkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlcigpCgl9Cjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdmeWlicXN5ZnVyJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiZnlpYnFzeWZ1ciIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+Cjxib25kLXdpdGgtZGVzY3JpcHRpb24+Cgk8Ym9uZC1kZXNjcmlwdGlvbiB0aXRsZT0nVGhpcyBib25kIGlzIGFzc2lnbmVkIHRvIHZhcmlhYmxlIGBudGAnPgoJCU5hbWVkVHVwbGUKCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwb3BvdXQtY29udGFpbmVyIGtleT0nbXZmd3FsdGl4eSc+Cgk8cG9wb3V0LWhlYWRlcj48c3BhbiBjbGFzcz0ncG9wb3V0LWljb24gcG9wb3V0Jz48L3NwYW4+PC9wb3BvdXQtaGVhZGVyPgoJPHBvcG91dC1jb250ZW50cz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdheHF5YXZ3aWZsJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48Ym9uZCBkZWY9Im50IiB1bmlxdWVfaWQ9InhuY2NqaWFpdXZxeCI+PHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDAxJnF1b3Q7KSwgOmEsIDpiLCA6Yyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+TXkgRmFuY3kgTlR1cGxlPC9zcGFuPgoJCTxpbnB1dCB0eXBlPSdjaGVja2JveCcgY2xhc3M9J3RvZ2dsZScgY2hlY2tlZD4KCTwvdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgoJPHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8cGwtY29tYmluZWQtY2hpbGQga2V5PSdhdXN1emdpbGZ5JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdhJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdhJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhYCI+RGVzY3JpcHRpb248L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0ndGtjYXhpeWtpcCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd0a2NheGl5a2lwJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAidGtjYXhpeWtpcCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nbmV4d2ZubnBocScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYic+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYicgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYmAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD48c3Ryb25nPkJvbGQ8L3N0cm9uZz4gZmllbGQ8L3A+CjwvZGl2PjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd1bWJ3c3FjZG5vJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3VtYndzcWNkbm8nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ1bWJ3c3FjZG5vIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD48cGwtY29tYmluZWQtY2hpbGQga2V5PSduZXh3Zm5ucGhxJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxmaWVsZC1odG1sIGNsYXNzPSdjJz4KCQkJPGZpZWxkLWRlc2NyaXB0aW9uIGNsYXNzPSdjJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBjYCI+YzwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdjJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd4enlkc2J0aGxuJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMCcgdmFsdWU9JzEnPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J3h6eWRzYnRobG4nPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJ4enlkc2J0aGxuIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nbmV4d2ZubnBocSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gIm5leHdmbm5waHEiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE5hbWVkVHVwbGUiKQo8L3NjcmlwdD4KCTxzY3JpcHQgaWQ9J2F1c3V6Z2lsZnknPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJhdXN1emdpbGZ5Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdmdGRkZ3BydXlzJz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCiAgICAgICAgY29uc3QgY29sbGFwc2VfYnRuID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuY29sbGFwc2UtYnRuJykKCiAgICAgICAgcGFyZW50LmNvbGxhcHNlID0gKCkgPT4gewogICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKICAgICAgICB9CgogICAgICAgIGNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHBhcmVudC5jb2xsYXBzZSgpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgZmllbGQtaHRtbCB7CiAgICBkaXNwbGF5OiBjb250ZW50czsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICAvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwogICAgZmxleDogMTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAgZGlzcGxheTogZmxleDsKfQoKLmNvbGxhcHNlLWJ0biB7CiAgICBkaXNwbGF5OiBub25lOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQ+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgd2lkdGg6IDEwMCU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmRlc2NyaXB0aW9uIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBhbGlnbi1zZWxmOiBjZW50ZXIKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIrKiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nZ2RuZmlxd2hteSc+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgo8L2JvbmQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSdtdmZ3cWx0aXh5Jz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbUAxLjcuNCcpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkJLy8gV2UgdXNlIHRoZSBpbnRlcmFjdGpzIGxpYnJhcnkgdG8gcHJvdmlkZSBkcmFnIGFuZCByZXNpemUgaGFuZGxpbmcgYWNyb3NzIGRldmljZXMKCWNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgoJY29udGVudHMub2Zmc2V0ID0gY29udGVudHMub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuZGVzY3JpcHRpb24sIGJvbmRzbGlzdC1oZWFkZXIgLmRlc2NyaXB0aW9uJykpLmRyYWdnYWJsZSh7CgkJbGlzdGVuZXJzOiB7CgkJCXN0YXJ0IChldmVudCkgewoJCQkJY29udGVudHMub2Zmc2V0LnkgPSBzdGFydFBvc2l0aW9uLnkgPSBjb250ZW50cy5vZmZzZXRUb3AKCQkJCWNvbnRlbnRzLm9mZnNldC54ID0gc3RhcnRQb3NpdGlvbi54ID0gY29udGVudHMub2Zmc2V0TGVmdAoJCQl9LAoJCQltb3ZlIChldmVudCkgewoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGVudHMub2Zmc2V0LnkgKz0gZXZlbnQuZHkKCQkKCQkgICAgICBjb250ZW50cy5zdHlsZS50b3AgPSBgbWluKDk1dmgsICR7Y29udGVudHMub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGVudHMuc3R5bGUubGVmdCA9IGBtaW4oOTV2dywgJHtjb250ZW50cy5vZmZzZXQueH1weGAKCQkgICAgfSwKCQl9Cgl9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIGhlYWRlciByZXNldCB0aGUgcG9zaXRpb24KCQljb250YWluZXIucG9wb3V0KCkKCX0pCglpbnRlcmFjdChjb250ZW50cykKCSAgLnJlc2l6YWJsZSh7CgkgICAgZWRnZXM6IHsgdG9wOiB0cnVlLCBsZWZ0OiBmYWxzZSwgYm90dG9tOiB0cnVlLCByaWdodDogdHJ1ZSB9LAoJICAgIGxpc3RlbmVyczogewoJICAgICAgbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7CQkKCSAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudC50YXJnZXQuc3R5bGUsIHsKCSAgICAgICAgICB3aWR0aDogYCR7ZXZlbnQucmVjdC53aWR0aH1weGAsCgkgICAgICAgICAgaGVpZ2h0OiBgJHtldmVudC5yZWN0LmhlaWdodH1weGAsCgkgICAgICAgIH0pCgkgICAgICB9CgkgICAgfQoJICB9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIHJlc2l6ZSByZXNldCB0aGUgd2lkdGgKCQkJY29udGVudHMuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRlbnRzLnN0eWxlLmhlaWdodCA9ICcnCgkgIH0pCgoKCWZ1bmN0aW9uIHBvc2l0aW9uQ29udGVudHMoKSB7CiAgICAgICAgLy8gRGVhbCB3aXRoIHNjcm9sbGluZwogICAgICAgIGNvbnN0IHNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQKICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSBzY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wIHx8IHdpbmRvdy5wYWdlWU9mZnNldAoKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogWwogICAgICAgICAgICAgICAgYXV0b1BsYWNlbWVudCgpLAogICAgICAgICAgICBdLAoJCX0pLnRoZW4oKHBvcykgPT4gewoJCQljb250ZW50cy5zdHlsZS5sZWZ0ID0gcG9zLnggKyAicHgiCgkJCWNvbnRlbnRzLnN0eWxlLnRvcCA9IHBvcy55IC0gc2Nyb2xsVG9wICsgInB4IgoJCX0pCgl9CgoJY29udGFpbmVyLnBvcG91dCA9IChmb3JjZSA9IHVuZGVmaW5lZCkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdwb3BwZWQnLCBmb3JjZSkKCQlwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCgloZWFkZXIub25jbGljayA9IChlKSA9PiB7Y29udGFpbmVyLnBvcG91dCgpfQoKCS8vIENyZWF0ZSBhIHJldXNhYmxlIGRlYm91bmNlZCBjbGFzcyByZW1vdmFsIGZ1bmN0aW9uCgljb25zdCBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIgPSAoY29udGFpbmVyLCBjbGFzc05hbWUsIGRlbGF5KSA9PiB7CgkJcmV0dXJuIF8uZGVib3VuY2UoKCkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIGZhbHNlKQoJCX0sIGRlbGF5KQoJfQoKCWNvbnN0IGRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnY29udGVudHMtaG92ZXInLCAzMDApCgljb25zdCBkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlciA9IGNyZWF0ZURlYm91bmNlZENsYXNzUmVtb3Zlcihjb250YWluZXIsICdoZWFkZXItaG92ZXInLCAzMDApCgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCB0cnVlKQoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIuY2FuY2VsKCkKCX0KCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiB7CgkJZGVib3VuY2VkUmVtb3ZlQ29udGVudHNIb3ZlcigpCgl9CgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgkJZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIuY2FuY2VsKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyKCkKCX0KPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J2F4cXlhdndpZmwnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJheHF5YXZ3aWZsIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8L2JvbmQtdmFsdWU+Cgk8c3R5bGU+CgkJYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwp9CmJvbmR0YWJsZS1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24sCmJvbmRzbGlzdC1jb250ZW50cyBib25kLXdpdGgtZGVzY3JpcHRpb24gewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmQtdmFsdWUgYm9uZCB7CiAgZGlzcGxheTogZmxleDsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CmJvbmQtdmFsdWUgaW5wdXQgewogIHdpZHRoOiAxMDAlOyAvKiBOZWVkZWQgZm9yIGNvbnNpc3RlbnQgc2l6aW5nICh3aWR0aCkgb2YgdGhlIGlucHV0ICovCn0KCgk8L3N0eWxlPgo8L2JvbmQtd2l0aC1kZXNjcmlwdGlvbj4KPGJvbmQtd2l0aC1kZXNjcmlwdGlvbj4KCTxib25kLWRlc2NyaXB0aW9uIHRpdGxlPSdUaGlzIGJvbmQgaXMgYXNzaWduZWQgdG8gdmFyaWFibGUgYHNic2AnPgoJCVN0cnVjdEJvbmRTZWxlY3QKCTwvYm9uZC1kZXNjcmlwdGlvbj4KCTxib25kLXZhbHVlPgoJCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwb3BvdXQtY29udGFpbmVyIGtleT0naGRmeW56emF5cyc+Cgk8cG9wb3V0LWhlYWRlcj48c3BhbiBjbGFzcz0ncG9wb3V0LWljb24gcG9wb3V0Jz48L3NwYW4+PC9wb3BvdXQtaGVhZGVyPgoJPHBvcG91dC1jb250ZW50cz48cGwtY29tYmluZWQtY2hpbGQga2V5PSdudXZocnhlY3R3JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48Ym9uZCBkZWY9InNicyIgdW5pcXVlX2lkPSJ5bHdyaHl0YWNqbG4iPjx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlIHN0cnVjdGJvbmQtc2VsZWN0Jz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+U3RydWN0Qm9uZFNlbGVjdDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYWpsY3ZleGJnbCcgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHN0cnVjdGJvbmQtc2VsZWN0PgogICAgPHNwYW4gY2xhc3M9InNlbGVjdG9yIj4KICAgICAgICA8c3BhbiBjbGFzcz0iZGVzY3JpcHRpb24iPk9wdGlvbnM6PC9zcGFuPgogICAgICAgIDxzZWxlY3Q+PG9wdGlvbiB2YWx1ZT0ncHVpc2VsZWN0LTEnPmNvcyhhcmcpPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT0ncHVpc2VsZWN0LTInIHNlbGVjdGVkPScnPmF0YW4oeSx4KTwvb3B0aW9uPjwvc2VsZWN0PgogICAgPC9zcGFuPgogICAgPHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA0JnF1b3Q7KSwgOmFyZyl9Jz4KCTx0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIgY2xhc3M9J2NvbGxhcHNpYmxlJz4KCTx0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+CiAgICAgICAgPHNwYW4gY2xhc3M9J2NvbGxhcHNlLWJ0bic+PC9zcGFuPgoJCTxzcGFuIGNsYXNzPSdkZXNjcmlwdGlvbic+Y29zKGFyZyk8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2hmYm9tYm95angnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2J3aXl4aWdsd2MnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2FyZyc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYXJnJyB0aXRsZT0iVGhpcyB2YWx1ZSBpcyBhc3NvY2lhdGVkIHRvIGZpZWxkIGBhcmdgIj5hcmc8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0nYXJnJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd5cWNjemlqcXdhJyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48aW5wdXQgdHlwZT0ncmFuZ2UnIG1pbj0nMScgbWF4PScxMDAnIHZhbHVlPScxJz48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSd5cWNjemlqcXdhJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAieXFjY3ppanF3YSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CjxzY3JpcHQgaWQ9J2J3aXl4aWdsd2MnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJid2l5eGlnbHdjIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KCQo8c2NyaXB0PgoJY29uc3QgdHJjID0gY3VycmVudFNjcmlwdC5jbG9zZXN0KCd0b2dnbGVyZWFjdGl2ZS1jb250YWluZXInKQoJY29uc3QgaGVhZGVyID0gdHJjLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBkZXNjID0gaGVhZGVyLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbicpCglkZXNjLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAiVGhpcyBnZW5lcmF0ZXMgYSBzdHJ1Y3Qgb2YgdHlwZSBOYW1lZFR1cGxlIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdoZmJvbWJveWp4Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiaGZib21ib3lqeCIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0ndGZuZHl4Y2tndCc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2Znc3p0dHVpYXgnPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPHN0cnVjdC1ib25kIGNsYXNzPSdOYW1lZFR1cGxleyhTeW1ib2woJnF1b3Q7IyMyNDA1JnF1b3Q7KSwgOngsIDp5KX0nPgoJPHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lciBjbGFzcz0nY29sbGFwc2libGUnPgoJPHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KICAgICAgICA8c3BhbiBjbGFzcz0nY29sbGFwc2UtYnRuJz48L3NwYW4+CgkJPHNwYW4gY2xhc3M9J2Rlc2NyaXB0aW9uJz5hdGFuKHkseCk8L3NwYW4+CgkJPGlucHV0IHR5cGU9J2NoZWNrYm94JyBjbGFzcz0ndG9nZ2xlJyBjaGVja2VkPgoJPC90b2dnbGVyZWFjdGl2ZS1oZWFkZXI+Cgk8c3BhbiBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz4JCTxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2F5ZWZ5d2Z0emEnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2JmaGpmc2Zvd2UnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J3gnPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J3gnIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYHhgIj54PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J3gnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2N0cGVkZHltcnMnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwMScgdmFsdWU9JzMxJz48c2NyaXB0PgoJCQkJCWNvbnN0IGlucHV0X2VsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJCQkJY29uc3Qgb3V0cHV0X2VsID0gY3VycmVudFNjcmlwdC5uZXh0RWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBkaXNwbGF5cyA9IFsiMC4wIiwgIjAuMSIsICIwLjIiLCAiMC4zIiwgIjAuNCIsICIwLjUiLCAiMC42IiwgIjAuNyIsICIwLjgiLCAiMC45IiwgIjEuMCIsICIxLjEiLCAiMS4yIiwgIjEuMyIsICIxLjQiLCAiMS41IiwgIjEuNiIsICIxLjciLCAiMS44IiwgIjEuOSIsICIyLjAiLCAiMi4xIiwgIjIuMiIsICIyLjMiLCAiMi40IiwgIjIuNSIsICIyLjYiLCAiMi43IiwgIjIuOCIsICIyLjkiLCAiMy4wIiwgIjMuMSIsICIzLjIiLCAiMy4zIiwgIjMuNCIsICIzLjUiLCAiMy42IiwgIjMuNyIsICIzLjgiLCAiMy45IiwgIjQuMCIsICI0LjEiLCAiNC4yIiwgIjQuMyIsICI0LjQiLCAiNC41IiwgIjQuNiIsICI0LjciLCAiNC44IiwgIjQuOSIsICI1LjAiLCAiNS4xIiwgIjUuMiIsICI1LjMiLCAiNS40IiwgIjUuNSIsICI1LjYiLCAiNS43IiwgIjUuOCIsICI1LjkiLCAiNi4wIiwgIjYuMSIsICI2LjIiLCAiNi4zIiwgIjYuNCIsICI2LjUiLCAiNi42IiwgIjYuNyIsICI2LjgiLCAiNi45IiwgIjcuMCIsICI3LjEiLCAiNy4yIiwgIjcuMyIsICI3LjQiLCAiNy41IiwgIjcuNiIsICI3LjciLCAiNy44IiwgIjcuOSIsICI4LjAiLCAiOC4xIiwgIjguMiIsICI4LjMiLCAiOC40IiwgIjguNSIsICI4LjYiLCAiOC43IiwgIjguOCIsICI4LjkiLCAiOS4wIiwgIjkuMSIsICI5LjIiLCAiOS4zIiwgIjkuNCIsICI5LjUiLCAiOS42IiwgIjkuNyIsICI5LjgiLCAiOS45IiwgIjEwLjAiXQoKCQkJCQlsZXQgdXBkYXRlX291dHB1dCA9ICgpID0+IHsKCQkJCQkJb3V0cHV0X2VsLnZhbHVlID0gZGlzcGxheXNbaW5wdXRfZWwudmFsdWVBc051bWJlciAtIDFdCgkJCQkJfQoJCQkJCQoJCQkJCWlucHV0X2VsLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgdXBkYXRlX291dHB1dCkKCQkJCQkvLyBXZSBhbHNvIHBvbGwgZm9yIGNoYW5nZXMgYmVjYXVzZSB0aGUgYGlucHV0X2VsLnZhbHVlYCBjYW4gY2hhbmdlIGZyb20gdGhlIG91dHNpZGUsIGUuZy4gaHR0cHM6Ly9naXRodWIuY29tL0p1bGlhUGx1dG8vUGx1dG9VSS5qbC9pc3N1ZXMvMjc3CgkJCQkJbGV0IGlkID0gc2V0SW50ZXJ2YWwodXBkYXRlX291dHB1dCwgMjAwKQoJCQkJCWludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCQkJCQkJY2xlYXJJbnRlcnZhbChpZCkKCQkJCQkJaW5wdXRfZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCX0pCgkJCQkJPC9zY3JpcHQ+PG91dHB1dCBzdHlsZT0nCgkJCQkJCWZvbnQtZmFtaWx5OiBzeXN0ZW0tdWk7CiAgICAJCQkJCWZvbnQtc2l6ZTogMTVweDsKICAgIAkJCQkJbWFyZ2luLWxlZnQ6IDNweDsKICAgIAkJCQkJdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC00cHgpOwogICAgCQkJCQlkaXNwbGF5OiBpbmxpbmUtYmxvY2s7Jz4zLjA8L291dHB1dD48L3BsLWNvbWJpbmVkLWNoaWxkPjwvZmllbGQtYm9uZD4KCQk8L2ZpZWxkLWh0bWw+CgkJPHN0eWxlPgoJCQlmaWVsZC1odG1sIHsKCQkJCWRpc3BsYXk6IGdyaWQ7CgkJCQlncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKCQkJCWdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKCQkJCWp1c3RpZnktaXRlbXM6IGNlbnRlcjsKCQkJCS8vcGFkZGluZzogMnB4IDVweCAxMHB4IDBweDsKCQkJCWFsaWduLWl0ZW1zOiBjZW50ZXI7CgkJCQlyb3ctZ2FwOiA1cHg7CgkJCX0KCQkJZmllbGQtYm9uZCB7CgkJCQlkaXNwbGF5OiBmbGV4OwoJCQl9CgkJCWZpZWxkLWJvbmQgaW5wdXQgewoJCQkJd2lkdGg6IDEwMCU7CgkJCX0KICAgCQkJZmllbGQtZGVzY3JpcHRpb24gewoJCQkJdGV4dC1hbGlnbjogY2VudGVyOwoJCQl9CgkJPC9zdHlsZT4KCQk8c2NyaXB0IGlkPSdjdHBlZGR5bXJzJz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiY3RwZWRkeW1ycyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYmZoamZzZm93ZScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0neSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0neScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgeWAiPnk8L2ZpZWxkLWRlc2NyaXB0aW9uPgoJCQk8ZmllbGQtYm9uZCBjbGFzcz0neSc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nYmhtc2F0ZWJwdycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PGlucHV0IHR5cGU9J3JhbmdlJyBtaW49JzEnIG1heD0nMTAxJyB2YWx1ZT0nNTEnPjxzY3JpcHQ+CgkJCQkJY29uc3QgaW5wdXRfZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQkJCQljb25zdCBvdXRwdXRfZWwgPSBjdXJyZW50U2NyaXB0Lm5leHRFbGVtZW50U2libGluZwoJCQkJCWNvbnN0IGRpc3BsYXlzID0gWyIwLjAiLCAiMC4xIiwgIjAuMiIsICIwLjMiLCAiMC40IiwgIjAuNSIsICIwLjYiLCAiMC43IiwgIjAuOCIsICIwLjkiLCAiMS4wIiwgIjEuMSIsICIxLjIiLCAiMS4zIiwgIjEuNCIsICIxLjUiLCAiMS42IiwgIjEuNyIsICIxLjgiLCAiMS45IiwgIjIuMCIsICIyLjEiLCAiMi4yIiwgIjIuMyIsICIyLjQiLCAiMi41IiwgIjIuNiIsICIyLjciLCAiMi44IiwgIjIuOSIsICIzLjAiLCAiMy4xIiwgIjMuMiIsICIzLjMiLCAiMy40IiwgIjMuNSIsICIzLjYiLCAiMy43IiwgIjMuOCIsICIzLjkiLCAiNC4wIiwgIjQuMSIsICI0LjIiLCAiNC4zIiwgIjQuNCIsICI0LjUiLCAiNC42IiwgIjQuNyIsICI0LjgiLCAiNC45IiwgIjUuMCIsICI1LjEiLCAiNS4yIiwgIjUuMyIsICI1LjQiLCAiNS41IiwgIjUuNiIsICI1LjciLCAiNS44IiwgIjUuOSIsICI2LjAiLCAiNi4xIiwgIjYuMiIsICI2LjMiLCAiNi40IiwgIjYuNSIsICI2LjYiLCAiNi43IiwgIjYuOCIsICI2LjkiLCAiNy4wIiwgIjcuMSIsICI3LjIiLCAiNy4zIiwgIjcuNCIsICI3LjUiLCAiNy42IiwgIjcuNyIsICI3LjgiLCAiNy45IiwgIjguMCIsICI4LjEiLCAiOC4yIiwgIjguMyIsICI4LjQiLCAiOC41IiwgIjguNiIsICI4LjciLCAiOC44IiwgIjguOSIsICI5LjAiLCAiOS4xIiwgIjkuMiIsICI5LjMiLCAiOS40IiwgIjkuNSIsICI5LjYiLCAiOS43IiwgIjkuOCIsICI5LjkiLCAiMTAuMCJdCgoJCQkJCWxldCB1cGRhdGVfb3V0cHV0ID0gKCkgPT4gewoJCQkJCQlvdXRwdXRfZWwudmFsdWUgPSBkaXNwbGF5c1tpbnB1dF9lbC52YWx1ZUFzTnVtYmVyIC0gMV0KCQkJCQl9CgkJCQkJCgkJCQkJaW5wdXRfZWwuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCB1cGRhdGVfb3V0cHV0KQoJCQkJCS8vIFdlIGFsc28gcG9sbCBmb3IgY2hhbmdlcyBiZWNhdXNlIHRoZSBgaW5wdXRfZWwudmFsdWVgIGNhbiBjaGFuZ2UgZnJvbSB0aGUgb3V0c2lkZSwgZS5nLiBodHRwczovL2dpdGh1Yi5jb20vSnVsaWFQbHV0by9QbHV0b1VJLmpsL2lzc3Vlcy8yNzcKCQkJCQlsZXQgaWQgPSBzZXRJbnRlcnZhbCh1cGRhdGVfb3V0cHV0LCAyMDApCgkJCQkJaW52YWxpZGF0aW9uLnRoZW4oKCkgPT4gewoJCQkJCQljbGVhckludGVydmFsKGlkKQoJCQkJCQlpbnB1dF9lbC5yZW1vdmVFdmVudExpc3RlbmVyKCJpbnB1dCIsIHVwZGF0ZV9vdXRwdXQpCgkJCQkJfSkKCQkJCQk8L3NjcmlwdD48b3V0cHV0IHN0eWxlPScKCQkJCQkJZm9udC1mYW1pbHk6IHN5c3RlbS11aTsKICAgIAkJCQkJZm9udC1zaXplOiAxNXB4OwogICAgCQkJCQltYXJnaW4tbGVmdDogM3B4OwogICAgCQkJCQl0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTRweCk7CiAgICAJCQkJCWRpc3BsYXk6IGlubGluZS1ibG9jazsnPjUuMDwvb3V0cHV0PjwvcGwtY29tYmluZWQtY2hpbGQ+PC9maWVsZC1ib25kPgoJCTwvZmllbGQtaHRtbD4KCQk8c3R5bGU+CgkJCWZpZWxkLWh0bWwgewoJCQkJZGlzcGxheTogZ3JpZDsKCQkJCWdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwoJCQkJZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwoJCQkJanVzdGlmeS1pdGVtczogY2VudGVyOwoJCQkJLy9wYWRkaW5nOiAycHggNXB4IDEwcHggMHB4OwoJCQkJYWxpZ24taXRlbXM6IGNlbnRlcjsKCQkJCXJvdy1nYXA6IDVweDsKCQkJfQoJCQlmaWVsZC1ib25kIHsKCQkJCWRpc3BsYXk6IGZsZXg7CgkJCX0KCQkJZmllbGQtYm9uZCBpbnB1dCB7CgkJCQl3aWR0aDogMTAwJTsKCQkJfQogICAJCQlmaWVsZC1kZXNjcmlwdGlvbiB7CgkJCQl0ZXh0LWFsaWduOiBjZW50ZXI7CgkJCX0KCQk8L3N0eWxlPgoJCTxzY3JpcHQgaWQ9J2JobXNhdGVicHcnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJiaG1zYXRlYnB3Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9wbC1jb21iaW5lZC1jaGlsZD4KPHNjcmlwdCBpZD0nYmZoamZzZm93ZSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImJmaGpmc2Zvd2UiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgoJCjxzY3JpcHQ+Cgljb25zdCB0cmMgPSBjdXJyZW50U2NyaXB0LmNsb3Nlc3QoJ3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcicpCgljb25zdCBoZWFkZXIgPSB0cmMuZmlyc3RFbGVtZW50Q2hpbGQKCWNvbnN0IGRlc2MgPSBoZWFkZXIucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCWRlc2Muc2V0QXR0cmlidXRlKCd0aXRsZScsICJUaGlzIGdlbmVyYXRlcyBhIHN0cnVjdCBvZiB0eXBlIE5hbWVkVHVwbGUiKQo8L3NjcmlwdD4KCTxzY3JpcHQgaWQ9J2F5ZWZ5d2Z0emEnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJheWVmeXdmdHphIgpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+Cgk8c2NyaXB0IGlkPSdwcmh5c3p6YW92Jz4KCQljb25zdCBwYXJlbnQgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKCQljb25zdCBlbCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCWNvbnN0IHRvZ2dsZSA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLnRvZ2dsZScpCiAgICAgICAgY29uc3QgY29sbGFwc2VfYnRuID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuY29sbGFwc2UtYnRuJykKCiAgICAgICAgcGFyZW50LmNvbGxhcHNlID0gKCkgPT4gewogICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJykKICAgICAgICB9CgogICAgICAgIGNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IHBhcmVudC5jb2xsYXBzZSgpCgoJCWNvbnN0IHNldF9pbnB1dF92YWx1ZSA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkJY29uc3QgZ2V0X2lucHV0X3ZhbHVlID0gZ2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCgkJLy8gV2UgdXNlIGNsb25lIHRvIGF2b2lkIHBvaW50aW5nIHRvIHRoZSBzYW1lIGFycmF5CgkJbGV0IHB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgoJCWZ1bmN0aW9uIGRpc3BhdGNoKCkgewoJCQlwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoKCQljb25zdCBvbGRfb25pbnB1dCA9IGVsLm9uaW5wdXQgPz8gZnVuY3Rpb24oZSkge30KCQllbC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJaWYgKHRvZ2dsZS5jaGVja2VkKSB7ZGlzcGF0Y2goKX0KCQl9CgoJCXRvZ2dsZS5vbmlucHV0ID0gZSA9PiB7CgkJCWlmICh0b2dnbGUuY2hlY2tlZCAmJiAhXy5pc0VxdWFsKGdldF9pbnB1dF92YWx1ZShlbCksIHB1YmxpY192YWx1ZSkpIHsKCQkJCWRpc3BhdGNoKCkKCQkJfQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJfQoKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gcHVibGljX3ZhbHVlLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXB1YmxpY192YWx1ZSA9IG5ld3ZhbAoJCQkJCgkJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbCkKCQkJCXRvZ2dsZS5jaGVja2VkID0gdHJ1ZQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7Cgk8L3NjcmlwdD4KCTxzdHlsZT4KICAgICAgICB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAtLXNpemU6IDE1cHg7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICB3aWR0aDogY2FsYygyKnZhcigtLXNpemUpKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBhcHBlYXJhbmNlOiBub25lOwogICAgYmFja2dyb3VuZDogI2M2YzZjNjsKICAgIG91dGxpbmU6IG5vbmU7CiAgICBib3JkZXItcmFkaXVzOiBjYWxjKHZhcigtLXNpemUpLzIpOwogICAgYm94LXNoYWRvdzogaW5zZXQgMCAwIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICBtYXJnaW46IDAgMTBweDsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZCB7CiAgICBiYWNrZ3JvdW5kOiAjNEJEODY1Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpiZWZvcmUgewogICAgY29udGVudDogJyc7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgdG9wOiAwcHg7CiAgICBsZWZ0OiAwcHg7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgdHJhbnNmb3JtOiBzY2FsZSgxLjEpOwogICAgYm94LXNoYWRvdzogMCBjYWxjKHZhcigtLXNpemUpLzIwKSBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgdHJhbnNpdGlvbjogLjFzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkOmJlZm9yZSB7CiAgICBsZWZ0OiB2YXIoLS1zaXplKQp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgZmllbGQtaHRtbCB7CiAgICBkaXNwbGF5OiBjb250ZW50czsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIHsKICAgIGRpc3BsYXk6IGdyaWQ7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAuNGZyKTsKICAgIGdyaWQtYXV0by1yb3dzOiBmaXQtY29udGVudCg0MHB4KTsKICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICByb3ctZ2FwOiA1cHg7CiAgICAvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwogICAgZmxleDogMTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBncmlkLWNvbHVtbjogMSAvIC0xOwogICAgZGlzcGxheTogZmxleDsKfQoKLmNvbGxhcHNlLWJ0biB7CiAgICBkaXNwbGF5OiBub25lOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgLS1zaXplOiAxN3B4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1kb3duLnN2Zyk7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQ+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5jb2xsYXBzZS1idG4gewogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvY2hldnJvbi1mb3J3YXJkLnN2Zyk7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoOwogICAgd2lkdGg6IDEwMCU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmRlc2NyaXB0aW9uIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGZsZXgtZ3JvdzogMTsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGZvbnQtd2VpZ2h0OiA2MDA7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZSB7CiAgICBhbGlnbi1zZWxmOiBjZW50ZXIKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIrKiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0JCQoJPC9zdHlsZT4KPC90b2dnbGVyZWFjdGl2ZS1jb250YWluZXI+CgoJPHNjcmlwdCBpZD0nem9yemR5cW51aic+CgkJCgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3Qgd2lkZ2V0ID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkKCQkvLyBPdmVyd3JpdGUgdGhlIGRlc2NyaXB0aW9uCgkJY29uc3QgZGVzYyA9IHdpZGdldC5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJCgkJLy8gU2V0LUdldCBib25kCgkKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgkKCQlPYmplY3QuZGVmaW5lUHJvcGVydHkocGFyZW50LCAndmFsdWUnLCB7CgkJCWdldDogKCkgPT4gZ2V0X2lucHV0X3ZhbHVlKHdpZGdldCksCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJc2V0X2lucHV0X3ZhbHVlKHdpZGdldCwgbmV3dmFsKQoJCQl9LAoJCQljb25maWd1cmFibGU6IHRydWUsCgkJfSk7CgkKCQljb25zdCBvbGRfb25pbnB1dCA9IHdpZGdldC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJd2lkZ2V0Lm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQllLnN0b3BQcm9wYWdhdGlvbigpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9Cgk8L3NjcmlwdD4KCTxzdHlsZT4KCQkvKiBUaGUgZmxleCBiZWxvdyBpcyBuZWVkZWQgaW4gc29tZSB3ZWlyZCBjYXNlcyB3aGVyZSB0aGUgYm9uZCBpcyBkaXNwbGF5IGZsZXggYW5kIHRoZSBjaGlsZCBiZWNvbWVzIHNtYWxsLiAqLwoJCXN0cnVjdC1ib25kIHsKICAJCQlmbGV4OiAxOwoJCX0KCTwvc3R5bGU+Cgk8L3N0cnVjdC1ib25kPgoKICAgIDxzY3JpcHQ+CiAgICAgICAgY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KICAgICAgICBjb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwogICAgICAgIAogICAgICAgIC8vIFRoaXMgaXMgdGhlIGVsZW1lbnQgb2YgdGhlIHNlbGVjdCBkcm9wZG93bgogICAgICAgIGNvbnN0IHNlbGVjdCA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCJzZWxlY3QiKQoKICAgICAgICAvLyBUaGlzIHdpbGwgaG9sZCB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHN0cnVjdGJvbmQgZWxlbWVudAogICAgICAgIGxldCBzZWxlY3RlZAoKICAgICAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGdldF9zZWxlY3RfdmFsdWUoKSB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0X2lucHV0X3ZhbHVlKHNlbGVjdCkKICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLnN1YnN0cmluZygxMCkpCiAgICAgICAgfQoKICAgICAgICBjb25zdCBjaGFuZ2Vfc2VsZWN0aW9uID0gKHZhbHVlLCB0cmlnZ2VyX2V2ZW50ID0gdHJ1ZSkgPT4gewogICAgICAgICAgICBzZXRfaW5wdXRfdmFsdWUoc2VsZWN0LCBgcHVpc2VsZWN0LSR7dmFsdWV9YCkKICAgICAgICAgICAgY29uc3QgYm9uZHMgPSBwYXJlbnQucXVlcnlTZWxlY3RvckFsbCgic3RydWN0LWJvbmQiKQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvbmRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoaSAhPSB2YWx1ZSAtIDEpIHsKICAgICAgICAgICAgICAgICAgICBib25kc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRkZW4iLCB0cnVlKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBib25kc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCJoaWRkZW4iLCBmYWxzZSkKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IGJvbmRzW2ldCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRyaWdnZXJfZXZlbnQpIHsKICAgICAgICAgICAgICAgIHVwZGF0ZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNoYW5nZV9zZWxlY3Rpb24oZ2V0X3NlbGVjdF92YWx1ZSgpLCBmYWxzZSkKCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgInZhbHVlIiwgewogICAgICAgICAgICBnZXQ6ICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZ2V0X3NlbGVjdF92YWx1ZSgpCiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldF9pbnB1dF92YWx1ZShzZWxlY3RlZCkKICAgICAgICAgICAgICAgIHJldHVybiBbaW5kZXgsIHZhbHVlXQogICAgICAgICAgICB9LAogICAgICAgICAgICBzZXQ6IChuZXd2YWwpID0+IHsKICAgICAgICAgICAgICAgIGNoYW5nZV9zZWxlY3Rpb24obmV3dmFsWzBdLCBmYWxzZSkKICAgICAgICAgICAgICAgIHNldF9pbnB1dF92YWx1ZShzZWxlY3RlZCwgbmV3dmFsWzFdKQogICAgICAgICAgICB9LAogICAgICAgIH0pCgogICAgICAgIC8vIFdlIGFkZCBhIGxpc3RlbmVyIHRoYXQgZXh0cmFjdCB0aGUgZm9yd2FyZCB0aGUgaW5wdXQgZXZlbnQgaW4gY2FzZSB0aGUgdGFyZ2V0IG9mIHRoZSBldmVudCBpcyB0aGUgc2VsZWN0ZWQgYm9uZAogICAgICAgIGZvciAobGV0IGJvbmQgb2YgcGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInN0cnVjdC1ib25kIikpIHsKICAgICAgICAgICAgYm9uZC5hZGRFdmVudExpc3RlbmVyKCJpbnB1dCIsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgICAgICBpZiAoYm9uZCA9PSBzZWxlY3RlZCkgewogICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfQoKICAgICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCAoZSkgPT4gewogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpCiAgICAgICAgICAgIGNoYW5nZV9zZWxlY3Rpb24oZ2V0X3NlbGVjdF92YWx1ZSgpKQogICAgICAgIH0pCiAgICA8L3NjcmlwdD4KICAgIDxzdHlsZT4KICAgICAgICBzdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1jb250YWluZXI6Zmlyc3Qtb2YtdHlwZS5uby1wb3BvdXQ6YmVmb3JlIHsKICBkaXNwbGF5OiBub25lOwp9CgpzdHJ1Y3Rib25kLXNlbGVjdCA+IHN0cnVjdC1ib25kLmhpZGRlbiB7CiAgZGlzcGxheTogbm9uZTsKfQoKc3RydWN0Ym9uZC1zZWxlY3QsCnN0cnVjdGJvbmQtc2VsZWN0ID4gc3RydWN0LWJvbmQsCnN0cnVjdGJvbmQtc2VsZWN0IHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQoKc3RydWN0Ym9uZC1zZWxlY3QgPiAuc2VsZWN0b3IgLmRlc2NyaXB0aW9uIHsKICBjb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yLCAjNDA0MDQwKTsKfQoKc3RydWN0Ym9uZC1zZWxlY3QgPnN0cnVjdC1ib25kPnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogIGRpc3BsYXk6IG5vbmU7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCB7CiAgICBwYWRkaW5nOiA2cHggMTJweDsKICAgIGJvcmRlcjogMnB4IHNvbGlkICNlN2U3ZTc7CiAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBjb2xvcjogdmFyKC0tcGx1dG8tb3V0cHV0LWNvbG9yLCAjNDA0MDQwKTsKICAgIGZvbnQtZmFtaWx5OiBpbmhlcml0OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgb3V0bGluZTogbm9uZTsKICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjJzOwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgCiAgICAvKiBTaXplIGNvbnN0cmFpbnRzICovCiAgICBtYXgtd2lkdGg6IDUwcHg7IAogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIAogICAgLyogQ3VzdG9tIGFycm93IHN0eWxpbmcgKi8KICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAtbW96LWFwcGVhcmFuY2U6IG5vbmU7CiAgICAvKiBMaWdodCBtb2RlIGFycm93IC0gIzQwNDA0MCAqLwogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCJkYXRhOmltYWdlL3N2Zyt4bWw7Y2hhcnNldD1VVEYtOCwlM2NzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2aWV3Qm94PScwIDAgMjQgMjQnIGZpbGw9J25vbmUnIHN0cm9rZT0nJTIzNDA0MDQwJyBzdHJva2Utd2lkdGg9JzInIHN0cm9rZS1saW5lY2FwPSdyb3VuZCcgc3Ryb2tlLWxpbmVqb2luPSdyb3VuZCclM2UlM2Nwb2x5bGluZSBwb2ludHM9JzYgOSAxMiAxNSAxOCA5JyUzZSUzYy9wb2x5bGluZSUzZSUzYy9zdmclM2UiKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiByaWdodCA4cHggY2VudGVyOwogICAgYmFja2dyb3VuZC1zaXplOiAxNnB4OwogICAgcGFkZGluZy1yaWdodDogMzJweDsKICAgIG1pbi13aWR0aDogMTIwcHg7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdDpob3ZlciB7CiAgICBib3JkZXItY29sb3I6ICNkMGQwZDA7Cn0KCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdDpmb2N1cyB7CiAgICBib3JkZXItY29sb3I6ICNjMGMwYzA7Cn0KCkBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHsKICAgIHN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCB7CiAgICAgICAgYm9yZGVyLWNvbG9yOiAjN2Q3ZDdkOwogICAgICAgIGNvbG9yOiB2YXIoLS1wbHV0by1vdXRwdXQtY29sb3IsICNjNGM0YzQpOwogICAgICAgIC8qIERhcmsgbW9kZSBhcnJvdyAtICNjNGM0YzQgKi8KICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoImRhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PVVURi04LCUzY3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAyNCAyNCcgZmlsbD0nbm9uZScgc3Ryb2tlPSclMjNjNGM0YzQnIHN0cm9rZS13aWR0aD0nMicgc3Ryb2tlLWxpbmVjYXA9J3JvdW5kJyBzdHJva2UtbGluZWpvaW49J3JvdW5kJyUzZSUzY3BvbHlsaW5lIHBvaW50cz0nNiA5IDEyIDE1IDE4IDknJTNlJTNjL3BvbHlsaW5lJTNlJTNjL3N2ZyUzZSIpOwogICAgfQogICAgCiAgICBzdHJ1Y3Rib25kLXNlbGVjdCA+IC5zZWxlY3RvciBzZWxlY3Q6aG92ZXIgewogICAgICAgIGJvcmRlci1jb2xvcjogIzhhOGE4YTsKICAgIH0KICAgIAogICAgc3RydWN0Ym9uZC1zZWxlY3QgPiAuc2VsZWN0b3Igc2VsZWN0OmZvY3VzIHsKICAgICAgICBib3JkZXItY29sb3I6ICM3ZDdkN2Q7CiAgICB9Cn0KCi8qIEFkZCBzdHlsaW5nIGZvciBkcm9wZG93biBvcHRpb25zICovCnN0cnVjdGJvbmQtc2VsZWN0ID4gLnNlbGVjdG9yIHNlbGVjdCBvcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuc3RydWN0Ym9uZC1zZWxlY3QgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyOmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB0b3A6IDFweDsKICBib3R0b206IDBweDsKICBsZWZ0OiAwcHg7CiAgcmlnaHQ6IDBweDsKICB6LWluZGV4OiAtMTsKICBiYWNrZ3JvdW5kOiAjYzhlZGQ1OyAgCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5zdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB6LWluZGV4OiAxMDsKfQoKQG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyaykgewogIHRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5zdHJ1Y3Rib25kLXNlbGVjdCB0b2dnbGVyZWFjdGl2ZS1oZWFkZXI6YmVmb3JlIHsKICAgIGJhY2tncm91bmQ6ICMyNjU4MmU7ICAKICB9Cn0KICAgIDwvc3R5bGU+Cjwvc3RydWN0Ym9uZC1zZWxlY3Q+CjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlVzZSB0aGUgc2VsZWN0b3IgdG8gY2hvb3NlIHdoaWNoIFN0cnVjdEJvbmQgdG8gZGlzcGxheSBhbmQgdXNlLiIpCjwvc2NyaXB0PgoJPHNjcmlwdCBpZD0nYWpsY3ZleGJnbCc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gImFqbGN2ZXhiZ2wiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj4KCTxzY3JpcHQgaWQ9J3Vsd3hra2NkcmMnPgoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IGVsID0gY3VycmVudFNjcmlwdC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nCgkJY29uc3QgdG9nZ2xlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAudG9nZ2xlJykKICAgICAgICBjb25zdCBjb2xsYXBzZV9idG4gPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC5jb2xsYXBzZS1idG4nKQoKICAgICAgICBwYXJlbnQuY29sbGFwc2UgPSAoKSA9PiB7CiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKQogICAgICAgIH0KCiAgICAgICAgY29sbGFwc2VfYnRuLm9uY2xpY2sgPSAoZSkgPT4gcGFyZW50LmNvbGxhcHNlKCkKCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoKCQkvLyBXZSB1c2UgY2xvbmUgdG8gYXZvaWQgcG9pbnRpbmcgdG8gdGhlIHNhbWUgYXJyYXkKCQlsZXQgcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCgkJZnVuY3Rpb24gZGlzcGF0Y2goKSB7CgkJCXB1YmxpY192YWx1ZSA9IF8uY2xvbmVEZWVwKGdldF9pbnB1dF92YWx1ZShlbCkpCgkJCXBhcmVudC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSkKCQl9CgoJCWNvbnN0IG9sZF9vbmlucHV0ID0gZWwub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCQlvbGRfb25pbnB1dChlKQoJCQlpZiAodG9nZ2xlLmNoZWNrZWQpIHtkaXNwYXRjaCgpfQoJCX0KCgkJdG9nZ2xlLm9uaW5wdXQgPSBlID0+IHsKCQkJaWYgKHRvZ2dsZS5jaGVja2VkICYmICFfLmlzRXF1YWwoZ2V0X2lucHV0X3ZhbHVlKGVsKSwgcHVibGljX3ZhbHVlKSkgewoJCQkJZGlzcGF0Y2goKQoJCQl9CgkJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCQl9CgoJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShwYXJlbnQsICd2YWx1ZScsIHsKCQkJZ2V0OiAoKSA9PiBwdWJsaWNfdmFsdWUsCgkJCXNldDogKG5ld3ZhbCkgPT4gewoJCQkJcHVibGljX3ZhbHVlID0gbmV3dmFsCgkJCQkKCQkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsKQoJCQkJdG9nZ2xlLmNoZWNrZWQgPSB0cnVlCgkJCX0sCgkJCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKCQl9KTsKCTwvc2NyaXB0PgoJPHN0eWxlPgogICAgICAgIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIC0tc2l6ZTogMTVweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHdpZHRoOiBjYWxjKDIqdmFyKC0tc2l6ZSkpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiAjYzZjNmM2OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlci1yYWRpdXM6IGNhbGModmFyKC0tc2l6ZSkvMik7CiAgICBib3gtc2hhZG93OiBpbnNldCAwIDAgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIG1hcmdpbjogMCAxMHB4Owp9Cgp0b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LnRvZ2dsZTpjaGVja2VkIHsKICAgIGJhY2tncm91bmQ6ICM0QkQ4NjU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmJlZm9yZSB7CiAgICBjb250ZW50OiAnJzsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGhlaWdodDogdmFyKC0tc2l6ZSk7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICB0b3A6IDBweDsKICAgIGxlZnQ6IDBweDsKICAgIGJhY2tncm91bmQ6ICNmZmY7CiAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7CiAgICBib3gtc2hhZG93OiAwIGNhbGModmFyKC0tc2l6ZSkvMjApIGNhbGModmFyKC0tc2l6ZSkvOCkgcmdiYSgwLCAwLCAwLCAuMik7CiAgICB0cmFuc2l0aW9uOiAuMXM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQ6YmVmb3JlIHsKICAgIGxlZnQ6IHZhcigtLXNpemUpCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSBmaWVsZC1odG1sIHsKICAgIGRpc3BsYXk6IGNvbnRlbnRzOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUgewogICAgZGlzcGxheTogZ3JpZDsKICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIC40ZnIpOwogICAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogICAganVzdGlmeS1pdGVtczogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIHJvdy1nYXA6IDVweDsKICAgIC8qIFRoZSBmbGV4IGJlbG93IGlzIG5lZWRlZCBpbiBzb21lIHdlaXJkIGNhc2VzIHdoZXJlIHRoZSBib25kIGlzIGRpc3BsYXkgZmxleCBhbmQgdGhlIGNoaWxkIGJlY29tZXMgc21hbGwuICovCiAgICBmbGV4OiAxOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgICBkaXNwbGF5OiBmbGV4Owp9CgouY29sbGFwc2UtYnRuIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICAtLXNpemU6IDE3cHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWRvd24uc3ZnKTsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlLmNvbGxhcHNlZD50b2dnbGVyZWFjdGl2ZS1oZWFkZXI+LmNvbGxhcHNlLWJ0biB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jaGV2cm9uLWZvcndhcmQuc3ZnKTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7CiAgICB3aWR0aDogMTAwJTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uZGVzY3JpcHRpb24gewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgZmxleC1ncm93OiAxOwogICAgZm9udC1zaXplOiAxOHB4OwogICAgZm9udC13ZWlnaHQ6IDYwMDsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlIHsKICAgIGFsaWduLXNlbGY6IGNlbnRlcgp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlcisqIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQkJCgk8L3N0eWxlPgo8L3RvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lcj4KPC9ib25kPjwvcGwtY29tYmluZWQtY2hpbGQ+PC9wb3BvdXQtY29udGVudHM+CjwvcG9wb3V0LWNvbnRhaW5lcj4KPHNjcmlwdCBpZD0naGRmeW56emF5cyc+CgkvLyBMb2FkIHRoZSBmbG9hdGluZy11aSBhbmQgaW50ZXJhY3QgbGlicmFyaWVzCgl3aW5kb3cuZmxvYXRpbmdfdWkgPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL0BmbG9hdGluZy11aS9kb21AMS43LjQnKQoKCWNvbnN0IHsgY29tcHV0ZVBvc2l0aW9uLCBhdXRvUGxhY2VtZW50IH0gPSBmbG9hdGluZ191aQoJCgljb25zdCBjb250YWluZXIgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCWNvbnN0IGhlYWRlciA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgY29udGVudHMgPSBjb250YWluZXIubGFzdEVsZW1lbnRDaGlsZAoKCS8vIExvYWQgdGhlIGludGVyYWN0anMgcGFydAoJCS8vIFdlIHVzZSB0aGUgaW50ZXJhY3RqcyBsaWJyYXJ5IHRvIHByb3ZpZGUgZHJhZyBhbmQgcmVzaXplIGhhbmRsaW5nIGFjcm9zcyBkZXZpY2VzCgljb25zdCB7IGRlZmF1bHQ6IGludGVyYWN0IH0gPSBhd2FpdCBpbXBvcnQoJ2h0dHBzOi8vZXNtLnNoL2ludGVyYWN0anMnKQoKCWNvbnRlbnRzLm9mZnNldCA9IGNvbnRlbnRzLm9mZnNldCA/PyB7IHg6IDAsIHk6IDB9Cgljb25zdCBzdGFydFBvc2l0aW9uID0ge3g6IDAsIHk6IDB9CglpbnRlcmFjdChjb250ZW50cy5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmRlc2NyaXB0aW9uLCBib25kc2xpc3QtaGVhZGVyIC5kZXNjcmlwdGlvbicpKS5kcmFnZ2FibGUoewoJCWxpc3RlbmVyczogewoJCQlzdGFydCAoZXZlbnQpIHsKCQkJCWNvbnRlbnRzLm9mZnNldC55ID0gc3RhcnRQb3NpdGlvbi55ID0gY29udGVudHMub2Zmc2V0VG9wCgkJCQljb250ZW50cy5vZmZzZXQueCA9IHN0YXJ0UG9zaXRpb24ueCA9IGNvbnRlbnRzLm9mZnNldExlZnQKCQkJfSwKCQkJbW92ZSAoZXZlbnQpIHsKCQkgICAgICBjb250ZW50cy5vZmZzZXQueCArPSBldmVudC5keAoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC55ICs9IGV2ZW50LmR5CgkJCgkJICAgICAgY29udGVudHMuc3R5bGUudG9wID0gYG1pbig5NXZoLCAke2NvbnRlbnRzLm9mZnNldC55fXB4YAoJCSAgICAgIGNvbnRlbnRzLnN0eWxlLmxlZnQgPSBgbWluKDk1dncsICR7Y29udGVudHMub2Zmc2V0Lnh9cHhgCgkJICAgIH0sCgkJfQoJfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiBoZWFkZXIgcmVzZXQgdGhlIHBvc2l0aW9uCgkJY29udGFpbmVyLnBvcG91dCgpCgl9KQoJaW50ZXJhY3QoY29udGVudHMpCgkgIC5yZXNpemFibGUoewoJICAgIGVkZ2VzOiB7IHRvcDogdHJ1ZSwgbGVmdDogZmFsc2UsIGJvdHRvbTogdHJ1ZSwgcmlnaHQ6IHRydWUgfSwKCSAgICBsaXN0ZW5lcnM6IHsKCSAgICAgIG1vdmU6IGZ1bmN0aW9uIChldmVudCkgewkJCgkgICAgICAgIE9iamVjdC5hc3NpZ24oZXZlbnQudGFyZ2V0LnN0eWxlLCB7CgkgICAgICAgICAgd2lkdGg6IGAke2V2ZW50LnJlY3Qud2lkdGh9cHhgLAoJICAgICAgICAgIGhlaWdodDogYCR7ZXZlbnQucmVjdC5oZWlnaHR9cHhgLAoJICAgICAgICB9KQoJICAgICAgfQoJICAgIH0KCSAgfSkub24oJ2RvdWJsZXRhcCcsIGZ1bmN0aW9uIChldmVudCkgewoJCSAgLy8gRG91YmxlLXRhcCBvbiByZXNpemUgcmVzZXQgdGhlIHdpZHRoCgkJCWNvbnRlbnRzLnN0eWxlLndpZHRoID0gJycKCQkgIAljb250ZW50cy5zdHlsZS5oZWlnaHQgPSAnJwoJICB9KQoKCglmdW5jdGlvbiBwb3NpdGlvbkNvbnRlbnRzKCkgewogICAgICAgIC8vIERlYWwgd2l0aCBzY3JvbGxpbmcKICAgICAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJykgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50CiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gc2Nyb2xsQ29udGFpbmVyLnNjcm9sbFRvcCB8fCB3aW5kb3cucGFnZVlPZmZzZXQKCgkJY29tcHV0ZVBvc2l0aW9uKGhlYWRlciwgY29udGVudHMsIHsKCQkJc3RyYXRlZ3k6ICJmaXhlZCIsCgkJCW1pZGRsZXdhcmU6IFsKICAgICAgICAgICAgICAgIGF1dG9QbGFjZW1lbnQoKSwKICAgICAgICAgICAgXSwKCQl9KS50aGVuKChwb3MpID0+IHsKCQkJY29udGVudHMuc3R5bGUubGVmdCA9IHBvcy54ICsgInB4IgoJCQljb250ZW50cy5zdHlsZS50b3AgPSBwb3MueSAtIHNjcm9sbFRvcCArICJweCIKCQl9KQoJfQoKCWNvbnRhaW5lci5wb3BvdXQgPSAoZm9yY2UgPSB1bmRlZmluZWQpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgncG9wcGVkJywgZm9yY2UpCgkJcG9zaXRpb25Db250ZW50cygpCgl9CgoJaGVhZGVyLm9uY2xpY2sgPSAoZSkgPT4ge2NvbnRhaW5lci5wb3BvdXQoKX0KCgkvLyBDcmVhdGUgYSByZXVzYWJsZSBkZWJvdW5jZWQgY2xhc3MgcmVtb3ZhbCBmdW5jdGlvbgoJY29uc3QgY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyID0gKGNvbnRhaW5lciwgY2xhc3NOYW1lLCBkZWxheSkgPT4gewoJCXJldHVybiBfLmRlYm91bmNlKCgpID0+IHsKCQkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoY2xhc3NOYW1lLCBmYWxzZSkKCQl9LCBkZWxheSkKCX0KCgljb25zdCBkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyID0gY3JlYXRlRGVib3VuY2VkQ2xhc3NSZW1vdmVyKGNvbnRhaW5lciwgJ2NvbnRlbnRzLWhvdmVyJywgMzAwKQoJY29uc3QgZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnaGVhZGVyLWhvdmVyJywgMzAwKQoKCWNvbnRlbnRzLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2NvbnRlbnRzLWhvdmVyJywgdHJ1ZSkKCQlkZWJvdW5jZWRSZW1vdmVDb250ZW50c0hvdmVyLmNhbmNlbCgpCgl9Cgljb250ZW50cy5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIoKQoJfQoKCWhlYWRlci5vbm1vdXNlZW50ZXIgPSAoZSkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItaG92ZXInLCB0cnVlKQoJCWNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHBlZCcpID8gbnVsbCA6IHBvc2l0aW9uQ29udGVudHMoKQoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyLmNhbmNlbCgpCgl9CgloZWFkZXIub25tb3VzZWxlYXZlID0gKGUpID0+IHsKCQlkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlcigpCgl9Cjwvc2NyaXB0Pgo8c3R5bGU+Cglwb3BvdXQtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBib3JkZXI6IDNweCBkYXNoZWQgdHJhbnNwYXJlbnQ7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KcG9wb3V0LWNvbnRlbnRzIHsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICB3aWR0aDogNDAwcHg7CiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7CiAgICBib3JkZXI6IDNweCBzb2xpZCB2YXIoLS1vdmVybGF5LWJ1dHRvbi1ib3JkZXIpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKICAgIHBhZGRpbmc6IDhweDsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1jb250ZW50cywKcG9wb3V0LWNvbnRhaW5lci5oZWFkZXItaG92ZXIgPiBwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiA1MDA7Cn0KcG9wb3V0LWNvbnRhaW5lci5jb250ZW50cy1ob3ZlciA+IHBvcG91dC1oZWFkZXIgewogICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wbHV0by1sb2dzLXdhcm4tYWNjZW50LWNvbG9yKTsKfQoucG9wb3V0LWljb24gewogICAgLS1zaXplOiAyMHB4OwogICAgZGlzcGxheTogYmxvY2s7CiAgICBhbGlnbi1zZWxmOiBzdHJldGNoOwogICAgYmFja2dyb3VuZC1zaXplOiB2YXIoLS1zaXplKSB2YXIoLS1zaXplKTsKICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7CiAgICB3aWR0aDogdmFyKC0tc2l6ZSk7CiAgICBtaW4taGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGZpbHRlcjogdmFyKC0taW1hZ2UtZmlsdGVycyk7Cn0KLnBvcG91dC1pY29uLnBvcG91dCB7CQogICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9pb25pYy10ZWFtL2lvbmljb25zQDUuNS4xL3NyYy9zdmcvZXhwYW5kLnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgLnBvcG91dCB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9jb250cmFjdC5zdmcpOwp9CnBvcG91dC1jb250YWluZXIucG9wcGVkIHRvZ2dsZXJlYWN0aXZlLWhlYWRlciA+IC5kZXNjcmlwdGlvbiB7CiAgICB0b3VjaC1hY3Rpb246IG5vbmU7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQo8L3N0eWxlPgo8c2NyaXB0IGlkPSdudXZocnhlY3R3Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAibnV2aHJ4ZWN0dyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPC9ib25kLXZhbHVlPgoJPHN0eWxlPgoJCWJvbmQtd2l0aC1kZXNjcmlwdGlvbiB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciBtaW5tYXgobWluKDUwcHgsIDEwMCUpLCAwLjRmcik7CiAgZ3JpZC1hdXRvLXJvd3M6IGZpdC1jb250ZW50KDQwcHgpOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKfQpib25kdGFibGUtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uLApib25kc2xpc3QtY29udGVudHMgYm9uZC13aXRoLWRlc2NyaXB0aW9uIHsKICBkaXNwbGF5OiBjb250ZW50czsKfQpib25kLXZhbHVlIGJvbmQgewogIGRpc3BsYXk6IGZsZXg7IC8qIE5lZWRlZCBmb3IgY29uc2lzdGVudCBzaXppbmcgKHdpZHRoKSBvZiB0aGUgaW5wdXQgKi8KfQpib25kLXZhbHVlIGlucHV0IHsKICB3aWR0aDogMTAwJTsgLyogTmVlZGVkIGZvciBjb25zaXN0ZW50IHNpemluZyAod2lkdGgpIG9mIHRoZSBpbnB1dCAqLwp9CgoJPC9zdHlsZT4KPC9ib25kLXdpdGgtZGVzY3JpcHRpb24+CgkKCTwvYm9uZHNsaXN0LWNvbnRlbnRzPgoJPHNjcmlwdCBpZD0nZ2h6Y2VudGRqZic+CgkJY29uc3QgY29udGFpbmVyID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29udGFpbmVyLmNvbGxhcHNlID0gKGZvcmNlKSA9PiB7CgkJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnLCBmb3JjZSkKCQl9CgkJY29uc3QgY29sbGFwc2VfYnRuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4uY29sbGFwc2UnKQoJCWNvbGxhcHNlX2J0bi5vbmNsaWNrID0gKGUpID0+IGNvbnRhaW5lci5jb2xsYXBzZSgpCgk8L3NjcmlwdD4KCTxzdHlsZT4KCWJvbmRzbGlzdC1oZWFkZXIgewogIGdyaWQtY29sdW1uOiAxIC8gLTE7CiAgZGlzcGxheTogZmxleDsKICBiYWNrZ3JvdW5kOiB2YXIoLS1vdmVybGF5LWJ1dHRvbi1iZyk7Cn0KYm9uZHNsaXN0LWhlYWRlcjpiZWZvcmUgewogIGNvbnRlbnQ6ICIiOwogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAxcHg7CiAgYm90dG9tOiAwcHg7CiAgbGVmdDogMHB4OwogIHJpZ2h0OiAwcHg7CiAgei1pbmRleDogLTE7CiAgYmFja2dyb3VuZDogI2ZmYWM0NTQwOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0ID4gYm9uZHNsaXN0LWhlYWRlciB7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDBweDsKICBwYWRkaW5nLXRvcDogMTJweDsKICBtYXJnaW4tdG9wOiAtMTJweDsKICB6LWluZGV4OiAxMDsKfQpib25kc2xpc3QtY29udGVudHMgewogIGRpc3BsYXk6IGNvbnRlbnRzOwp9CmJvbmRzbGlzdC1jb250YWluZXIubm8tcG9wb3V0OmJlZm9yZSB7CiAgY29udGVudDogIiI7CiAgZGlzcGxheTogYmxvY2s7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBqdXN0aWZ5LXNlbGY6IGNlbnRlcjsKICBib3JkZXItYm90dG9tOiAycHggc29saWQ7CiAgcGFkZGluZy10b3A6IDVweDsKICB3aWR0aDogMTAwJTsKICBhbGlnbi1zZWxmOiBzdGFydDsKICBwb3NpdGlvbjogc3RpY2t5OwogIHRvcDogMHB4OwogIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICB6LWluZGV4OiAyMDsKfQpib25kc2xpc3QtaGVhZGVyID4gLmJvbmRzbGlzdC1pY29uIHsKICAtLXNpemU6IDE3cHg7CiAgZGlzcGxheTogYmxvY2s7CiAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7CiAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogIHdpZHRoOiB2YXIoLS1zaXplKTsKICBmaWx0ZXI6IHZhcigtLWltYWdlLWZpbHRlcnMpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogIGN1cnNvcjogcG9pbnRlcjsKfQpib25kc2xpc3QtY29udGFpbmVyLmNvbGxhcHNlZCA+IGJvbmRzbGlzdC1oZWFkZXIgPiAuY29sbGFwc2UgewogIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgd2lkdGg6IDMwcHg7CiAgbWFyZ2luOiAwIDEwcHg7Cn0KYm9uZHNsaXN0LWhlYWRlciB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICB3aWR0aDogMTAwJTsKfQpib25kc2xpc3QtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgZmxleC1ncm93OiAxOwogIGZvbnQtc2l6ZTogMThweDsKICBmb250LXdlaWdodDogNjAwOwp9CmJvbmRzbGlzdC1oZWFkZXIgPiAudG9nZ2xlIHsKICBhbGlnbi1zZWxmOiBjZW50ZXI7Cn0KYm9uZHNsaXN0LWNvbnRhaW5lci5jb2xsYXBzZWQgYm9uZHNsaXN0LWhlYWRlciArICogewogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQpib25kc2xpc3QtY29udGFpbmVyIHsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbm1heChtaW4oNTBweCwgMTAwJSksIDAuNGZyKTsKICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAganVzdGlmeS1pdGVtczogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgcm93LWdhcDogNXB4Owp9CmJvbmR0YWJsZS1jb250YWluZXIgYm9uZHNsaXN0LWNvbnRhaW5lciB7CiAgZGlzcGxheTogY29udGVudHM7Cn0KCQkKCTwvc3R5bGU+CjwvYm9uZHNsaXN0LWNvbnRhaW5lcj4KpG1pbWWpdGV4dC9odG1srHJvb3Rhc3NpZ25lZaNibGOybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAJC1FAsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjW5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4As4gbtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keaCkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAI6y1JsHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjK5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZc4G9PvKtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9kedlAPGRpdiBjbGFzcz0ibWFya2Rvd24iPjxoMSBpZD0iU3RydWN0Qm9uZCI+U3RydWN0Qm9uZDwvaDE+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWNi9GUPrBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNDg0Mzk4M2MtZGY2NC00Yjk0LTg2MzQtN2ExMGQ5NDIzYTcwuWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAMWBbVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNIqmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHmmMi4wZTEwpG1pbWWqdGV4dC9wbGFpbqxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACT3eWbBwZXJzaXN0X2pzX3N0YXRlw7doYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWVCtXB1Ymxpc2hlZF9vYmplY3Rfa2V5c5C4ZGVwZW5kc19vbl9za2lwcGVkX2NlbGxzwqdlcnJvcmVkwtkkNTQzOGU5ZTctYzBmNy00NTIzLTg2ODItZmZiODIyMzU5ZDUwiqZxdWV1ZWTCpGxvZ3OQp3J1bm5pbmfCpm91dHB1dIakYm9keaCkbWltZap0ZXh0L3BsYWlurHJvb3Rhc3NpZ25lZcCybGFzdF9ydW5fdGltZXN0YW1wy0HaNkAIcE6csHBlcnNpc3RfanNfc3RhdGXCt2hhc19wbHV0b19ob29rX2ZlYXR1cmVzwqdjZWxsX2lk2SQ1NDM4ZTllNy1jMGY3LTQ1MjMtODY4Mi1mZmI4MjIzNTlkNTC5ZGVwZW5kc19vbl9kaXNhYmxlZF9jZWxsc8KncnVudGltZS+1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SRiYjA0YWMxMi0yMGEwLTQ2N2EtYWYxYS1jMjk4MzAxZTQ4MziKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52SMjNSAoZ2VuZXJpYyBmdW5jdGlvbiB3aXRoIDEgbWV0aG9kKaRtaW1lqnRleHQvcGxhaW6scm9vdGFzc2lnbmVlsW1hcmtkb3duX2Z1bmN0aW9usmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWj8Y4/W7BwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkYmIwNGFjMTItMjBhMC00NjdhLWFmMWEtYzI5ODMwMWU0ODM4uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXNYlW1cHVibGlzaGVkX29iamVjdF9rZXlzkLhkZXBlbmRzX29uX3NraXBwZWRfY2VsbHPCp2Vycm9yZWTC2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSKpnF1ZXVlZMKkbG9nc5CncnVubmluZ8Kmb3V0cHV0hqRib2R52mNkPGJvbmQgZGVmPSJsb2xfcG9wIiB1bmlxdWVfaWQ9Iml5cWNoanV6bnFveiI+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBvcG91dC1jb250YWluZXIga2V5PSd4cm1sdXJseGlqJz4KCTxwb3BvdXQtaGVhZGVyPjxzcGFuIGNsYXNzPSdwb3BvdXQtaWNvbiBwb3BvdXQnPjwvc3Bhbj48L3BvcG91dC1oZWFkZXI+Cgk8cG9wb3V0LWNvbnRlbnRzPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J25hYm14cmptenUnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzdHJ1Y3QtYm9uZCBjbGFzcz0nTWFpbi52YXImcXVvdDt3b3Jrc3BhY2UjNDYzJnF1b3Q7LkxPTCc+Cgk8dG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyIGNsYXNzPSdjb2xsYXBzaWJsZSc+Cgk8dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPgogICAgICAgIDxzcGFuIGNsYXNzPSdjb2xsYXBzZS1idG4nPjwvc3Bhbj4KCQk8c3BhbiBjbGFzcz0nZGVzY3JpcHRpb24nPkxPTDwvc3Bhbj4KCQk8aW5wdXQgdHlwZT0nY2hlY2tib3gnIGNsYXNzPSd0b2dnbGUnIGNoZWNrZWQ+Cgk8L3RvZ2dsZXJlYWN0aXZlLWhlYWRlcj4KCTxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPHBsLWNvbWJpbmVkLWNoaWxkIGtleT0na2dqcnVlemx3dScgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHBsLWNvbWJpbmVkLWNoaWxkIGtleT0nY2lyenhwa3hydycgc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+PHNwYW4gc3R5bGU9J2Rpc3BsYXk6IGNvbnRlbnRzOyc+CQk8ZmllbGQtaHRtbCBjbGFzcz0nYSc+CgkJCTxmaWVsZC1kZXNjcmlwdGlvbiBjbGFzcz0nYScgdGl0bGU9IlRoaXMgdmFsdWUgaXMgYXNzb2NpYXRlZCB0byBmaWVsZCBgYWAiPjxkaXYgY2xhc3M9Im1hcmtkb3duIj48cD5Xb25kZXImIzMzOzwvcD4KPC9kaXY+PC9maWVsZC1kZXNjcmlwdGlvbj4KCQkJPGZpZWxkLWJvbmQgY2xhc3M9J2EnPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J3lmY3RuaWpvYWEnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxpbnB1dCB0eXBlPSdyYW5nZScgbWluPScxJyBtYXg9JzEwJyB2YWx1ZT0nMSc+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0neWZjdG5pam9hYSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInlmY3RuaWpvYWEiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPjxwbC1jb21iaW5lZC1jaGlsZCBrZXk9J2Npcnp4cGt4cncnIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPjxzcGFuIHN0eWxlPSdkaXNwbGF5OiBjb250ZW50czsnPgkJPGZpZWxkLWh0bWwgY2xhc3M9J2InPgoJCQk8ZmllbGQtZGVzY3JpcHRpb24gY2xhc3M9J2InIHRpdGxlPSJUaGlzIHZhbHVlIGlzIGFzc29jaWF0ZWQgdG8gZmllbGQgYGJgIj48c3Bhbj5GaWVsZCBCPC9zcGFuPjwvZmllbGQtZGVzY3JpcHRpb24+CgkJCTxmaWVsZC1ib25kIGNsYXNzPSdiJz48cGwtY29tYmluZWQtY2hpbGQga2V5PSd4Y3JlYW51b3l5JyBzdHlsZT0nZGlzcGxheTogY29udGVudHM7Jz48c2NyaXB0PgoJCQkvLyB3ZWlyZCBpbXBvcnQgdG8gbWFrZSBpdCBmYXN0ZXIuIFRoZSBgYXdhaXQgaW1wb3J0YCBjYW4gc3RpbGwgZGVsYXkgZXhlY3V0aW9uIGJ5IG9uZSBmcmFtZSBpZiBpdCBpcyBhbHJlYWR5IGxvYWRlZC4uLgoJCQl3aW5kb3cuZDNmb3JtYXQgPSB3aW5kb3cuZDNmb3JtYXQgPz8gYXdhaXQgaW1wb3J0KCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcm1hdEAyLytlc20iKQoKCQkJY29uc3QgYXJnbWluID0geHMgPT4geHMuaW5kZXhPZihNYXRoLm1pbiguLi54cykpCgkJCWNvbnN0IGNsb3Nlc3RfaW5kZXggPSAoeHMsIHkpID0+IGFyZ21pbih4cy5tYXAoeCA9PiBNYXRoLmFicyh4LXkpKSkKCgkJCWNvbnN0IHZhbHVlcyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF0KCgkJCWNvbnN0IGVsID0gaHRtbGAKCQkJPHNwYW4gdGl0bGU9IkNsaWNrIGFuZCBkcmFnIHRoaXMgbnVtYmVyIGxlZnQgb3IgcmlnaHQhIiBzdHlsZT0iY3Vyc29yOiBjb2wtcmVzaXplOwoJCQl0b3VjaC1hY3Rpb246IG5vbmU7CgkJCWJhY2tncm91bmQ6IHJnYigyNTIsIDIwOSwgMjA0KTsKCQkJY29sb3I6IGJsYWNrOwoJCQlwYWRkaW5nOiAwZW0gLjJlbTsKCQkJYm9yZGVyLXJhZGl1czogLjNlbTsKCQkJZm9udC13ZWlnaHQ6IGJvbGQ7CgkJCWZvbnQtZmFtaWx5OiBzeXN0ZW0tdWksIHNhbnMtc2VyaWY7CiAgICAJCWZvbnQtdmFyaWFudC1udW1lcmljOiB0YWJ1bGFyLW51bXM7CgkJCSI+Njwvc3Bhbj4KCQkJYAoKCgoJCQlsZXQgb2xkX3ggPSAwCgkJCWxldCBvbGRfaW5kZXggPSAwCgkJCWNvbnN0IGluaXRpYWxfaW5kZXggPSBjbG9zZXN0X2luZGV4KHZhbHVlcywgNikKCQkJbGV0IGN1cnJlbnRfaW5kZXggPSBpbml0aWFsX2luZGV4CgoJCQljb25zdCBmb3JtYXR0ZXIgPSBzID0+ICIiICsgZDNmb3JtYXQuZm9ybWF0KCIiKShzKSArICIiCgoKCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KGVsLCAndmFsdWUnLCB7CgkJCQlnZXQ6ICgpID0+IHZhbHVlc1tjdXJyZW50X2luZGV4XSwKCQkJCXNldDogeCA9PiB7CgkJCQkJY3VycmVudF9pbmRleCA9IGNsb3Nlc3RfaW5kZXgodmFsdWVzLCB4KQoJCQkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQkJCX0sCgkJCQljb25maWd1cmFibGU6IHRydWUsCgkJCX0pOwoKCQkJLy8gaW5pdGlhbCB2YWx1ZQoJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoNikKCgkJCWNvbnN0IG9uU2NydWIgPSAoZSkgPT4gewoJCQkJY29uc3Qgb2Zmc2V0ID0gZS5jbGllbnRYIC0gb2xkX3gKCQkJCWNvbnN0IG5ld19pbmRleCA9IE1hdGgubWluKHZhbHVlcy5sZW5ndGgtMSwgTWF0aC5tYXgoMCwgCgkJCQkJTWF0aC5yb3VuZChvZmZzZXQvMTApICsgb2xkX2luZGV4CgkJCQkpKQoKCQkJCWlmKG5ld19pbmRleCAhPT0gY3VycmVudF9pbmRleCkgewoJCQkJCWN1cnJlbnRfaW5kZXggPSBuZXdfaW5kZXgKCQkJCQllbC5pbm5lclRleHQgPSBmb3JtYXR0ZXIoZWwudmFsdWUpCgkJCQkJZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0IikpCgkJCQl9CgkJCX0KCgkJCWNvbnN0IG9ucG9pbnRlcmRvd24gPSAoZSkgPT4gewoJCQkJd2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KCkKCQkJCW9sZF94ID0gZS5jbGllbnRYCgkJCQlvbGRfaW5kZXggPSBjdXJyZW50X2luZGV4CgkJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLCBvblNjcnViKQoJCQl9CgkJCWVsLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCgkJCWNvbnN0IG9uZGJsY2xpY2sgPSAoZSkgPT4gewoJCQkJY3VycmVudF9pbmRleCA9IGluaXRpYWxfaW5kZXgKCQkJCWVsLmlubmVyVGV4dCA9IGZvcm1hdHRlcihlbC52YWx1ZSkKCQkJCWVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIpKQoJCQl9CgkJCWVsLmFkZEV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCgkJCWNvbnN0IG9ucG9pbnRlcnVwID0gKCkgPT4gewoJCQkJd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgb25TY3J1YikKCQkJfQoJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicG9pbnRlcnVwIiwgb25wb2ludGVydXApCgoJCQllbC5vbnNlbGVjdHN0YXJ0ID0gKCkgPT4gZmFsc2UKCgkJCWludmFsaWRhdGlvbi50aGVuKCgpID0+IHsKCQkJCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoInBvaW50ZXJkb3duIiwgb25wb2ludGVyZG93bikKCQkJCWVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoImRibGNsaWNrIiwgb25kYmxjbGljaykKCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJwb2ludGVydXAiLCBvbnBvaW50ZXJ1cCkKCQkJfSkKCgkJCXJldHVybiBlbAoKCQkJPC9zY3JpcHQ+PC9wbC1jb21iaW5lZC1jaGlsZD48L2ZpZWxkLWJvbmQ+CgkJPC9maWVsZC1odG1sPgoJCTxzdHlsZT4KCQkJZmllbGQtaHRtbCB7CgkJCQlkaXNwbGF5OiBncmlkOwoJCQkJZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CgkJCQlncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CgkJCQlqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CgkJCQkvL3BhZGRpbmc6IDJweCA1cHggMTBweCAwcHg7CgkJCQlhbGlnbi1pdGVtczogY2VudGVyOwoJCQkJcm93LWdhcDogNXB4OwoJCQl9CgkJCWZpZWxkLWJvbmQgewoJCQkJZGlzcGxheTogZmxleDsKCQkJfQoJCQlmaWVsZC1ib25kIGlucHV0IHsKCQkJCXdpZHRoOiAxMDAlOwoJCQl9CiAgIAkJCWZpZWxkLWRlc2NyaXB0aW9uIHsKCQkJCXRleHQtYWxpZ246IGNlbnRlcjsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBpZD0neGNyZWFudW95eSc+CmNvbnN0IGRpdiA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudApsZXQga2V5ID0gInhjcmVhbnVveXkiCmNvbnN0IGlucHV0cyA9IGRpdi5xdWVyeVNlbGVjdG9yQWxsKGBwbC1jb21iaW5lZC1jaGlsZFtrZXk9JyR7a2V5fSddID4gKjpmaXJzdC1jaGlsZGApCgpjb25zdCB2YWx1ZXMgPSBBcnJheShpbnB1dHMubGVuZ3RoKQoKaW5wdXRzLmZvckVhY2goYXN5bmMgKGVsLGkpID0+IHsKCWVsLm9uaW5wdXQgPSAoZSkgPT4gewoJCWUuc3RvcFByb3BhZ2F0aW9uKCkKCX0KCWNvbnN0IGdlbiA9IEdlbmVyYXRvcnMuaW5wdXQoZWwpCgl3aGlsZSh0cnVlKSB7CgkJdmFsdWVzW2ldID0gYXdhaXQgZ2VuLm5leHQoKS52YWx1ZQoJCWRpdi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgiaW5wdXQiLCB7fSkpCgl9Cn0pCgoKbGV0IHNldF9pbnB1dF92YWx1ZSA9ICgoKSA9PiB7CglsZXQgcmVzdWx0ID0gbnVsbAoJdHJ5IHsKCXJlc3VsdCA9IHNldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCn0gY2F0Y2ggKGUpIHsKCXJlc3VsdCA9ICgoaW5wdXQsIG5ld192YWx1ZSkgPT4gewoJLy8gZmFsbGJhY2sgaW4gY2FzZSBodHRwczovL2dpdGh1Yi5jb20vZm9uc3AvUGx1dG8uamwvcHVsbC8xNzU1IGlzIG5vdCBhdmFpbGFibGUKICAgIGlmIChuZXdfdmFsdWUgPT0gbnVsbCkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICAgICAgcmV0dXJuCiAgICB9CiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7CiAgICAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgInJhbmdlIjoKICAgICAgICAgICAgY2FzZSAibnVtYmVyIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNOdW1iZXIgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNOdW1iZXIgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImRhdGUiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc0RhdGUgPT0gbnVsbCB8fCBOdW1iZXIoaW5wdXQudmFsdWVBc0RhdGUpICE9PSBOdW1iZXIobmV3X3ZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnZhbHVlQXNEYXRlID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJjaGVja2JveCI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC5jaGVja2VkICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5jaGVja2VkID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJmaWxlIjogewogICAgICAgICAgICAgICAgLy8gQ2FuJ3Qgc2V0IGZpbGVzIDooCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCAmJiBpbnB1dC5tdWx0aXBsZSkgewogICAgICAgIGZvciAobGV0IG9wdGlvbiBvZiBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpKSB7CiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IG5ld192YWx1ZS5pbmNsdWRlcyhvcHRpb24udmFsdWUpCiAgICAgICAgfQogICAgICAgIHJldHVybgogICAgfQogICAgLy9AdHMtaWdub3JlCiAgICBpZiAoaW5wdXQudmFsdWUgIT09IG5ld192YWx1ZSkgewogICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgIGlucHV0LnZhbHVlID0gbmV3X3ZhbHVlCiAgICB9Cn0pCn0KcmV0dXJuIHJlc3VsdAp9KSgpCgoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRpdiwgJ3ZhbHVlJywgewoJZ2V0OiAoKSA9PiB2YWx1ZXMsCglzZXQ6IChuZXd2YWxzKSA9PiB7CgkJaWYoIW5ld3ZhbHMpIHsKCQkJcmV0dXJuCgkJfQoJCWlucHV0cy5mb3JFYWNoKChlbCwgaSkgPT4gewoJCQl2YWx1ZXNbaV0gPSBuZXd2YWxzW2ldCgkJCXNldF9pbnB1dF92YWx1ZShlbCwgbmV3dmFsc1tpXSkKCQl9KQp9LAoJY29uZmlndXJhYmxlOiB0cnVlLAp9KTsKCjwvc2NyaXB0Pjwvc3Bhbj48L3BsLWNvbWJpbmVkLWNoaWxkPgo8c2NyaXB0IGlkPSdjaXJ6eHBreHJ3Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAiY2lyenhwa3hydyIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPjwvcGwtY29tYmluZWQtY2hpbGQ+CgkKPHNjcmlwdD4KCWNvbnN0IHRyYyA9IGN1cnJlbnRTY3JpcHQuY2xvc2VzdCgndG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyJykKCWNvbnN0IGhlYWRlciA9IHRyYy5maXJzdEVsZW1lbnRDaGlsZAoJY29uc3QgZGVzYyA9IGhlYWRlci5xdWVyeVNlbGVjdG9yKCcuZGVzY3JpcHRpb24nKQoJZGVzYy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgIlRoaXMgZ2VuZXJhdGVzIGEgc3RydWN0IG9mIHR5cGUgTE9MIikKPC9zY3JpcHQ+Cgk8c2NyaXB0IGlkPSdrZ2pydWV6bHd1Jz4KY29uc3QgZGl2ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CmxldCBrZXkgPSAia2dqcnVlemx3dSIKY29uc3QgaW5wdXRzID0gZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoYHBsLWNvbWJpbmVkLWNoaWxkW2tleT0nJHtrZXl9J10gPiAqOmZpcnN0LWNoaWxkYCkKCmNvbnN0IHZhbHVlcyA9IEFycmF5KGlucHV0cy5sZW5ndGgpCgppbnB1dHMuZm9yRWFjaChhc3luYyAoZWwsaSkgPT4gewoJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJZS5zdG9wUHJvcGFnYXRpb24oKQoJfQoJY29uc3QgZ2VuID0gR2VuZXJhdG9ycy5pbnB1dChlbCkKCXdoaWxlKHRydWUpIHsKCQl2YWx1ZXNbaV0gPSBhd2FpdCBnZW4ubmV4dCgpLnZhbHVlCgkJZGl2LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCJpbnB1dCIsIHt9KSkKCX0KfSkKCgpsZXQgc2V0X2lucHV0X3ZhbHVlID0gKCgpID0+IHsKCWxldCByZXN1bHQgPSBudWxsCgl0cnkgewoJcmVzdWx0ID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KfSBjYXRjaCAoZSkgewoJcmVzdWx0ID0gKChpbnB1dCwgbmV3X3ZhbHVlKSA9PiB7CgkvLyBmYWxsYmFjayBpbiBjYXNlIGh0dHBzOi8vZ2l0aHViLmNvbS9mb25zcC9QbHV0by5qbC9wdWxsLzE3NTUgaXMgbm90IGF2YWlsYWJsZQogICAgaWYgKG5ld192YWx1ZSA9PSBudWxsKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgICAgICByZXR1cm4KICAgIH0KICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHsKICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAicmFuZ2UiOgogICAgICAgICAgICBjYXNlICJudW1iZXIiOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQudmFsdWVBc051bWJlciAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc051bWJlciA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZGF0ZSI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzRGF0ZSA9PSBudWxsIHx8IE51bWJlcihpbnB1dC52YWx1ZUFzRGF0ZSkgIT09IE51bWJlcihuZXdfdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQudmFsdWVBc0RhdGUgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImNoZWNrYm94IjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LmNoZWNrZWQgIT09IG5ld192YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmNoZWNrZWQgPSBuZXdfdmFsdWUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgImZpbGUiOiB7CiAgICAgICAgICAgICAgICAvLyBDYW4ndCBzZXQgZmlsZXMgOigKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50ICYmIGlucHV0Lm11bHRpcGxlKSB7CiAgICAgICAgZm9yIChsZXQgb3B0aW9uIG9mIEFycmF5LmZyb20oaW5wdXQub3B0aW9ucykpIHsKICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gbmV3X3ZhbHVlLmluY2x1ZGVzKG9wdGlvbi52YWx1ZSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuCiAgICB9CiAgICAvL0B0cy1pZ25vcmUKICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgLy9AdHMtaWdub3JlCiAgICAgICAgaW5wdXQudmFsdWUgPSBuZXdfdmFsdWUKICAgIH0KfSkKfQpyZXR1cm4gcmVzdWx0Cn0pKCkKCgpPYmplY3QuZGVmaW5lUHJvcGVydHkoZGl2LCAndmFsdWUnLCB7CglnZXQ6ICgpID0+IHZhbHVlcywKCXNldDogKG5ld3ZhbHMpID0+IHsKCQlpZighbmV3dmFscykgewoJCQlyZXR1cm4KCQl9CgkJaW5wdXRzLmZvckVhY2goKGVsLCBpKSA9PiB7CgkJCXZhbHVlc1tpXSA9IG5ld3ZhbHNbaV0KCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWxzW2ldKQoJCX0pCn0sCgljb25maWd1cmFibGU6IHRydWUsCn0pOwoKPC9zY3JpcHQ+PC9zcGFuPgoJPHNjcmlwdCBpZD0na3FxZ296dml4byc+CgkJY29uc3QgcGFyZW50ID0gY3VycmVudFNjcmlwdC5wYXJlbnRFbGVtZW50CgkJY29uc3QgZWwgPSBjdXJyZW50U2NyaXB0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcKCQljb25zdCB0b2dnbGUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcigndG9nZ2xlcmVhY3RpdmUtaGVhZGVyIC50b2dnbGUnKQogICAgICAgIGNvbnN0IGNvbGxhcHNlX2J0biA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCd0b2dnbGVyZWFjdGl2ZS1oZWFkZXIgLmNvbGxhcHNlLWJ0bicpCgogICAgICAgIHBhcmVudC5jb2xsYXBzZSA9ICgpID0+IHsKICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC50b2dnbGUoJ2NvbGxhcHNlZCcpCiAgICAgICAgfQoKICAgICAgICBjb2xsYXBzZV9idG4ub25jbGljayA9IChlKSA9PiBwYXJlbnQuY29sbGFwc2UoKQoKCQljb25zdCBzZXRfaW5wdXRfdmFsdWUgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCWNvbnN0IGdldF9pbnB1dF92YWx1ZSA9IGdldEJvdW5kRWxlbWVudFZhbHVlTGlrZVBsdXRvCgoJCS8vIFdlIHVzZSBjbG9uZSB0byBhdm9pZCBwb2ludGluZyB0byB0aGUgc2FtZSBhcnJheQoJCWxldCBwdWJsaWNfdmFsdWUgPSBfLmNsb25lRGVlcChnZXRfaW5wdXRfdmFsdWUoZWwpKQoKCQlmdW5jdGlvbiBkaXNwYXRjaCgpIHsKCQkJcHVibGljX3ZhbHVlID0gXy5jbG9uZURlZXAoZ2V0X2lucHV0X3ZhbHVlKGVsKSkKCQkJcGFyZW50LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdpbnB1dCcpKQoJCX0KCgkJY29uc3Qgb2xkX29uaW5wdXQgPSBlbC5vbmlucHV0ID8/IGZ1bmN0aW9uKGUpIHt9CgkJZWwub25pbnB1dCA9IChlKSA9PiB7CgkJCW9sZF9vbmlucHV0KGUpCgkJCWlmICh0b2dnbGUuY2hlY2tlZCkge2Rpc3BhdGNoKCl9CgkJfQoKCQl0b2dnbGUub25pbnB1dCA9IGUgPT4gewoJCQlpZiAodG9nZ2xlLmNoZWNrZWQgJiYgIV8uaXNFcXVhbChnZXRfaW5wdXRfdmFsdWUoZWwpLCBwdWJsaWNfdmFsdWUpKSB7CgkJCQlkaXNwYXRjaCgpCgkJCX0KCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCX0KCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IHB1YmxpY192YWx1ZSwKCQkJc2V0OiAobmV3dmFsKSA9PiB7CgkJCQlwdWJsaWNfdmFsdWUgPSBuZXd2YWwKCQkJCQoJCQkJc2V0X2lucHV0X3ZhbHVlKGVsLCBuZXd2YWwpCgkJCQl0b2dnbGUuY2hlY2tlZCA9IHRydWUKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJPC9zY3JpcHQ+Cgk8c3R5bGU+CiAgICAgICAgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgY3Vyc29yOiBwb2ludGVyOwogICAgLS1zaXplOiAxNXB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgd2lkdGg6IGNhbGMoMip2YXIoLS1zaXplKSk7CiAgICBoZWlnaHQ6IHZhcigtLXNpemUpOwogICAgYXBwZWFyYW5jZTogbm9uZTsKICAgIGJhY2tncm91bmQ6ICNjNmM2YzY7CiAgICBvdXRsaW5lOiBub25lOwogICAgYm9yZGVyLXJhZGl1czogY2FsYyh2YXIoLS1zaXplKS8yKTsKICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMCBjYWxjKHZhcigtLXNpemUpLzgpIHJnYmEoMCwgMCwgMCwgLjIpOwogICAgbWFyZ2luOiAwIDEwcHg7Cn0KCnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4udG9nZ2xlOmNoZWNrZWQgewogICAgYmFja2dyb3VuZDogIzRCRDg2NTsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgaGVpZ2h0OiB2YXIoLS1zaXplKTsKICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIHRvcDogMHB4OwogICAgbGVmdDogMHB4OwogICAgYmFja2dyb3VuZDogI2ZmZjsKICAgIHRyYW5zZm9ybTogc2NhbGUoMS4xKTsKICAgIGJveC1zaGFkb3c6IDAgY2FsYyh2YXIoLS1zaXplKS8yMCkgY2FsYyh2YXIoLS1zaXplKS84KSByZ2JhKDAsIDAsIDAsIC4yKTsKICAgIHRyYW5zaXRpb246IC4xczsKfQoKdG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGU6Y2hlY2tlZDpiZWZvcmUgewogICAgbGVmdDogdmFyKC0tc2l6ZSkKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlIGZpZWxkLWh0bWwgewogICAgZGlzcGxheTogY29udGVudHM7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZSB7CiAgICBkaXNwbGF5OiBncmlkOwogICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWlubWF4KG1pbig1MHB4LCAxMDAlKSwgLjRmcik7CiAgICBncmlkLWF1dG8tcm93czogZml0LWNvbnRlbnQoNDBweCk7CiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgcm93LWdhcDogNXB4OwogICAgLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KICAgIGZsZXg6IDE7Cn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZT50b2dnbGVyZWFjdGl2ZS1oZWFkZXIgewogICAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICAgIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb2xsYXBzZS1idG4gewogICAgZGlzcGxheTogbm9uZTsKfQoKdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyLmNvbGxhcHNpYmxlPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIC0tc2l6ZTogMTdweDsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYWxpZ24tc2VsZjogc3RyZXRjaDsKICAgIGJhY2tncm91bmQtc2l6ZTogdmFyKC0tc2l6ZSkgdmFyKC0tc2l6ZSk7CiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogY2VudGVyOwogICAgd2lkdGg6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZG93bi5zdmcpOwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGUuY29sbGFwc2VkPnRvZ2dsZXJlYWN0aXZlLWhlYWRlcj4uY29sbGFwc2UtYnRuIHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NoZXZyb24tZm9yd2FyZC5zdmcpOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogc3RyZXRjaDsKICAgIHdpZHRoOiAxMDAlOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi5kZXNjcmlwdGlvbiB7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBmbGV4LWdyb3c6IDE7CiAgICBmb250LXNpemU6IDE4cHg7CiAgICBmb250LXdlaWdodDogNjAwOwp9Cgp0b2dnbGVyZWFjdGl2ZS1jb250YWluZXIuY29sbGFwc2libGU+dG9nZ2xlcmVhY3RpdmUtaGVhZGVyPi50b2dnbGUgewogICAgYWxpZ24tc2VsZjogY2VudGVyCn0KCnRvZ2dsZXJlYWN0aXZlLWNvbnRhaW5lci5jb2xsYXBzaWJsZS5jb2xsYXBzZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyKyogewogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Owp9CQkKCTwvc3R5bGU+CjwvdG9nZ2xlcmVhY3RpdmUtY29udGFpbmVyPgoKCTxzY3JpcHQgaWQ9J2h0ZnFocWpjY3onPgoJCQoJCWNvbnN0IHBhcmVudCA9IGN1cnJlbnRTY3JpcHQucGFyZW50RWxlbWVudAoJCWNvbnN0IHdpZGdldCA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJCgkJLy8gT3ZlcndyaXRlIHRoZSBkZXNjcmlwdGlvbgoJCWNvbnN0IGRlc2MgPSB3aWRnZXQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykKCQoJCS8vIFNldC1HZXQgYm9uZAoJCgkJY29uc3Qgc2V0X2lucHV0X3ZhbHVlID0gc2V0Qm91bmRFbGVtZW50VmFsdWVMaWtlUGx1dG8KCQljb25zdCBnZXRfaW5wdXRfdmFsdWUgPSBnZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwoJCgkJT2JqZWN0LmRlZmluZVByb3BlcnR5KHBhcmVudCwgJ3ZhbHVlJywgewoJCQlnZXQ6ICgpID0+IGdldF9pbnB1dF92YWx1ZSh3aWRnZXQpLAoJCQlzZXQ6IChuZXd2YWwpID0+IHsKCQkJCXNldF9pbnB1dF92YWx1ZSh3aWRnZXQsIG5ld3ZhbCkKCQkJfSwKCQkJY29uZmlndXJhYmxlOiB0cnVlLAoJCX0pOwoJCgkJY29uc3Qgb2xkX29uaW5wdXQgPSB3aWRnZXQub25pbnB1dCA/PyBmdW5jdGlvbihlKSB7fQoJCXdpZGdldC5vbmlucHV0ID0gKGUpID0+IHsKCQkJb2xkX29uaW5wdXQoZSkKCQkJZS5zdG9wUHJvcGFnYXRpb24oKQoJCQlwYXJlbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2lucHV0JykpCgkJfQoJPC9zY3JpcHQ+Cgk8c3R5bGU+CgkJLyogVGhlIGZsZXggYmVsb3cgaXMgbmVlZGVkIGluIHNvbWUgd2VpcmQgY2FzZXMgd2hlcmUgdGhlIGJvbmQgaXMgZGlzcGxheSBmbGV4IGFuZCB0aGUgY2hpbGQgYmVjb21lcyBzbWFsbC4gKi8KCQlzdHJ1Y3QtYm9uZCB7CiAgCQkJZmxleDogMTsKCQl9Cgk8L3N0eWxlPgoJPC9zdHJ1Y3QtYm9uZD4KPC9wbC1jb21iaW5lZC1jaGlsZD48L3BvcG91dC1jb250ZW50cz4KPC9wb3BvdXQtY29udGFpbmVyPgo8c2NyaXB0IGlkPSd4cm1sdXJseGlqJz4KCS8vIExvYWQgdGhlIGZsb2F0aW5nLXVpIGFuZCBpbnRlcmFjdCBsaWJyYXJpZXMKCXdpbmRvdy5mbG9hdGluZ191aSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvQGZsb2F0aW5nLXVpL2RvbUAxLjcuNCcpCgoJY29uc3QgeyBjb21wdXRlUG9zaXRpb24sIGF1dG9QbGFjZW1lbnQgfSA9IGZsb2F0aW5nX3VpCgkKCWNvbnN0IGNvbnRhaW5lciA9IGN1cnJlbnRTY3JpcHQucHJldmlvdXNFbGVtZW50U2libGluZwoJY29uc3QgaGVhZGVyID0gY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkCgljb25zdCBjb250ZW50cyA9IGNvbnRhaW5lci5sYXN0RWxlbWVudENoaWxkCgoJLy8gTG9hZCB0aGUgaW50ZXJhY3RqcyBwYXJ0CgkJLy8gV2UgdXNlIHRoZSBpbnRlcmFjdGpzIGxpYnJhcnkgdG8gcHJvdmlkZSBkcmFnIGFuZCByZXNpemUgaGFuZGxpbmcgYWNyb3NzIGRldmljZXMKCWNvbnN0IHsgZGVmYXVsdDogaW50ZXJhY3QgfSA9IGF3YWl0IGltcG9ydCgnaHR0cHM6Ly9lc20uc2gvaW50ZXJhY3RqcycpCgoJY29udGVudHMub2Zmc2V0ID0gY29udGVudHMub2Zmc2V0ID8/IHsgeDogMCwgeTogMH0KCWNvbnN0IHN0YXJ0UG9zaXRpb24gPSB7eDogMCwgeTogMH0KCWludGVyYWN0KGNvbnRlbnRzLnF1ZXJ5U2VsZWN0b3IoJ3RvZ2dsZXJlYWN0aXZlLWhlYWRlciAuZGVzY3JpcHRpb24sIGJvbmRzbGlzdC1oZWFkZXIgLmRlc2NyaXB0aW9uJykpLmRyYWdnYWJsZSh7CgkJbGlzdGVuZXJzOiB7CgkJCXN0YXJ0IChldmVudCkgewoJCQkJY29udGVudHMub2Zmc2V0LnkgPSBzdGFydFBvc2l0aW9uLnkgPSBjb250ZW50cy5vZmZzZXRUb3AKCQkJCWNvbnRlbnRzLm9mZnNldC54ID0gc3RhcnRQb3NpdGlvbi54ID0gY29udGVudHMub2Zmc2V0TGVmdAoJCQl9LAoJCQltb3ZlIChldmVudCkgewoJCSAgICAgIGNvbnRlbnRzLm9mZnNldC54ICs9IGV2ZW50LmR4CgkJICAgICAgY29udGVudHMub2Zmc2V0LnkgKz0gZXZlbnQuZHkKCQkKCQkgICAgICBjb250ZW50cy5zdHlsZS50b3AgPSBgbWluKDk1dmgsICR7Y29udGVudHMub2Zmc2V0Lnl9cHhgCgkJICAgICAgY29udGVudHMuc3R5bGUubGVmdCA9IGBtaW4oOTV2dywgJHtjb250ZW50cy5vZmZzZXQueH1weGAKCQkgICAgfSwKCQl9Cgl9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIGhlYWRlciByZXNldCB0aGUgcG9zaXRpb24KCQljb250YWluZXIucG9wb3V0KCkKCX0pCglpbnRlcmFjdChjb250ZW50cykKCSAgLnJlc2l6YWJsZSh7CgkgICAgZWRnZXM6IHsgdG9wOiB0cnVlLCBsZWZ0OiBmYWxzZSwgYm90dG9tOiB0cnVlLCByaWdodDogdHJ1ZSB9LAoJICAgIGxpc3RlbmVyczogewoJICAgICAgbW92ZTogZnVuY3Rpb24gKGV2ZW50KSB7CQkKCSAgICAgICAgT2JqZWN0LmFzc2lnbihldmVudC50YXJnZXQuc3R5bGUsIHsKCSAgICAgICAgICB3aWR0aDogYCR7ZXZlbnQucmVjdC53aWR0aH1weGAsCgkgICAgICAgICAgaGVpZ2h0OiBgJHtldmVudC5yZWN0LmhlaWdodH1weGAsCgkgICAgICAgIH0pCgkgICAgICB9CgkgICAgfQoJICB9KS5vbignZG91YmxldGFwJywgZnVuY3Rpb24gKGV2ZW50KSB7CgkJICAvLyBEb3VibGUtdGFwIG9uIHJlc2l6ZSByZXNldCB0aGUgd2lkdGgKCQkJY29udGVudHMuc3R5bGUud2lkdGggPSAnJwoJCSAgCWNvbnRlbnRzLnN0eWxlLmhlaWdodCA9ICcnCgkgIH0pCgoKCWZ1bmN0aW9uIHBvc2l0aW9uQ29udGVudHMoKSB7CiAgICAgICAgLy8gRGVhbCB3aXRoIHNjcm9sbGluZwogICAgICAgIGNvbnN0IHNjcm9sbENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQKICAgICAgICBjb25zdCBzY3JvbGxUb3AgPSBzY3JvbGxDb250YWluZXIuc2Nyb2xsVG9wIHx8IHdpbmRvdy5wYWdlWU9mZnNldAoKCQljb21wdXRlUG9zaXRpb24oaGVhZGVyLCBjb250ZW50cywgewoJCQlzdHJhdGVneTogImZpeGVkIiwKCQkJbWlkZGxld2FyZTogWwogICAgICAgICAgICAgICAgYXV0b1BsYWNlbWVudCgpLAogICAgICAgICAgICBdLAoJCX0pLnRoZW4oKHBvcykgPT4gewoJCQljb250ZW50cy5zdHlsZS5sZWZ0ID0gcG9zLnggKyAicHgiCgkJCWNvbnRlbnRzLnN0eWxlLnRvcCA9IHBvcy55IC0gc2Nyb2xsVG9wICsgInB4IgoJCX0pCgl9CgoJY29udGFpbmVyLnBvcG91dCA9IChmb3JjZSA9IHVuZGVmaW5lZCkgPT4gewoJCWNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdwb3BwZWQnLCBmb3JjZSkKCQlwb3NpdGlvbkNvbnRlbnRzKCkKCX0KCgloZWFkZXIub25jbGljayA9IChlKSA9PiB7Y29udGFpbmVyLnBvcG91dCgpfQoKCS8vIENyZWF0ZSBhIHJldXNhYmxlIGRlYm91bmNlZCBjbGFzcyByZW1vdmFsIGZ1bmN0aW9uCgljb25zdCBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIgPSAoY29udGFpbmVyLCBjbGFzc05hbWUsIGRlbGF5KSA9PiB7CgkJcmV0dXJuIF8uZGVib3VuY2UoKCkgPT4gewoJCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIGZhbHNlKQoJCX0sIGRlbGF5KQoJfQoKCWNvbnN0IGRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIgPSBjcmVhdGVEZWJvdW5jZWRDbGFzc1JlbW92ZXIoY29udGFpbmVyLCAnY29udGVudHMtaG92ZXInLCAzMDApCgljb25zdCBkZWJvdW5jZWRSZW1vdmVIZWFkZXJIb3ZlciA9IGNyZWF0ZURlYm91bmNlZENsYXNzUmVtb3Zlcihjb250YWluZXIsICdoZWFkZXItaG92ZXInLCAzMDApCgoJY29udGVudHMub25tb3VzZWVudGVyID0gKGUpID0+IHsKCQljb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnY29udGVudHMtaG92ZXInLCB0cnVlKQoJCWRlYm91bmNlZFJlbW92ZUNvbnRlbnRzSG92ZXIuY2FuY2VsKCkKCX0KCWNvbnRlbnRzLm9ubW91c2VsZWF2ZSA9IChlKSA9PiB7CgkJZGVib3VuY2VkUmVtb3ZlQ29udGVudHNIb3ZlcigpCgl9CgoJaGVhZGVyLm9ubW91c2VlbnRlciA9IChlKSA9PiB7CgkJY29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1ob3ZlcicsIHRydWUpCgkJY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygncG9wcGVkJykgPyBudWxsIDogcG9zaXRpb25Db250ZW50cygpCgkJZGVib3VuY2VkUmVtb3ZlSGVhZGVySG92ZXIuY2FuY2VsKCkKCX0KCWhlYWRlci5vbm1vdXNlbGVhdmUgPSAoZSkgPT4gewoJCWRlYm91bmNlZFJlbW92ZUhlYWRlckhvdmVyKCkKCX0KPC9zY3JpcHQ+CjxzdHlsZT4KCXBvcG91dC1oZWFkZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGJvcmRlcjogM3B4IGRhc2hlZCB0cmFuc3BhcmVudDsKICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQpwb3BvdXQtY29udGVudHMgewogICAgZGlzcGxheTogbm9uZTsKICAgIHdpZHRoOiA0MDBweDsKICAgIGJhY2tncm91bmQ6IHZhcigtLW92ZXJsYXktYnV0dG9uLWJnKTsKICAgIGJvcmRlcjogM3B4IHNvbGlkIHZhcigtLW92ZXJsYXktYnV0dG9uLWJvcmRlcik7CiAgICBib3JkZXItcmFkaXVzOiAxMHB4OwogICAgcGFkZGluZzogOHB4Owp9CnBvcG91dC1jb250YWluZXIucG9wcGVkID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWNvbnRlbnRzLApwb3BvdXQtY29udGFpbmVyLmhlYWRlci1ob3ZlciA+IHBvcG91dC1jb250ZW50cyB7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHotaW5kZXg6IDUwMDsKfQpwb3BvdXQtY29udGFpbmVyLmNvbnRlbnRzLWhvdmVyID4gcG9wb3V0LWhlYWRlciB7CiAgICBib3JkZXItY29sb3I6IHZhcigtLXBsdXRvLWxvZ3Mtd2Fybi1hY2NlbnQtY29sb3IpOwp9Ci5wb3BvdXQtaWNvbiB7CiAgICAtLXNpemU6IDIwcHg7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGFsaWduLXNlbGY6IHN0cmV0Y2g7CiAgICBiYWNrZ3JvdW5kLXNpemU6IHZhcigtLXNpemUpIHZhcigtLXNpemUpOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICAgIHdpZHRoOiB2YXIoLS1zaXplKTsKICAgIG1pbi1oZWlnaHQ6IHZhcigtLXNpemUpOwogICAgZmlsdGVyOiB2YXIoLS1pbWFnZS1maWx0ZXJzKTsKfQoucG9wb3V0LWljb24ucG9wb3V0IHsJCiAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L2doL2lvbmljLXRlYW0vaW9uaWNvbnNANS41LjEvc3JjL3N2Zy9leHBhbmQuc3ZnKTsKfQpwb3BvdXQtY29udGFpbmVyLnBvcHBlZCAucG9wb3V0IHsKICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvaW9uaWMtdGVhbS9pb25pY29uc0A1LjUuMS9zcmMvc3ZnL2NvbnRyYWN0LnN2Zyk7Cn0KcG9wb3V0LWNvbnRhaW5lci5wb3BwZWQgdG9nZ2xlcmVhY3RpdmUtaGVhZGVyID4gLmRlc2NyaXB0aW9uIHsKICAgIHRvdWNoLWFjdGlvbjogbm9uZTsKICAgIHVzZXItc2VsZWN0OiBub25lOwp9Cjwvc3R5bGU+CjxzY3JpcHQgaWQ9J25hYm14cmptenUnPgpjb25zdCBkaXYgPSBjdXJyZW50U2NyaXB0LnBhcmVudEVsZW1lbnQKbGV0IGtleSA9ICJuYWJteHJqbXp1Igpjb25zdCBpbnB1dHMgPSBkaXYucXVlcnlTZWxlY3RvckFsbChgcGwtY29tYmluZWQtY2hpbGRba2V5PScke2tleX0nXSA+ICo6Zmlyc3QtY2hpbGRgKQoKY29uc3QgdmFsdWVzID0gQXJyYXkoaW5wdXRzLmxlbmd0aCkKCmlucHV0cy5mb3JFYWNoKGFzeW5jIChlbCxpKSA9PiB7CgllbC5vbmlucHV0ID0gKGUpID0+IHsKCQllLnN0b3BQcm9wYWdhdGlvbigpCgl9Cgljb25zdCBnZW4gPSBHZW5lcmF0b3JzLmlucHV0KGVsKQoJd2hpbGUodHJ1ZSkgewoJCXZhbHVlc1tpXSA9IGF3YWl0IGdlbi5uZXh0KCkudmFsdWUKCQlkaXYuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoImlucHV0Iiwge30pKQoJfQp9KQoKCmxldCBzZXRfaW5wdXRfdmFsdWUgPSAoKCkgPT4gewoJbGV0IHJlc3VsdCA9IG51bGwKCXRyeSB7CglyZXN1bHQgPSBzZXRCb3VuZEVsZW1lbnRWYWx1ZUxpa2VQbHV0bwp9IGNhdGNoIChlKSB7CglyZXN1bHQgPSAoKGlucHV0LCBuZXdfdmFsdWUpID0+IHsKCS8vIGZhbGxiYWNrIGluIGNhc2UgaHR0cHM6Ly9naXRodWIuY29tL2ZvbnNwL1BsdXRvLmpsL3B1bGwvMTc1NSBpcyBub3QgYXZhaWxhYmxlCiAgICBpZiAobmV3X3ZhbHVlID09IG51bGwpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgICAgIHJldHVybgogICAgfQogICAgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkgewogICAgICAgIHN3aXRjaCAoaW5wdXQudHlwZSkgewogICAgICAgICAgICBjYXNlICJyYW5nZSI6CiAgICAgICAgICAgIGNhc2UgIm51bWJlciI6IHsKICAgICAgICAgICAgICAgIGlmIChpbnB1dC52YWx1ZUFzTnVtYmVyICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzTnVtYmVyID0gbmV3X3ZhbHVlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICJkYXRlIjogewogICAgICAgICAgICAgICAgaWYgKGlucHV0LnZhbHVlQXNEYXRlID09IG51bGwgfHwgTnVtYmVyKGlucHV0LnZhbHVlQXNEYXRlKSAhPT0gTnVtYmVyKG5ld192YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC52YWx1ZUFzRGF0ZSA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiY2hlY2tib3giOiB7CiAgICAgICAgICAgICAgICBpZiAoaW5wdXQuY2hlY2tlZCAhPT0gbmV3X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IG5ld192YWx1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAiZmlsZSI6IHsKICAgICAgICAgICAgICAgIC8vIENhbid0IHNldCBmaWxlcyA6KAogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGlucHV0IGluc3RhbmNlb2YgSFRNTFNlbGVjdEVsZW1lbnQgJiYgaW5wdXQubXVsdGlwbGUpIHsKICAgICAgICBmb3IgKGxldCBvcHRpb24gb2YgQXJyYXkuZnJvbShpbnB1dC5vcHRpb25zKSkgewogICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSBuZXdfdmFsdWUuaW5jbHVkZXMob3B0aW9uLnZhbHVlKQogICAgICAgIH0KICAgICAgICByZXR1cm4KICAgIH0KICAgIC8vQHRzLWlnbm9yZQogICAgaWYgKGlucHV0LnZhbHVlICE9PSBuZXdfdmFsdWUpIHsKICAgICAgICAvL0B0cy1pZ25vcmUKICAgICAgICBpbnB1dC52YWx1ZSA9IG5ld192YWx1ZQogICAgfQp9KQp9CnJldHVybiByZXN1bHQKfSkoKQoKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShkaXYsICd2YWx1ZScsIHsKCWdldDogKCkgPT4gdmFsdWVzLAoJc2V0OiAobmV3dmFscykgPT4gewoJCWlmKCFuZXd2YWxzKSB7CgkJCXJldHVybgoJCX0KCQlpbnB1dHMuZm9yRWFjaCgoZWwsIGkpID0+IHsKCQkJdmFsdWVzW2ldID0gbmV3dmFsc1tpXQoJCQlzZXRfaW5wdXRfdmFsdWUoZWwsIG5ld3ZhbHNbaV0pCgkJfSkKfSwKCWNvbmZpZ3VyYWJsZTogdHJ1ZSwKfSk7Cgo8L3NjcmlwdD48L3NwYW4+PC9ib25kPqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jZACP4kSrBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXODCFCd7VwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMLZJGRhM2FlMzQ4LTA4M2QtNGE3ZC1hYWJkLWQwYmMyNWIzY2ExN4qmcXVldWVkwqRsb2dzkKdydW5uaW5nwqZvdXRwdXSGpGJvZHnZWjxkaXYgY2xhc3M9Im1hcmtkb3duIj48aDIgaWQ9IkN1c3RvbS1IVE1MLWRlc2NyaXB0aW9uIj5DdXN0b20gSFRNTCBkZXNjcmlwdGlvbjwvaDI+CjwvZGl2PqRtaW1lqXRleHQvaHRtbKxyb290YXNzaWduZWXAsmxhc3RfcnVuX3RpbWVzdGFtcMtB2jWTg41v9LBwZXJzaXN0X2pzX3N0YXRlwrdoYXNfcGx1dG9faG9va19mZWF0dXJlc8KnY2VsbF9pZNkkZGEzYWUzNDgtMDgzZC00YTdkLWFhYmQtZDBiYzI1YjNjYTE3uWRlcGVuZHNfb25fZGlzYWJsZWRfY2VsbHPCp3J1bnRpbWXOAAUdubVwdWJsaXNoZWRfb2JqZWN0X2tleXOQuGRlcGVuZHNfb25fc2tpcHBlZF9jZWxsc8KnZXJyb3JlZMKrc3RhdHVzX3RyZWWFpG5hbWWobm90ZWJvb2uoc3VidGFza3OEpnNhdmluZ4WkbmFtZaZzYXZpbmeoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkBADLSJp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QEAMkh2pd29ya3NwYWNlhaRuYW1lqXdvcmtzcGFjZahzdWJ0YXNrc4KsaW5pdF9wcm9jZXNzhaRuYW1lrGluaXRfcHJvY2Vzc6hzdWJ0YXNrc4ShNIWkbmFtZaE0qHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2jWNhemAjadzdWNjZXNzw6pzdGFydGVkX2F0y0HaNY2FotjooTGFpG5hbWWhMahzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdo1jYWecqinc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jWNhYhmBqEyhaRuYW1loTKoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNY2Fno3Sp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo1jYWehLqhM4WkbmFtZaEzqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2jWNhaLYtqdzdWNjZXNzw6pzdGFydGVkX2F0y0HaNY2Fno3eq2ZpbmlzaGVkX2F0y0HaNY2F6ZwLp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo1jYWIZe2uY3JlYXRlX3Byb2Nlc3OFpG5hbWWuY3JlYXRlX3Byb2Nlc3Ooc3VidGFza3OC2SFMb2FkaW5nIG5vdGVib29rIGJvb3QgZW52aXJvbm1lbnSFpG5hbWXZIUxvYWRpbmcgbm90ZWJvb2sgYm9vdCBlbnZpcm9ubWVudKhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdo1jYWIVZOnc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jWNhNqYgbBTdGFydGluZyBwcm9jZXNzhaRuYW1lsFN0YXJ0aW5nIHByb2Nlc3Ooc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNY2E2oaHp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo1jYSojiKrZmluaXNoZWRfYXTLQdo1jYWIVY+nc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jWNhKiOGatmaW5pc2hlZF9hdMtB2jWNhemcIKdzdWNjZXNzw6pzdGFydGVkX2F0y0HaNY2EqI4Vo3BrZ4WkbmFtZaNwa2eoc3VidGFza3OEo2FkZIWkbmFtZaNhZGSoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAHqA5np3N1Y2Nlc3PAqnN0YXJ0ZWRfYXTLQdo2QAeoDmeoYW5hbHlzaXOFpG5hbWWoYW5hbHlzaXOoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAHpx86p3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QAenGWGsaW5zdGFudGlhdGUyhaRuYW1lrGluc3RhbnRpYXRlMqhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdo2QAeoDninc3VjY2Vzc8Cqc3RhcnRlZF9hdMtB2jZAB6gOeKpwcmVjb21waWxlhaRuYW1lqnByZWNvbXBpbGWoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAHqA54p3N1Y2Nlc3PAqnN0YXJ0ZWRfYXTLQdo2QAeoDnirZmluaXNoZWRfYXTLQdo2QAeoDmOnc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jZAB6cZYaNydW6FpG5hbWWjcnVuqHN1YnRhc2tzgrByZXNvbHZlX3RvcG9sb2d5haRuYW1lsHJlc29sdmVfdG9wb2xvZ3moc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAJPS/sp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QAk9KaqoZXZhbHVhdGWFpG5hbWWoZXZhbHVhdGWoc3VidGFza3OKoTOFpG5hbWWhM6hzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdo2QAk93mWnc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jZACT3OxKE0haRuYW1loTSoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAJPe4cp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QAk93nahMYWkbmFtZaExqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2jZACT289adzdWNjZXNzw6pzdGFydGVkX2F0y0HaNkAJPaToojEwhaRuYW1lojEwqHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2jZACT5SXadzdWNjZXNzw6pzdGFydGVkX2F0y0HaNkAJPkSRoTKFpG5hbWWhMqhzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdo2QAk9zrinc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jZACT29EqE2haRuYW1loTaoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAJPhBBp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QAk9//ihN4WkbmFtZaE3qHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2jZACT4fkqdzdWNjZXNzw6pzdGFydGVkX2F0y0HaNkAJPhBSoTWFpG5hbWWhNahzdWJ0YXNrc4CrZmluaXNoZWRfYXTLQdo2QAk9/+unc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jZACT3uKKE5haRuYW1loTmoc3VidGFza3OAq2ZpbmlzaGVkX2F0y0HaNkAJPkSAp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QAk+NZOhOIWkbmFtZaE4qHN1YnRhc2tzgKtmaW5pc2hlZF9hdMtB2jZACT41fqdzdWNjZXNzw6pzdGFydGVkX2F0y0HaNkAJPh+jq2ZpbmlzaGVkX2F0y0HaNkAJPlJpp3N1Y2Nlc3PDqnN0YXJ0ZWRfYXTLQdo2QAk9L/GrZmluaXNoZWRfYXTLQdo2QAk+Ummnc3VjY2Vzc8Oqc3RhcnRlZF9hdMtB2jZACT0pnqtmaW5pc2hlZF9hdMCnc3VjY2Vzc8Cqc3RhcnRlZF9hdMtB2jWNg9klA7FjZWxsX2RlcGVuZGVuY2llc94APNkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZhhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZhtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBom50kdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY52SQwNTJiOGJiZC1hY2NhLTRjMDAtYTVkZS0wYzcxN2VkMDY4ZTOEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQwNTJiOGJiZC1hY2NhLTRjMDAtYTVkZS0wYzcxN2VkMDY4ZTO0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDCEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDC0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ2N2MwODYwYi1iNGMxLTQxMmQtODcwYS1hNGNlNDk4NzQ2NWWEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ2N2MwODYwYi1iNGMxLTQxMmQtODcwYS1hNGNlNDk4NzQ2NWW0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2O0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQzYzJjMjU3ZS1iYmVlLTRhMDQtYjNiYS02OGYyMzgyZmNlODeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQzYzJjMjU3ZS1iYmVlLTRhMDQtYjNiYS02OGYyMzgyZmNlODe0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIynQG1kX3N0cpCtQmFzZS5nZXRpbmRleJCnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6E6kKVlcnJvcpCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpE1haW6Q2UVNYWluLndvcmtzcGFjZSM0NjEuIyNUZW1wTW9kdWxlIzIzOTUuUGx1dG9FeHRyYXMuU3RydWN0Qm9uZE1vZHVsZS5pc2GQpEJhc2WQo1ZhbJCkVHlwZZCoaGFzZmllbGSQ2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTSEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQzMjEzZDk3Ny03YjY1LTQzYjAtYTg4MS0xMGZjYzI1MjNmMTS0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ0Y2IxMjhhYS03YWQ4LTRkMTctYmNlZC0zNjg0NTcwM2U2YTiEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ0Y2IxMjhhYS03YWQ4LTRkMTctYmNlZC0zNjg0NTcwM2U2YTi0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SRiZDVlYzA4Ni01MTU2LTRlN2MtYTcwYi01Y2E5ZjA4OWJiNDmEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRiZDVlYzA4Ni01MTU2LTRlN2MtYTcwYi01Y2E5ZjA4OWJiNDm0ZG93bnN0cmVhbV9jZWxsc19tYXCCqHNic19ib25kkdkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1o3Nic5HZJDc4NTNjYzdmLTRlNTgtNDRkMS04ZDNiLWY4ZDQ3NDU1NjRlNrJ1cHN0cmVhbV9jZWxsc19tYXDeABGnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6RhdGFukLBTdHJ1Y3RCb25kU2VsZWN0kdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SNQbHV0b1J1bm5lci5QbHV0b1J1bm5lci5jcmVhdGVfYm9uZJClZXJyb3KQpUBiaW5kkKZTbGlkZXKR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkTWFpbpDZRU1haW4ud29ya3NwYWNlIzQ2MS4jI1RlbXBNb2R1bGUjMjM5NS5QbHV0b0V4dHJhcy5TdHJ1Y3RCb25kTW9kdWxlLmlzYZCrUGx1dG9SdW5uZXKQtFBsdXRvUnVubmVyLkJhc2UuZ2V0kKVyYW5nZZCjVmFskKRUeXBlkKNjb3OQu1BsdXRvUnVubmVyLkNvcmUuYXBwbGljYWJsZZCoaGFzZmllbGSQ2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjSEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjS0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGjYm9okdkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ42SRlMTAyNjEzZi0yNDRjLTRiNDktOTgzNy01MzViZjA0N2ExNGGEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRlMTAyNjEzZi0yNDRjLTRiNDktOTgzNy01MzViZjA0N2ExNGG0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIG2dHJhbnNmb3JtX3NpbmdsZV9maWVsZJHZJDAyZTU4MDEyLTVhZjYtNGI5MS1hOWE0LTA5YzlkYzAzOGYxMdkkOGViMThjN2YtYmI0ZC00Y2RjLTllMzAtZDU2MWY5MDk5ODAwhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOGViMThjN2YtYmI0ZC00Y2RjLTllMzAtZDU2MWY5MDk5ODAwtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkztGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBt0V4dGVuZGVkVGFibGVPZkNvbnRlbnRzkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWaEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWa0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGibnSR2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjnZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaNhc2SR2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM4S0cHJlY2VkZW5jZV9oZXVyaXN0aWMHp2NlbGxfaWTZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM7Rkb3duc3RyZWFtX2NlbGxzX21hcN4ATqxOb3RlYm9va0NhcmSQtE5vdGVib29rQ2FyZE5vdGVib29rkLBCdWlsdGluc05vdGVib29rkKhAaHRsX3N0cpClUHJpbnSQp1BsdXRvVUmR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOtQ291bnRlckJ1dHRvbpCrTXVsdGlTZWxlY3SQqEVkaXRhYmxlkdkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjsFdpZGVDZWxsTm90ZWJvb2uQr0NvbmZpcm1Ob3RlYm9va5CpVGV4dEZpZWxkkdkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nmq0xhYmVsQnV0dG9ukK9UYWJsZU9mQ29udGVudHOQqkBmaWVsZGRhdGGS2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMqpwb3BvdXR3cmFwkdkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0omJykKZhc19zdmeQrlJlbW90ZVJlc291cmNlkKZCdXR0b26QrkRvd25sb2FkQnV0dG9ukKVSYWRpb5CrV2ViY2FtSW5wdXSQp2NvbmZpcm2QqkBCb25kc0xpc3SS2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNaZQb3BvdXSR2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjWtQ2xvY2tOb3RlYm9va5CqVGltZVBpY2tlcpCkRHVtcJCmU2xpZGVym9kkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDjZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkNzg1NTgyNmUtY2NhYS00YzI3LWEwNjAtZjVjZWI5MjdiYmU42SQ1NDM4ZTllNy1jMGY3LTQ1MjMtODY4Mi1mZmI4MjIzNTlkNTDZJDAyZTU4MDEyLTVhZjYtNGI5MS1hOWE0LTA5YzlkYzAzOGYxMdkkMzZmYWYxOGMtMTFjMy00MDEyLWE5OTYtNTVjN2NkYWU3MWE42SQzYzJjMjU3ZS1iYmVlLTRhMDQtYjNiYS02OGYyMzgyZmNlODfZJGNmODA3Y2IzLTVkNzUtNDA0MC1iZmQxLTA1ZmU3MGQyNmU4OdkkYmQ1ZWMwODYtNTE1Ni00ZTdjLWE3MGItNWNhOWYwODliYjQ52SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKpRGF0ZUZpZWxkkLdUYWJsZU9mQ29udGVudHNOb3RlYm9va5CoV2lkZUNlbGyQt3Nob3dfb3V0cHV0X3doZW5faGlkZGVukdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2pUNsb2NrkLJUb2dnbGVSZWFjdGl2ZUJvbmSQrXdpdGhfdGVybWluYWyQsUNvbG9yU3RyaW5nUGlja2VykKtOdW1iZXJGaWVsZJCkU2hvd5CwVGVybWluYWxOb3RlYm9va5CnYXNfbWltZZCvRGV0YWlsc05vdGVib29rkKxAdHlwZWFzZmllbGSS2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOKdhc190ZXh0kLFAZmllbGRkZXNjcmlwdGlvbpCmYXNfcG5nkKtSYW5nZVNsaWRlcpCwU3RydWN0Qm9uZE1vZHVsZZCrQ29sb3JQaWNrZXKQsFN0cnVjdEJvbmRTZWxlY3SR2SRiZDVlYzA4Ni01MTU2LTRlN2MtYTcwYi01Y2E5ZjA4OWJiNDmqRGF0ZVBpY2tlcpCzUmFuZ2VTbGlkZXJOb3RlYm9va5C1TXVsdGlDaGVja0JveE5vdGVib29rkKRAaHRsktkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKpQGJpbmRuYW1lkLdFeHRlbmRlZFRhYmxlT2ZDb250ZW50c5HZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M61XaXRoSU9Db250ZXh0kKlCb25kVGFibGWR2SQ5MDNmZWU2Ny02YjIzLTQxZGMtYTAzZC1mMTA0MGI2OTZiZTauQHBvcG91dGFzZmllbGSR2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDiqQGZpZWxkYm9uZJCnQE5UQm9uZJfZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOdkkNzg1NTgyNmUtY2NhYS00YzI3LWEwNjAtZjVjZWI5MjdiYmU42SQwMmU1ODAxMi01YWY2LTRiOTEtYTlhNC0wOWM5ZGMwMzhmMTHZJDM2ZmFmMThjLTExYzMtNDAxMi1hOTk2LTU1YzdjZGFlNzFhONkkM2MyYzI1N2UtYmJlZS00YTA0LWIzYmEtNjhmMjM4MmZjZTg32SRjZjgwN2NiMy01ZDc1LTQwNDAtYmZkMS0wNWZlNzBkMjZlODnZJGJkNWVjMDg2LTUxNTYtNGU3Yy1hNzBiLTVjYTlmMDg5YmI0OadkZXRhaWxzkKpTdHJ1Y3RCb25kktkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ4NmE4MDIyOC1mNDk1LTQzZTgtYjFkNC1jOTNiN2I1MmM4ZDitTG9jYWxSZXNvdXJjZZCpVGltZUZpZWxkkLNXZWJjYW1JbnB1dE5vdGVib29rkK1QYXNzd29yZEZpZWxkkLVfUHJldmlvdXNfQ29udHJvbGxlcl+QqENoZWNrQm94kK1NdWx0aUNoZWNrQm94kKhSZXNvdXJjZZCqRmlsZVBpY2tlcpCwSHlwZXJ0ZXh0TGl0ZXJhbJLZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyslNjcnViYmFibGVOb3RlYm9va5CnYXNfaHRtbJCmU2VsZWN0kKpTY3J1YmJhYmxlk9kkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDYzZDZjMmRmLWE0MTEtNDA3Yy1hZjExLTRmNWQwOWZiYjMyMrJ1cHN0cmVhbV9jZWxsc19tYXCNvUJhc2UuQ29yZUxvZ2dpbmcuaW52b2tlbGF0ZXN0kLRCYXNlLkNvcmVMb2dnaW5nLj09PZCqQmFzZS50aHJvd5C6I19fX3RoaXNfcGx1dG9fbW9kdWxlX25hbWWQp3JldGhyb3eQskJhc2UuQ29yZUxvZ2dpbmcuIZDZJ0Jhc2UuQ29yZUxvZ2dpbmcuQmFzZS5maXh1cF9zdGRsaWJfcGF0aJCkQmFzZZC0QmFzZS5Db3JlTG9nZ2luZy5pc2GQsUJhc2UuaW52b2tlbGF0ZXN0kKxAZnJvbXBhY2thZ2WQs0Jhc2UuQ29yZUxvZ2dpbmcuPj2Qs0Jhc2UuQXNzZXJ0aW9uRXJyb3KQ2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzeEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYze0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SRlMmI3OWE1OC1lNjZlLTRkNDAtODY3My00MTg4MjM3NTNiMziEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRlMmI3OWE1OC1lNjZlLTRkNDAtODY3My00MTg4MjM3NTNiMzi0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGibnSR2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjnZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN4S0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN7Rkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N4S0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N7Rkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaNhbHSR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmOYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDBkYjUxZDM5LTdjMDUtNGUwMC1iOTUxLTdmZTc3NmE4ZTBmObRkb3duc3RyZWFtX2NlbGxzX21hcIKnbnRfYm9uZJLZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2om50k9kkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM42SQ5OTZiNDA4NS0xMTRjLTQ4ZjQtOWY5MC04ZTYzN2YyOWMwNmHZJDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZrJ1cHN0cmVhbV9jZWxsc19tYXDeABGnQG1kX3N0cpCtQmFzZS5nZXRpbmRleJCnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6E6kNkjUGx1dG9SdW5uZXIuUGx1dG9SdW5uZXIuY3JlYXRlX2JvbmSQpWVycm9ykKVAYmluZJCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpE1haW6Q2UVNYWluLndvcmtzcGFjZSM0NjEuIyNUZW1wTW9kdWxlIzIzOTUuUGx1dG9FeHRyYXMuU3RydWN0Qm9uZE1vZHVsZS5pc2GQq1BsdXRvUnVubmVykLRQbHV0b1J1bm5lci5CYXNlLmdldJCkQmFzZZCjVmFskKRUeXBlkLtQbHV0b1J1bm5lci5Db3JlLmFwcGxpY2FibGWQqGhhc2ZpZWxkkNkkNWJiMjJmMDctZmJlYS00NGFiLTk3ODMtOWNhMTZlMGRhMTFlhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNWJiMjJmMDctZmJlYS00NGFiLTk3ODMtOWNhMTZlMGRhMTFltGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRkhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRktGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCA2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmO0ZG93bnN0cmVhbV9jZWxsc19tYXCDo2FsdJLZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYtkkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2pGZyZXGS2SRhNTQ5MGE2Yi1kYzExLTQyYjctODdlMC1kMzg4NzBmYzU1ZTTZJDI2ZDExNjAwLTI4MjctNGUwOC05MTk1LTEwOWM4YThiZGRjM6JibJHZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNrJ1cHN0cmVhbV9jZWxsc19tYXCOp0BtZF9zdHKQrUJhc2UuZ2V0aW5kZXiQqkBCb25kc0xpc3SR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOhOpDZI1BsdXRvUnVubmVyLlBsdXRvUnVubmVyLmNyZWF0ZV9ib25kkKdQbHV0b1VJkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpUBiaW5kkKhFZGl0YWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6RCYXNlkKtQbHV0b1J1bm5lcpC0UGx1dG9SdW5uZXIuQmFzZS5nZXSQoSqQu1BsdXRvUnVubmVyLkNvcmUuYXBwbGljYWJsZZCqU2NydWJiYWJsZZHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM9kkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBo2FsdJHZJDRkNjExNDI1LWM4ZTMtNGJjMy05MTJiLThiYzA0NjUzNjNiY9kkNDY2OTk1YTItZGZkNC00Mzc0LTgzMzktYmMwMjMyMDM5YjI3hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNDY2OTk1YTItZGZkNC00Mzc0LTgzMzktYmMwMjMyMDM5YjI3tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkMjc5Nzc1MjYtNzVkYy00NGMzLTk5NzYtYzIyZThjYmQ5NGRhhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMjc5Nzc1MjYtNzVkYy00NGMzLTk5NzYtYzIyZThjYmQ5NGRhtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBp2F0YW52YWyR2SQzNmZhZjE4Yy0xMWMzLTQwMTItYTk5Ni01NWM3Y2RhZTcxYTjZJGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDAyZTU4MDEyLTVhZjYtNGI5MS1hOWE0LTA5YzlkYzAzOGYxMYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDAyZTU4MDEyLTVhZjYtNGI5MS1hOWE0LTA5YzlkYzAzOGYxMbRkb3duc3RyZWFtX2NlbGxzX21hcIG2dHJhbnNmb3JtX3NpbmdsZV9maWVsZJHZJGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YbJ1cHN0cmVhbV9jZWxsc19tYXDeABOnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6E6kNkjUGx1dG9SdW5uZXIuUGx1dG9SdW5uZXIuY3JlYXRlX2JvbmSQpWVycm9ykKdkZWcycmFkkKVAYmluZJCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzo0B0dpCkTWFpbpDZRU1haW4ud29ya3NwYWNlIzQ2MS4jI1RlbXBNb2R1bGUjMjM5NS5QbHV0b0V4dHJhcy5TdHJ1Y3RCb25kTW9kdWxlLmlzYZCrUGx1dG9SdW5uZXKQtFBsdXRvUnVubmVyLkJhc2UuZ2V0kKNWYWyQoV6QpFR5cGWQoSuQrXNpbXBsZV9zbGlkZXKR2SQ1NDM4ZTllNy1jMGY3LTQ1MjMtODY4Mi1mZmI4MjIzNTlkNTC7UGx1dG9SdW5uZXIuQ29yZS5hcHBsaWNhYmxlkKhoYXNmaWVsZJDZJDU2NDk2OGZlLTBhNjgtNDhiYy05ZTExLWM3NzMyZTJiYWUwNIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDU2NDk2OGZlLTBhNjgtNDhiYy05ZTExLWM3NzMyZTJiYWUwNLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgbh0dXBsZV9kZXNjcmlwdGlvbl9udGJvbmSR2SRjZjgwN2NiMy01ZDc1LTQwNDAtYmZkMS0wNWZlNzBkMjZlODnZJDM2ZmFmMThjLTExYzMtNDAxMi1hOTk2LTU1YzdjZGFlNzFhOIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDM2ZmFmMThjLTExYzMtNDAxMi1hOTk2LTU1YzdjZGFlNzFhOLRkb3duc3RyZWFtX2NlbGxzX21hcIKrbWF0aF9udGJvbmSQp2F0YW52YWyR2SQyNzk3NzUyNi03NWRjLTQ0YzMtOTk3Ni1jMjJlOGNiZDk0ZGGydXBzdHJlYW1fY2VsbHNfbWFw3gASp0BtZF9zdHKQrUJhc2UuZ2V0aW5kZXiQp0BOVEJvbmSR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOhOpDZI1BsdXRvUnVubmVyLlBsdXRvUnVubmVyLmNyZWF0ZV9ib25kkKVlcnJvcpCxbWFya2Rvd25fZnVuY3Rpb26R2SRiYjA0YWMxMi0yMGEwLTQ2N2EtYWYxYS1jMjk4MzAxZTQ4MzilQGJpbmSQplNsaWRlcpHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6RNYWlukNlFTWFpbi53b3Jrc3BhY2UjNDYxLiMjVGVtcE1vZHVsZSMyMzk1LlBsdXRvRXh0cmFzLlN0cnVjdEJvbmRNb2R1bGUuaXNhkKtQbHV0b1J1bm5lcpC0UGx1dG9SdW5uZXIuQmFzZS5nZXSQpEJhc2WQo1ZhbJCkVHlwZZC7UGx1dG9SdW5uZXIuQ29yZS5hcHBsaWNhYmxlkKhoYXNmaWVsZJDZJDc4NTNjYzdmLTRlNTgtNDRkMS04ZDNiLWY4ZDQ3NDU1NjRlNoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDc4NTNjYzdmLTRlNTgtNDRkMS04ZDNiLWY4ZDQ3NDU1NjRlNrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaNzYnOR2SRiZDVlYzA4Ni01MTU2LTRlN2MtYTcwYi01Y2E5ZjA4OWJiNDnZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGNkYzBhN2FkLWEzYWMtNDI3MC1iNzA3LTM1YjE5MzlkYTI3NrRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaNhc2SR2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2bZJDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlOIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlOLRkb3duc3RyZWFtX2NlbGxzX21hcIG5dHJhbnNmb3JtZWRfdmFsdWVfZXhhbXBsZZHZJDFkNTU3M2VlLTg3MmUtNGRmYi1hNzg1LTFhYzllODM2YWQ5OLJ1cHN0cmVhbV9jZWxsc19tYXDeABKnQG1kX3N0cpCtQmFzZS5nZXRpbmRleJCnQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6E6kNkjUGx1dG9SdW5uZXIuUGx1dG9SdW5uZXIuY3JlYXRlX2JvbmSQpWVycm9ykKVAYmluZJCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpE1haW6Q2UVNYWluLndvcmtzcGFjZSM0NjEuIyNUZW1wTW9kdWxlIzIzOTUuUGx1dG9FeHRyYXMuU3RydWN0Qm9uZE1vZHVsZS5pc2GQq1BsdXRvUnVubmVykLRQbHV0b1J1bm5lci5CYXNlLmdldJCkQmFzZZCjVmFskKRUeXBlkKErkLtQbHV0b1J1bm5lci5Db3JlLmFwcGxpY2FibGWQqGhhc2ZpZWxkkNkkZjY1YjMyMzEtZjJiMi00NWRjLWI3MmUtMWFkMzEwNzA4M2ZjhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkZjY1YjMyMzEtZjJiMi00NWRjLWI3MmUtMWFkMzEwNzA4M2ZjtGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCCp0BtZF9zdHKQqGdldGluZGV4kNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCHt3Nob3dfb3V0cHV0X3doZW5faGlkZGVukdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzp250X2JvbmSR2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjmjYmxjkdkkODExY2Y3OGItZTg3MC00NWJiLTkxNzMtODlhM2IzZDQ5NWY1onw+kKlCb25kVGFibGWR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOoYXNkX2JvbmSR2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2aiYmyR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZoS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZrRkb3duc3RyZWFtX2NlbGxzX21hcIardHlwZWFzZmllbGSQqWZpZWxkYm9uZJCwZmllbGRkZXNjcmlwdGlvbpCjYXNkk9kkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc22SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTbZJDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3OKhhc2RfYm9uZJLZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2o0FTRJCydXBzdHJlYW1fY2VsbHNfbWFw3gAdp0BtZF9zdHKQqGhhc2ZpZWxkkNkjUGx1dG9SdW5uZXIuUGx1dG9SdW5uZXIuY3JlYXRlX2JvbmSQplN0cmluZ5CkQGh0bJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6lUZXh0RmllbGSR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOrUGx1dG9SdW5uZXKQtFBsdXRvUnVubmVyLkJhc2UuZ2V0kKpAZmllbGRkYXRhkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzt0h5cGVydGV4dExpdGVyYWwuUmVzdWx0kLtQbHV0b1J1bm5lci5Db3JlLmFwcGxpY2FibGWQpEBkb2OQrUJhc2UuZ2V0aW5kZXiQoTqQpWVycm9ykLdIeXBlcnRleHRMaXRlcmFsLkJ5cGFzc5CqU3RydWN0Qm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6VAYmluZJC6I19fX3RoaXNfcGx1dG9fbW9kdWxlX25hbWWQq0Jhc2UuQGt3ZGVmkKZTbGlkZXKR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkQmFzZZCjVmFskKNJbnSQsEh5cGVydGV4dExpdGVyYWyR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkVHlwZZClVW5pb26QrEB0eXBlYXNmaWVsZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6pTY3J1YmJhYmxlkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NziEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5Nzi0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGjYXNkkdkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDaEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQwNjViYWQ3My01ZmE4LTQ0OTYtYmEzMy05ZTY2OTQwYjU4MDa0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIGnbG9sX3BvcJHZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NNkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMzhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMztGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBpGZyZXGR2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJGNmODA3Y2IzLTVkNzUtNDA0MC1iZmQxLTA1ZmU3MGQyNmU4OYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGNmODA3Y2IzLTVkNzUtNDA0MC1iZmQxLTA1ZmU3MGQyNmU4ObRkb3duc3RyZWFtX2NlbGxzX21hcIG4dHVwbGVfZGVzY3JpcHRpb25fbnRib25kkdkkNTY0OTY4ZmUtMGE2OC00OGJjLTllMTEtYzc3MzJlMmJhZTA0snVwc3RyZWFtX2NlbGxzX21hcIynQE5UQm9uZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6E6kK5CYXNlLkRvY3MuSFRNTJCpQGh0bWxfc3RykKVlcnJvcpCmU2xpZGVykdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpE1haW6Q2UVNYWluLndvcmtzcGFjZSM0NjEuIyNUZW1wTW9kdWxlIzIzOTUuUGx1dG9FeHRyYXMuU3RydWN0Qm9uZE1vZHVsZS5pc2GQpEJhc2WQo1ZhbJCkVHlwZZCoaGFzZmllbGSQ2SRmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTKEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SRmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTK0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGGEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGG0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTKEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTK0ZG93bnN0cmVhbV9jZWxsc19tYXCAsnVwc3RyZWFtX2NlbGxzX21hcIKnQG1kX3N0cpCoZ2V0aW5kZXiQ2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGaEtHByZWNlZGVuY2VfaGV1cmlzdGljB6djZWxsX2lk2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGa0ZG93bnN0cmVhbV9jZWxsc19tYXCCrlBsdXRvRGV2TWFjcm9zkKxMYVRlWFN0cmluZ3OQsnVwc3RyZWFtX2NlbGxzX21hcIDZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOLRkb3duc3RyZWFtX2NlbGxzX21hcISjQk9IkKt0eXBlYXNmaWVsZJCjTUFIkKNib2iR2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjSydXBzdHJlYW1fY2VsbHNfbWFwjaE6kKpTdHJ1Y3RCb25kkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SNQbHV0b1J1bm5lci5QbHV0b1J1bm5lci5jcmVhdGVfYm9uZJClQGJpbmSQplNsaWRlcpHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6tQbHV0b1J1bm5lcpC0UGx1dG9SdW5uZXIuQmFzZS5nZXSQpkBrd2RlZpCjSW50kKRUeXBlkK5AcG9wb3V0YXNmaWVsZJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6xAdHlwZWFzZmllbGSR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDO7UGx1dG9SdW5uZXIuQ29yZS5hcHBsaWNhYmxlkNkkMWQ1NTczZWUtODcyZS00ZGZiLWE3ODUtMWFjOWU4MzZhZDk4hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkMWQ1NTczZWUtODcyZS00ZGZiLWE3ODUtMWFjOWU4MzZhZDk4tGRvd25zdHJlYW1fY2VsbHNfbWFwgLJ1cHN0cmVhbV9jZWxsc19tYXCBuXRyYW5zZm9ybWVkX3ZhbHVlX2V4YW1wbGWR2SQ3ODU1ODI2ZS1jY2FhLTRjMjctYTA2MC1mNWNlYjkyN2JiZTjZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNbRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNYS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNbRkb3duc3RyZWFtX2NlbGxzX21hcIGjYmxjkdkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2snVwc3RyZWFtX2NlbGxzX21hcIWqQEJvbmRzTGlzdJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6dudF9ib25kkdkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5plBvcG91dJHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6hzYnNfYm9uZJHZJGJkNWVjMDg2LTUxNTYtNGU3Yy1hNzBiLTVjYTlmMDg5YmI0Oahhc2RfYm9uZJHZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyhLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIytGRvd25zdHJlYW1fY2VsbHNfbWFwg6lmaWVsZGJvbmSQsGZpZWxkZGVzY3JpcHRpb26Qo0xPTJHZJDYzMzAyOWFmLThjYWMtNDI2ZS1iMzVjLWM5ZmIzOTM4Yjc4NLJ1cHN0cmVhbV9jZWxsc19tYXDeABGnQG1kX3N0cpCtQmFzZS5nZXRpbmRleJChOpCoaGFzZmllbGSQpWVycm9ykLdIeXBlcnRleHRMaXRlcmFsLkJ5cGFzc5CrQmFzZS5Aa3dkZWaQplNsaWRlcpHZJDk0OWFjMWVmLWM1MDItNGUyOC04MWZmLWY5OWIwZDE5YWEwM6RAaHRskdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzpEJhc2WQqkBmaWVsZGRhdGGR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOjVmFskKNJbnSQpFR5cGWQsEh5cGVydGV4dExpdGVyYWyR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDO3SHlwZXJ0ZXh0TGl0ZXJhbC5SZXN1bHSQqlNjcnViYmFibGWR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJDZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNLRkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgaRmcmVxkdkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2Jj2SQ1NDM4ZTllNy1jMGY3LTQ1MjMtODY4Mi1mZmI4MjIzNTlkNTCEtHByZWNlZGVuY2VfaGV1cmlzdGljCadjZWxsX2lk2SQ1NDM4ZTllNy1jMGY3LTQ1MjMtODY4Mi1mZmI4MjIzNTlkNTC0ZG93bnN0cmVhbV9jZWxsc19tYXCBrXNpbXBsZV9zbGlkZXKR2SQwMmU1ODAxMi01YWY2LTRiOTEtYTlhNC0wOWM5ZGMwMzhmMTGydXBzdHJlYW1fY2VsbHNfbWFwgqE6kKZTbGlkZXKR2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJGJiMDRhYzEyLTIwYTAtNDY3YS1hZjFhLWMyOTgzMDFlNDgzOIS0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGJiMDRhYzEyLTIwYTAtNDY3YS1hZjFhLWMyOTgzMDFlNDgzOLRkb3duc3RyZWFtX2NlbGxzX21hcIGxbWFya2Rvd25fZnVuY3Rpb26R2SQzNmZhZjE4Yy0xMWMzLTQwMTItYTk5Ni01NWM3Y2RhZTcxYTiydXBzdHJlYW1fY2VsbHNfbWFwgqRhdGFukKErkNkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0hLRwcmVjZWRlbmNlX2hldXJpc3RpYwmnY2VsbF9pZNkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0tGRvd25zdHJlYW1fY2VsbHNfbWFwgadsb2xfcG9wkdkkMDY1YmFkNzMtNWZhOC00NDk2LWJhMzMtOWU2Njk0MGI1ODA2snVwc3RyZWFtX2NlbGxzX21hcImkQ29yZZCkQmFzZZC3UGx1dG9SdW5uZXIuY3JlYXRlX2JvbmSQq1BsdXRvUnVubmVykKpwb3BvdXR3cmFwkdkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzr0NvcmUuYXBwbGljYWJsZZClQGJpbmSQqEJhc2UuZ2V0kKNMT0yR2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjLZJGRhM2FlMzQ4LTA4M2QtNGE3ZC1hYWJkLWQwYmMyNWIzY2ExN4S0cHJlY2VkZW5jZV9oZXVyaXN0aWMJp2NlbGxfaWTZJGRhM2FlMzQ4LTA4M2QtNGE3ZC1hYWJkLWQwYmMyNWIzY2ExN7Rkb3duc3RyZWFtX2NlbGxzX21hcICydXBzdHJlYW1fY2VsbHNfbWFwgqdAbWRfc3RykKhnZXRpbmRleJC0Y2VsbF9leGVjdXRpb25fb3JkZXLcADzZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZtkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAz2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGHZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M9kkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRk2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzDZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMNkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzbZJGZlODkxYjRlLWY0NDAtNDgyMy1iNDNiLTcyNTcyZjZhNmMxMtkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ42SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjTZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNdkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQw2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjnZJGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzONkkNDY2OTk1YTItZGZkNC00Mzc0LTgzMzktYmMwMjMyMDM5YjI32SQ0Y2IxMjhhYS03YWQ4LTRkMTctYmNlZC0zNjg0NTcwM2U2YTjZJDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlONkkMWQ1NTczZWUtODcyZS00ZGZiLWE3ODUtMWFjOWU4MzZhZDk42SQ1YmIyMmYwNy1mYmVhLTQ0YWItOTc4My05Y2ExNmUwZGExMWXZJDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MNkkNTQzOGU5ZTctYzBmNy00NTIzLTg2ODItZmZiODIyMzU5ZDUw2SQwMmU1ODAxMi01YWY2LTRiOTEtYTlhNC0wOWM5ZGMwMzhmMTHZJGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YdkkOGViMThjN2YtYmI0ZC00Y2RjLTllMzAtZDU2MWY5MDk5ODAw2SQwNTJiOGJiZC1hY2NhLTRjMDAtYTVkZS0wYzcxN2VkMDY4ZTPZJGJiMDRhYzEyLTIwYTAtNDY3YS1hZjFhLWMyOTgzMDFlNDgzONkkMzZmYWYxOGMtMTFjMy00MDEyLWE5OTYtNTVjN2NkYWU3MWE42SQyNzk3NzUyNi03NWRjLTQ0YzMtOTk3Ni1jMjJlOGNiZDk0ZGHZJGRhM2FlMzQ4LTA4M2QtNGE3ZC1hYWJkLWQwYmMyNWIzY2ExN9kkM2MyYzI1N2UtYmJlZS00YTA0LWIzYmEtNjhmMjM4MmZjZTg32SRjNDNjOGE2NS0zZjk0LTQ1ZjktYjYzMy03MWNhZGUwOWI2NjbZJGNmODA3Y2IzLTVkNzUtNDA0MC1iZmQxLTA1ZmU3MGQyNmU4OdkkNTY0OTY4ZmUtMGE2OC00OGJjLTllMTEtYzc3MzJlMmJhZTA02SRmNjViMzIzMS1mMmIyLTQ1ZGMtYjcyZS0xYWQzMTA3MDgzZmPZJDY3YzA4NjBiLWI0YzEtNDEyZC04NzBhLWE0Y2U0OTg3NDY1ZdkkYmQ1ZWMwODYtNTE1Ni00ZTdjLWE3MGItNWNhOWYwODliYjQ52SQ3ODUzY2M3Zi00ZTU4LTQ0ZDEtOGQzYi1mOGQ0NzQ1NTY0ZTbZJDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjN9kkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ32SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNNkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZi2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2PZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIy2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODTZJDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNtkkMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk32SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjXZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNtkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZh2SQzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDXZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU22SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWbZJDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3ONkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMz2SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDa0bGFzdF9ob3RfcmVsb2FkX3RpbWXLAAAAAAAAAACpc2hvcnRwYXRos3N0cnVjdGJvbmRtb2R1bGUuamyucHJvY2Vzc19zdGF0dXOlcmVhZHmkcGF0aNlPL2hvbWUvYW1lbmdhbGkvUmVwb3MvZ2l0aHViL21pbmUvUGx1dG9FeHRyYXMvdGVzdC9ub3RlYm9va3Mvc3RydWN0Ym9uZG1vZHVsZS5qbK1wbHV0b192ZXJzaW9uqHYwLjIwLjE3rmxhc3Rfc2F2ZV90aW1ly0HaNkBADJIUqmNlbGxfb3JkZXLcADzZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YdkkOGRiODJlOTQtNWM4MS00YzUyLTkyMjgtN2UyMjM5NWZiNjhm2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDPZJDcwNzE3NWE5LWQzNTYtNDNjZi04MDM4LTYyMGViYzQwMWM5M9kkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRk2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzDZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMNkkOWUzNjAxZjUtZWZjMi00NGU5LTgzZDgtNWI2NWNlN2U5Y2Nm2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzbZJGZlODkxYjRlLWY0NDAtNDgyMy1iNDNiLTcyNTcyZjZhNmMxMtkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ42SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjTZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNdkkOGNjNTNjZDItOTExNC00MDY3LWFiMGItMzdmZDhjZDc5MjQw2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjnZJGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzONkkNDY2OTk1YTItZGZkNC00Mzc0LTgzMzktYmMwMjMyMDM5YjI32SQ0Y2IxMjhhYS03YWQ4LTRkMTctYmNlZC0zNjg0NTcwM2U2YTjZJDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlONkkMWQ1NTczZWUtODcyZS00ZGZiLWE3ODUtMWFjOWU4MzZhZDk42SQ1YmIyMmYwNy1mYmVhLTQ0YWItOTc4My05Y2ExNmUwZGExMWXZJDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MNkkNTQzOGU5ZTctYzBmNy00NTIzLTg2ODItZmZiODIyMzU5ZDUw2SQwMmU1ODAxMi01YWY2LTRiOTEtYTlhNC0wOWM5ZGMwMzhmMTHZJGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YdkkOGViMThjN2YtYmI0ZC00Y2RjLTllMzAtZDU2MWY5MDk5ODAw2SQwNTJiOGJiZC1hY2NhLTRjMDAtYTVkZS0wYzcxN2VkMDY4ZTPZJGJiMDRhYzEyLTIwYTAtNDY3YS1hZjFhLWMyOTgzMDFlNDgzONkkMzZmYWYxOGMtMTFjMy00MDEyLWE5OTYtNTVjN2NkYWU3MWE42SQyNzk3NzUyNi03NWRjLTQ0YzMtOTk3Ni1jMjJlOGNiZDk0ZGHZJGRhM2FlMzQ4LTA4M2QtNGE3ZC1hYWJkLWQwYmMyNWIzY2ExN9kkM2MyYzI1N2UtYmJlZS00YTA0LWIzYmEtNjhmMjM4MmZjZTg32SRjNDNjOGE2NS0zZjk0LTQ1ZjktYjYzMy03MWNhZGUwOWI2NjbZJGNmODA3Y2IzLTVkNzUtNDA0MC1iZmQxLTA1ZmU3MGQyNmU4OdkkNTY0OTY4ZmUtMGE2OC00OGJjLTllMTEtYzc3MzJlMmJhZTA02SRmNjViMzIzMS1mMmIyLTQ1ZGMtYjcyZS0xYWQzMTA3MDgzZmPZJDY3YzA4NjBiLWI0YzEtNDEyZC04NzBhLWE0Y2U0OTg3NDY1ZdkkYmQ1ZWMwODYtNTE1Ni00ZTdjLWE3MGItNWNhOWYwODliYjQ52SQ3ODUzY2M3Zi00ZTU4LTQ0ZDEtOGQzYi1mOGQ0NzQ1NTY0ZTbZJDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjN9kkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ32SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmPZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNNkkNzA1ZTMwZmUtNzdhMy00YjA2LThiOTktMTgwNzI5MGVkZmZi2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2PZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIy2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODTZJDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNtkkMjA3M2YxMWUtODE5Ni00ZWJjLTkyMmYtNWZhNTg5ZTkxNzk32SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjXZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNtkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZh2SQzYTA2NmJmNC0zNDY2LTQ2OWUtOTBkMC02YjE0YmUzZWQ4ZDXZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU22SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWbZJDAzZTlkNzVlLWU2YzktNDE5OS05MzNiLTJiZTMwNmRhZjk3ONkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMz2SRiZTJhNzgyMC1lMTk0LTQ0MTAtYjAwZC1hOTMzMmIyMzRhZDaxcHVibGlzaGVkX29iamVjdHOApW5icGtniq9pbnN0YWxsX3RpbWVfbnPPAAAAAYIuez+saW5zdGFudGlhdGVkw7JpbnN0YWxsZWRfdmVyc2lvbnOCrlBsdXRvRGV2TWFjcm9zpTAuOS4xrExhVGVYU3RyaW5nc6UxLjQuMLB0ZXJtaW5hbF9vdXRwdXRzhapuYnBrZ19zeW5j2gIJChtbMG0bWzFtQWRkaW5nIHBhY2thZ2VzLi4uG1syMm0KG1s5MG09PT0bWzM5bQobWzMybRtbMW0gICBSZXNvbHZpbmcbWzIybRtbMzltIHBhY2thZ2UgdmVyc2lvbnMuLi4KG1szMm0bWzFtICAgIFVwZGF0aW5nG1syMm0bWzM5bSBgL3RtcC9qbF94dVNhSUYvUHJvamVjdC50b21sYAogIBtbOTBtW2I5NjRmYTlmXSAbWzM5bRtbOTJtKyBMYVRlWFN0cmluZ3MgdjEuNC4wG1szOW0KG1szMm0bWzFtICAgIFVwZGF0aW5nG1syMm0bWzM5bSBgL3RtcC9qbF94dVNhSUYvTWFuaWZlc3QudG9tbGAKICAbWzkwbVtiOTY0ZmE5Zl0gG1szOW0bWzkybSsgTGFUZVhTdHJpbmdzIHYxLjQuMBtbMzltChtbMzJtG1sxbUxvYWRpbmcbWzIybRtbMzltIHBhY2thZ2VzLi4uCgobWzBtG1sxbUluc3RhbnRpYXRpbmcuLi4bWzIybQobWzkwbT09PRtbMzltCgobWzBtG1sxbVByZWNvbXBpbGluZy4uLhtbMjJtChtbOTBtPT09G1szOW0KG1szMm0bWzFtICBBY3RpdmF0aW5nG1syMm0bWzM5bSBwcm9qZWN0IGF0IGAvdG1wL2psX3h1U2FJRmCuUGx1dG9EZXZNYWNyb3PaAWoKG1swbRtbMW1SZXNvbHZpbmcuLi4bWzIybQobWzkwbT09PRtbMzltChtbMzJtG1sxbU5vIHBhY2thZ2VzIGFkZGVkIHRvIG9yIHJlbW92ZWQgZnJvbRtbMjJtG1szOW0gYC90bXAvamxfeHVTYUlGL1Byb2plY3QudG9tbGAKG1szMm0bWzFtTm8gcGFja2FnZXMgYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tG1syMm0bWzM5bSBgL3RtcC9qbF94dVNhSUYvTWFuaWZlc3QudG9tbGAKChtbMG0bWzFtSW5zdGFudGlhdGluZy4uLhtbMjJtChtbOTBtPT09G1szOW0KChtbMG0bWzFtUHJlY29tcGlsaW5nLi4uG1syMm0KG1s5MG09PT0bWzM5bQobWzMybRtbMW0gIEFjdGl2YXRpbmcbWzIybRtbMzltIHByb2plY3QgYXQgYC90bXAvamxfeHVTYUlGYKFe2gIJChtbMG0bWzFtQWRkaW5nIHBhY2thZ2VzLi4uG1syMm0KG1s5MG09PT0bWzM5bQobWzMybRtbMW0gICBSZXNvbHZpbmcbWzIybRtbMzltIHBhY2thZ2UgdmVyc2lvbnMuLi4KG1szMm0bWzFtICAgIFVwZGF0aW5nG1syMm0bWzM5bSBgL3RtcC9qbF94dVNhSUYvUHJvamVjdC50b21sYAogIBtbOTBtW2I5NjRmYTlmXSAbWzM5bRtbOTJtKyBMYVRlWFN0cmluZ3MgdjEuNC4wG1szOW0KG1szMm0bWzFtICAgIFVwZGF0aW5nG1syMm0bWzM5bSBgL3RtcC9qbF94dVNhSUYvTWFuaWZlc3QudG9tbGAKICAbWzkwbVtiOTY0ZmE5Zl0gG1szOW0bWzkybSsgTGFUZVhTdHJpbmdzIHYxLjQuMBtbMzltChtbMzJtG1sxbUxvYWRpbmcbWzIybRtbMzltIHBhY2thZ2VzLi4uCgobWzBtG1sxbUluc3RhbnRpYXRpbmcuLi4bWzIybQobWzkwbT09PRtbMzltCgobWzBtG1sxbVByZWNvbXBpbGluZy4uLhtbMjJtChtbOTBtPT09G1szOW0KG1szMm0bWzFtICBBY3RpdmF0aW5nG1syMm0bWzM5bSBwcm9qZWN0IGF0IGAvdG1wL2psX3h1U2FJRmChPtoCCQobWzBtG1sxbUFkZGluZyBwYWNrYWdlcy4uLhtbMjJtChtbOTBtPT09G1szOW0KG1szMm0bWzFtICAgUmVzb2x2aW5nG1syMm0bWzM5bSBwYWNrYWdlIHZlcnNpb25zLi4uChtbMzJtG1sxbSAgICBVcGRhdGluZxtbMjJtG1szOW0gYC90bXAvamxfeHVTYUlGL1Byb2plY3QudG9tbGAKICAbWzkwbVtiOTY0ZmE5Zl0gG1szOW0bWzkybSsgTGFUZVhTdHJpbmdzIHYxLjQuMBtbMzltChtbMzJtG1sxbSAgICBVcGRhdGluZxtbMjJtG1szOW0gYC90bXAvamxfeHVTYUlGL01hbmlmZXN0LnRvbWxgCiAgG1s5MG1bYjk2NGZhOWZdIBtbMzltG1s5Mm0rIExhVGVYU3RyaW5ncyB2MS40LjAbWzM5bQobWzMybRtbMW1Mb2FkaW5nG1syMm0bWzM5bSBwYWNrYWdlcy4uLgoKG1swbRtbMW1JbnN0YW50aWF0aW5nLi4uG1syMm0KG1s5MG09PT0bWzM5bQoKG1swbRtbMW1QcmVjb21waWxpbmcuLi4bWzIybQobWzkwbT09PRtbMzltChtbMzJtG1sxbSAgQWN0aXZhdGluZxtbMjJtG1szOW0gcHJvamVjdCBhdCBgL3RtcC9qbF94dVNhSUZgrExhVGVYU3RyaW5nc9oCCQobWzBtG1sxbUFkZGluZyBwYWNrYWdlcy4uLhtbMjJtChtbOTBtPT09G1szOW0KG1szMm0bWzFtICAgUmVzb2x2aW5nG1syMm0bWzM5bSBwYWNrYWdlIHZlcnNpb25zLi4uChtbMzJtG1sxbSAgICBVcGRhdGluZxtbMjJtG1szOW0gYC90bXAvamxfeHVTYUlGL1Byb2plY3QudG9tbGAKICAbWzkwbVtiOTY0ZmE5Zl0gG1szOW0bWzkybSsgTGFUZVhTdHJpbmdzIHYxLjQuMBtbMzltChtbMzJtG1sxbSAgICBVcGRhdGluZxtbMjJtG1szOW0gYC90bXAvamxfeHVTYUlGL01hbmlmZXN0LnRvbWxgCiAgG1s5MG1bYjk2NGZhOWZdIBtbMzltG1s5Mm0rIExhVGVYU3RyaW5ncyB2MS40LjAbWzM5bQobWzMybRtbMW1Mb2FkaW5nG1syMm0bWzM5bSBwYWNrYWdlcy4uLgoKG1swbRtbMW1JbnN0YW50aWF0aW5nLi4uG1syMm0KG1s5MG09PT0bWzM5bQoKG1swbRtbMW1QcmVjb21waWxpbmcuLi4bWzIybQobWzkwbT09PRtbMzltChtbMzJtG1sxbSAgQWN0aXZhdGluZxtbMjJtG1szOW0gcHJvamVjdCBhdCBgL3RtcC9qbF94dVNhSUZgp2VuYWJsZWTDt3Jlc3RhcnRfcmVjb21tZW5kZWRfbXNnwLRyZXN0YXJ0X3JlcXVpcmVkX21zZ8CtYnVzeV9wYWNrYWdlc5C2d2FpdGluZ19mb3JfcGVybWlzc2lvbsLZLHdhaXRpbmdfZm9yX3Blcm1pc3Npb25fYnV0X3Byb2JhYmx5X2Rpc2FibGVkwqtjZWxsX2lucHV0c94APNkkOTk2YjQwODUtMTE0Yy00OGY0LTlmOTAtOGU2MzdmMjljMDZhhKdjZWxsX2lk2SQ5OTZiNDA4NS0xMTRjLTQ4ZjQtOWY5MC04ZTYzN2YyOWMwNmGkY29kZaJudKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMDUyYjhiYmQtYWNjYS00YzAwLWE1ZGUtMGM3MTdlZDA2OGUzhKdjZWxsX2lk2SQwNTJiOGJiZC1hY2NhLTRjMDAtYTVkZS0wYzcxN2VkMDY4ZTOkY29kZdmlbWQiIiIKVGhlIGRlc2NyaXB0aW9uIG9mIGFuIGBATlRCb25kYCBjYW4gbm93IGJlIHByb3ZpZGVkIGFzIGFueXRoaW5nIHRoYXQgaGFzIGEgdmFsaWQgYE1JTUUidGV4dC9odG1sImAgcmVwcmVzZW50YXRpb24uIFRoaXMgaW5jbHVkZXMgbWFya2Rvd24gd2l0aCBtYXRoIGluc2lkZSEKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ4Y2M1M2NkMi05MTE0LTQwNjctYWIwYi0zN2ZkOGNkNzkyNDCEp2NlbGxfaWTZJDhjYzUzY2QyLTkxMTQtNDA2Ny1hYjBiLTM3ZmQ4Y2Q3OTI0MKRjb2Rl2gGlbWQiIiIKU29tZXRpbWVzIGN1c3RvbSBzdHJ1Y3RzIGFyZSBub3QgbmVlZGVkIGFuZCBpdCB3b3VsZCBiZSB1c2VmdWwgdG8ganVzdCB1c2UgdGhlIHNhbWUgbmljZSBib25kIHN0cnVjdHVyZSBvZiBgU3RydWN0Qm9uZGAgdG8gc2ltcGx5IGNyZWF0ZSBhcmJpdHJhcnkgTmFtZWRUdXBsZXMuIAoKVGhpcyBpcyBwb3NzaWJsZSB3aXRoIHRoZSBjb252ZW5pZW5jZSBtYWNybyBgQE5UQm9uZGAgd2hpY2ggY2FuIGJlIGNhbGxlZCBhcyBzaG93biBiZWxvdyB0byBjcmVhdGUgYSBuaWNlIGRpc3BsYXkgZm9yIGFuIGludGVyYWN0aXZlIGJvbmQgY3JlYXRpbmcgYW4gYXJiaXRyYXJ5IE5hbWVkVHVwbGUuCgpUaGUgbWFjcm8gc2ltcGx5IGNyZWF0ZSBhIGBTdHJ1Y3RCb25kYCB3cmFwcGluZyB0aGUgZGVzaXJlZCBOYW1lZFR1cGxlIHR5cGUuCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkNjdjMDg2MGItYjRjMS00MTJkLTg3MGEtYTRjZTQ5ODc0NjVlhKdjZWxsX2lk2SQ2N2MwODYwYi1iNGMxLTQxMmQtODcwYS1hNGNlNDk4NzQ2NWWkY29kZdoFXW1kIiIiClNvbWV0aW1lcywgb25lIHdhbnRzIHRvIGNyZWF0ZSBhIG1vcmUgY29tcGxleCBiaW5kaW5nIHdoZXJlIHRoZSBudW1iZXIgb2YgcGFyYW1ldGVycyB0byBjb250cm9sIGEgYm9uZCBjYW4gdmFyeSBkZXBlbmRpbmcgb24gc29tZSBvdGhlciB2YXJpYWJsZS4gVGhlIGBTdHJ1Y3RCb25kU2VsZWN0YCBjYW4gYmUgb2YgaGVscCBpbiBzb21lIG9mIHRoZXNlIGNhc2VzLCBieSBwcm92aWRpbmcgYSB3YXkgdG8gc2VsZWN0IG91dCBvZiBhIG51bWJlciBvZiBhcmJpdHJhcnkgYFN0cnVjdEJvbmRzYCAod2hpY2ggaW5jbHVkZSBgQE5UQm9uZGApIGJ5IHVzaW5nIGEgZHJvcGRvd24gdG8gc2VsZWN0IHRoZSBvbmUgdG8gYmUgZGlzcGxheWVkIGFuZCB1c2VkIGZvciBnZW5lcmF0aW5nIHRoZSBgU3RydWN0Qm9uZFNlbGVjdGAgd2lkZ2V0J3Mgb3V0cHV0LgoKVGhpcyBzdHJ1Y3R1cmUgY2FuIGJlIGNvbnN0cnVjdGVkIHdpdGggYSB2ZWN0b3Igb2YgYFN0cnVjdEJvbmRgIG9yIGB0cmFuc2Zvcm1lZF92YWx1ZShmLCA6OlN0cnVjdEJvbmQpYCBlbGVtZW50cywgYW5kIHdpbGwgdGFrZSBjYXJlIG9mIGdlbmVyYXRpbmcgYW4gYXBwcm9wcmlhdGUgd2lkZ2V0IHRvIGRpc3BsYXkgYW5kIHByb2Nlc3Mgb25seSB0aGUgc2VsZWN0ZWQgb25lLgoKVGhlIG1haW4gc2lnbmF0dXJlIG9mIHRoZSBjb25zdHJ1Y3RvciBpcyB0aGUgZm9sbG93aW5nOgpgYGBqdWxpYQpTdHJ1Y3RCb25kU2VsZWN0KGVsczo6VmVjdG9yOyBkZXNjcmlwdGlvbiA9ICJTdHJ1Y3RCb25kU2VsZWN0IiwgZGVmYXVsdF9pZHggPSAxLCBzZWxlY3Rvcl90ZXh0ID0gIlNlbGVjdG9yIikKYGBgCgpUaGUgbmFtZXMgdG8gc2VsZWN0IHVwb24gd2lsbCBiZSB0YWtlbiBmcm9tIHRoZSBgZGVzY3JpcHRpb25gIG9mIHRoZSBwcm92aWRlZCBgU3RydWN0Qm9uZHNgLCB3aGlsZSB0aGUgdGV4dCBkaXNwbGF5ZWQgbmV4dCB0byB0aGUgX3NlbGVjdG9yXyB3aWxsIGRlZmF1bHQgdG8gYFNlbGVjdG9yYCBidXQgY2FuIGJlIGN1c3RvbWl6ZWQgd2l0aCB0aGUgYHNlbGVjdG9yX3RleHRgIGt3YXJnIHRvIHRoZSBjb25zdHJ1Y3Rvci4KVGhlIGBkZXNjcmlwdGlvbmAga3dhcmcgY2FuIGJlIHVzZWQgdG8gY3VzdG9taXplIHRoZSB0ZXh0IGluIHRoZSB3aWRnZXQgY29udGFpbmVyIChzaW1pbGFyIHRvIHRoZSBzYW1lIGt3YXJnIGluIGBTdHJ1Y3RCb25kYCBhbmQgdG8gYEBOVEJvbmRgKS4gRmluYWxseSwgdGhlIGBkZWZhdWx0X2lkeGAgc2hvdWxkIGJlIGFuIGludGVnZXIgYW5kIHdpbGwgc2VsZWN0IHdoaWNoIG9mIHRoZSBwcm92aWRlZCBgU3RydWN0Qm9uZGBzIHdpbGwgYmUgc2VsZWN0ZWQgYXMgZGVmYXVsdCB3aGVuIGluc3RhbnRpYXRpbmcgdGhlIHdpZGdldC4KIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQyZWU3ZjI2ZC1mMzgzLTRlN2UtYTY5YS04ZmI3MjcxNzQ2N2OEp2NlbGxfaWTZJDJlZTdmMjZkLWYzODMtNGU3ZS1hNjlhLThmYjcyNzE3NDY3Y6Rjb2Rlsm1kIiIiCiMgUG9wb3V0CiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkM2MyYzI1N2UtYmJlZS00YTA0LWIzYmEtNjhmMjM4MmZjZTg3hKdjZWxsX2lk2SQzYzJjMjU3ZS1iYmVlLTRhMDQtYjNiYS02OGYyMzgyZmNlODekY29kZdk4QE5UQm9uZChtZCJhc2QiLCBiZWdpbiBhID0gU2xpZGVyKDE6MTApIGVuZCkuZGVzY3JpcHRpb26obWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDMyMTNkOTc3LTdiNjUtNDNiMC1hODgxLTEwZmNjMjUyM2YxNISnY2VsbF9pZNkkMzIxM2Q5NzctN2I2NS00M2IwLWE4ODEtMTBmY2MyNTIzZjE0pGNvZGXaAhltZCIiIgpUaGUgZmluYWwgY29udmVuaWVuY2Ugc3RydWN0dXJlIHByb3ZpZGVkIGJ5IHRoaXMgbW9kdWxlIGlzIHRoZSBgQm9uZFRhYmxlYC4gSXQgY2FuIGJlIGNyZWF0ZWQgdG8gZ3JvdXAgYSBsaXN0IG9mIGJvbmRzIGluIGEgZmxvYXRpbmcgdGFibGUgdGhhdCBzdGF5cyBvbiB0aGUgbGVmdCBzaWRlIG9mIHRoZSBub3RlYm9vayAoc2ltaWxhciB0byB0aGUgVGFibGVPZkNvbnRlbnRzIG9mIFBsdXRvVUkpIGFuZCBjYW4gYmUgbW92ZWQgYXJvdW5kIGFuZCByZXNpemVkIG9yIGhpZGRlbiBmb3IgY29udmVuaWVuY2UuCgpUaGUgQm9uZFRhYmxlIGlzIGludGVuZGVkIHRvIGJlIHVzZWQgZWl0aGVyIHdpdGggYm9uZHMgY29udGFpbmluZyBgU3RydWN0Qm9uZGAgb3Igd2l0aCBgQm9uZHNMaXN0YC4gRnV0dXJlIHR5cGVzIHdpdGggc2ltaWxhciBzdHJ1Y3R1cmUgd2lsbCBhbHNvIGJlIGFkZGVkLgoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIGEgYm9uZHRhYmxlIGNvbnRhaW5pbmcgYWxsIHRoZSBleGFtcGxlcyBvZiB0aGlzIG5vdGVib29rLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDRjYjEyOGFhLTdhZDgtNGQxNy1iY2VkLTM2ODQ1NzAzZTZhOISnY2VsbF9pZNkkNGNiMTI4YWEtN2FkOC00ZDE3LWJjZWQtMzY4NDU3MDNlNmE4pGNvZGXaARptZCIiIgpgQE5UQm9uZGAgaXMgYWxzbyBxdWl0ZSB1c2VmdWwgaW4gY29tYmluYXRpb24gd2l0aCBgdHJhbnNmb3JtZWRfdmFsdWVgIGZyb20gYFBsdXRvVUkuRXhwZXJpbWVudGFsYC4gRm9yIHRoaXMgcmVhc29uLCB0aGUgYEBOVEJvbmRgIG1hY3JvIHN1cHBvcnRzIGFuIG9wdGlvbmFsIHRoaXJkIGFyZ3VtZW50IHdoaWNoIHNoYWxsIGJlIGEgZnVuY3Rpb24gdGhhdCB3aGVuIHByb3ZpZGVkIGlzIGRpcmVjdGx5IHVzZWQgdG8gdHJhbnNmb3JtIHRoZSB2YWx1ZSBvZiB0aGUgd2lkZ2V0LgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGJkNWVjMDg2LTUxNTYtNGU3Yy1hNzBiLTVjYTlmMDg5YmI0OYSnY2VsbF9pZNkkYmQ1ZWMwODYtNTE1Ni00ZTdjLWE3MGItNWNhOWYwODliYjQ5pGNvZGXaAdNzYnNfYm9uZCA9IEBiaW5kIHNicyBTdHJ1Y3RCb25kU2VsZWN0KFsKCUBOVEJvbmQgImNvcyhhcmcpIiBiZWdpbgoJCWFyZyA9IFNsaWRlcihyYW5nZSgwLDEsMTAwKSkKCWVuZCAobnQgLT4gY29zKG50LmFyZykpICMgV2UgbmVlZCB0byB3cmFwIHRoZSBmdW5jdGlvbiBnaXZlbiB0byBgQE5UQm9uZGAgaW4gKCkgdG8gYXZvaWQgcGFyc2UgcHJvYmxlbXMgd2hlbiBwcm92aWRpbmcgYSBmdW5jdGlvbgoJQE5UQm9uZCAiYXRhbih5LHgpIiBiZWdpbgoJCXggPSBTbGlkZXIocmFuZ2UoMCwxMDsgc3RlcCA9IDAuMSk7IGRlZmF1bHQgPSAzLCBzaG93X3ZhbHVlPXRydWUpCgkJeSA9IFNsaWRlcihyYW5nZSgwLCAxMDsgc3RlcCA9IDAuMSk7IGRlZmF1bHQgPSA1LCBzaG93X3ZhbHVlPXRydWUpCgllbmQgbnQgLT4gYXRhbihudC55LCBudC54KQpdOyBkZWZhdWx0X2lkeCA9IDIsIHNlbGVjdG9yX3RleHQgPSAiT3B0aW9uczoiKahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMjM1OGY2ODYtMTk1MC00MGY5LTlkNWMtZGFjMmQ5OGY0YzI0hKdjZWxsX2lk2SQyMzU4ZjY4Ni0xOTUwLTQwZjktOWQ1Yy1kYWMyZDk4ZjRjMjSkY29kZaNib2iobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJGUxMDI2MTNmLTI0NGMtNGI0OS05ODM3LTUzNWJmMDQ3YTE0YYSnY2VsbF9pZNkkZTEwMjYxM2YtMjQ0Yy00YjQ5LTk4MzctNTM1YmYwNDdhMTRhpGNvZGW2dHJhbnNmb3JtX3NpbmdsZV9maWVsZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOGViMThjN2YtYmI0ZC00Y2RjLTllMzAtZDU2MWY5MDk5ODAwhKdjZWxsX2lk2SQ4ZWIxOGM3Zi1iYjRkLTRjZGMtOWUzMC1kNTYxZjkwOTk4MDCkY29kZdkpbWQiIiIKIyMgTWFya2Rvd24gbWF0aCBpbiBkZXNjcmlwdGlvbgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDQ5NTE2Mzc0LWY2MjUtNGE4NC1hYzVjLWY5MjQ5N2Q0NTAyNYSnY2VsbF9pZNkkNDk1MTYzNzQtZjYyNS00YTg0LWFjNWMtZjkyNDk3ZDQ1MDI1pGNvZGWzbWQiIiIKIyBATlRCb25kCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkNzA3MTc1YTktZDM1Ni00M2NmLTgwMzgtNjIwZWJjNDAxYzkzhKdjZWxsX2lk2SQ3MDcxNzVhOS1kMzU2LTQzY2YtODAzOC02MjBlYmM0MDFjOTOkY29kZblFeHRlbmRlZFRhYmxlT2ZDb250ZW50cygpqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQwOGQ3MTFjMC1lMmNjLTQ0NDQtOTRjYS0wYzRjM2NmZTkwMWaEp2NlbGxfaWTZJDA4ZDcxMWMwLWUyY2MtNDQ0NC05NGNhLTBjNGMzY2ZlOTAxZqRjb2Rlom50qG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SRlN2Q2NzY2Mi03N2IzLTQ4MmEtYjAzMi04ZGI0YWZiYzAxYTaEp2NlbGxfaWTZJGU3ZDY3NjYyLTc3YjMtNDgyYS1iMDMyLThkYjRhZmJjMDFhNqRjb2Rlo2FzZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkOTQ5YWMxZWYtYzUwMi00ZTI4LTgxZmYtZjk5YjBkMTlhYTAzhKdjZWxsX2lk2SQ5NDlhYzFlZi1jNTAyLTRlMjgtODFmZi1mOTliMGQxOWFhMDOkY29kZdmoQGZyb21wYWNrYWdlICIuLi8uLiIgYmVnaW4KCXVzaW5nIF4uU3RydWN0Qm9uZE1vZHVsZQoJdXNpbmcgXjogRXh0ZW5kZWRUYWJsZU9mQ29udGVudHMsIEVkaXRhYmxlLCBzaG93X291dHB1dF93aGVuX2hpZGRlbgoJdXNpbmcgPi5IeXBlcnRleHRMaXRlcmFsCgl1c2luZyA+LlBsdXRvVUkKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ5ZDIzMzgyYy1jZjM1LTRiMjAtYTQ2Yy0wZjRlMmRlMTdmYzeEp2NlbGxfaWTZJDlkMjMzODJjLWNmMzUtNGIyMC1hNDZjLTBmNGUyZGUxN2ZjN6Rjb2Rltm1kIiIiCiMgQEJvbmRzTGlzdAoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGUyYjc5YTU4LWU2NmUtNGQ0MC04NjczLTQxODgyMzc1M2IzOISnY2VsbF9pZNkkZTJiNzlhNTgtZTY2ZS00ZDQwLTg2NzMtNDE4ODIzNzUzYjM4pGNvZGWibnSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDk1OWFjYjQwLTFmZDYtNDNmNS1hMWE2LTczYTZjZWFhZTFkN4SnY2VsbF9pZNkkOTU5YWNiNDAtMWZkNi00M2Y1LWExYTYtNzNhNmNlYWFlMWQ3pGNvZGXaA1htZCIiIgpJbiBzb21lIGNhc2VzLCBvbmUgZG9lcyBub3Qgd2FudCB0byBoYXZlIGEgc2luZ2xlIGJvbmQgd3JhcHBpbmcgZWl0aGVyIGEgU3RydWN0dXJlIG9yIGEgTmFtZWRUdXBsZSBiZWNhdXNlIHNpbmdsZSBpbmRlcGVuZGVudCBib25kcyBhcmUgbW9yZSBjb252ZW5pZW50LgoKYEBCb25kc0xpc3RgIGlzIGEgY29udmVuaWVuY2UgbWFjcm8gdG8gY3JlYXRlIGFuIG9iamVjdCBvZiB0eXBlIGBCb25kc0xpc3RgIHdoaWNoIHNpbXBseSBhbGxvdyB0byBhZGQgYSBkZXNjcmlwdGlvbiB0byBzZXBhcmF0ZSBib25kcyBhbmQgZ3JvdXAgdGhlbSBhbGwgdG9nZXRoZXIgaW4gYSB0YWJsZS1saWtlIGZvcm1hdCBlcXVpdmFsZW50IHRvIHRob3NlIG9mIGBTdHJ1Y3RCb25kYC4KCiEhISBub3RlCglVbmxpa2UgYFN0cnVjdEJvbmRgLCBhIEJvbmRzTGlzdCBpcyBhbHJlYWR5IGNvbXBvc2VkIG9mIGJvbmQgY3JlYXRlZCB3aXRoIGBAYmluZGAgYW5kIGl0IGp1c3QgZ3JvdXBzIHRoZW0gdXAgd2l0aCBhIGRlc2NyaXB0aW9uLiBUaGUgb3V0cHV0IG9mIGBAQm9uZHNMaXN0YCBpcyBub3Qgc3VwcG9zZWQgdG8gYmUgYm91bmQgdG8gYSB2YXJpYWJsZSB1c2luZyBgQGJpbmRgLlwKCVRoZSBib25kcyBncm91cGVkIGluIGEgQm9uZHNMaXN0IHN0aWxsIGFjdCBhbmQgdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSBvbmUgYW5vdGhlci4KClNlZSB0aGUgZXhhbXBsZSBiZWxvdyBmb3IgdW5kZXJzdGFuZGluZyB0aGUgc3ludGhheC4gVGhlIGhlYWRlciBvZiBhIEJvbmRzTGlzdCBpcyBzaG93biBpbiBhbiBvcmFuZ2UgYmFja2dyb3VuZCB0byBlYXNpbHkgZGlmZmVyZW50aWF0ZSBpdCBmcm9tIGBTdHJ1Y3RCb25kYC4KIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQyMDczZjExZS04MTk2LTRlYmMtOTIyZi01ZmE1ODllOTE3OTeEp2NlbGxfaWTZJDIwNzNmMTFlLTgxOTYtNGViYy05MjJmLTVmYTU4OWU5MTc5N6Rjb2Rl2gE3bWQiIiIKVGhlIGFiaWxpdHkgdG8gYWxzbyB3cmFwIHByZS1leGlzdGluZyBib25kcyBhcm91bmQgU3RydWN0Qm9uZHMgaXMgY29udmVuaWVudCBmb3Igb3JnYW5pemluZyB0aGUgdmFyaW91cyBib25kcyBvbmUgaGF2ZSBpbiBhIGBCb25kc0xpc3RgIG9yIGBCb25kVGFibGVgCgpBcyBhbiBleGFtcGxlLCBvbmUgY2FuIGNyZWF0ZSBhIGBCb25kc0xpc3RgIGNvbnRhaW5pbmcgdGhlIHR3byBgU3RydWN0Qm9uZGAgYm9uZHMgZ2VuZXJhdGVkIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhpcyBub3RlYm9vayB3aXRoIHRoZSBmb2xsd2luZyBjb2RlLgoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDEzNGQ2MDMzLTJmMDgtNGY0OS05ODI5LTZhMDIzYjM2OGE3MISnY2VsbF9pZNkkMTM0ZDYwMzMtMmYwOC00ZjQ5LTk4MjktNmEwMjNiMzY4YTcwpGNvZGXaAgJtZCIiIgpBIHNpbWlsYXIgYXBwcm9hY2ggY2FuIGFsc28gYmUgYWNoaWV2ZWQgb24gYSBmaWVsZCBieSBmaWVsZCBiYXNpcyBieSB1c2luZyB0aGUgYEB0dmAgZGVjb3JhdG9yICh3aGljaCBpcyBub3QgYSBtYWNybyBwZXItc2UgYnV0IGlzIGRpcmVjdGx5IHByb2Nlc3NlZCBkdXJpbmcgdGhlIG1hY3JvIGV4cGFuc2lvbiBvZiBgQE5UQm9uZGApLgoKYEB0dmAgaXMgYSBzaG9ydGhhbmQgZm9yIHRyYW5zZm9ybWVkX3ZhbHVlIGFuZCBpdCBleHBlY3RzIHR3byBhcmd1bWVudHMgYWZ0ZXIgaXQsIHRoZSBmaXJzdCBiZWluZyB0aGUgZnVuY3Rpb24gdG8gcHJvY2VzcyB0aGUgdmFsdWUgcmV0dXJuZWQgYnkgdGhlIHdpZGdldCwgYW5kIHRoZSBzZWNvbmQgYmVpbmcgdGhlIHdpZGdldCBpdHNlbGYuCgpUaGlzIGNhbiBiZSB1c2VkIHRvIGJlIGEgYml0IGxlc3MgdmVyYm9zZSB3aGVuIG9uZSBpcyBpbnRlcmVzdGVkIGluIG9ubHkgdHJhbnNmb3JtaW5nIG9uZSBvZiBtYW55IGZpZWxkcyBhcyBiZWxvdzoKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ3MDVlMzBmZS03N2EzLTRiMDYtOGI5OS0xODA3MjkwZWRmZmKEp2NlbGxfaWTZJDcwNWUzMGZlLTc3YTMtNGIwNi04Yjk5LTE4MDcyOTBlZGZmYqRjb2Rlo2FsdKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMGRiNTFkMzktN2MwNS00ZTAwLWI5NTEtN2ZlNzc2YThlMGY5hKdjZWxsX2lk2SQwZGI1MWQzOS03YzA1LTRlMDAtYjk1MS03ZmU3NzZhOGUwZjmkY29kZdnHbnRfYm9uZCA9IEBiaW5kIG50IEBOVEJvbmQgIk15IEZhbmN5IE5UdXBsZSIgYmVnaW4KCWEgPSAoIkRlc2NyaXB0aW9uIiwgU2xpZGVyKDE6MTApKQoJYiA9IChtZCIqKkJvbGQqKiBmaWVsZCIsIFNsaWRlcigxOjEwKSkKCWMgPSBTbGlkZXIoMToxMCkgIyBObyBkZXNjcmlwdGlvbiwgZGVmYXVsdHMgdG8gdGhlIG5hbWUgb2YgdGhlIGZpZWxkCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNWJiMjJmMDctZmJlYS00NGFiLTk3ODMtOWNhMTZlMGRhMTFlhKdjZWxsX2lk2SQ1YmIyMmYwNy1mYmVhLTQ0YWItOTc4My05Y2ExNmUwZGExMWWkY29kZdkpbWQiIiIKIyMjIFRyYW5zZm9ybSBvbmx5IGEgZmV3IGZpZWxkcwoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGNiZmM2ZWVjLTg5OTEtNGE5Yy1hZGEwLTI5NWM4MDUyODU0ZISnY2VsbF9pZNkkY2JmYzZlZWMtODk5MS00YTljLWFkYTAtMjk1YzgwNTI4NTRkpGNvZGXZVCMgaHRtbCIiIgojIDxzdHlsZT4KIyBtYWluIHsKIyAJbWFyZ2luLXJpZ2h0OiAzNTBweCAhaW1wb3J0YW50OwojIH0KIyA8L3N0eWxlPgojICIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNGQ2MTE0MjUtYzhlMy00YmMzLTkxMmItOGJjMDQ2NTM2M2JjhKdjZWxsX2lk2SQ0ZDYxMTQyNS1jOGUzLTRiYzMtOTEyYi04YmMwNDY1MzYzYmOkY29kZdoBM2JsID0gQEJvbmRzTGlzdCAiTXkgR3JvdXAgb2YgQm9uZHMiIGxldCB0diA9IFBsdXRvVUkuRXhwZXJpbWVudGFsLnRyYW5zZm9ybWVkX3ZhbHVlCgkgIyBXZSB1c2UgdHJhbnNmb3JtZWRfdmFsdWUgdG8gdHJhbnNsYXRlIEdIeiB0byBIeiBpbiB0aGUgYm91bmQgdmFyaWFibGUgYGZyZXFgCgkiRnJlcXVlbmN5IFtHSHpdIiA9IEBiaW5kIGZyZXEgdHYoeCAtPiB4ICogMWU5LCBFZGl0YWJsZSgyMDsgc3VmZml4ID0gIiBHSHoiKSkKCW1kIkFsdGl0dWRlIGBgaGBgIFttXSIgPSBAYmluZCBhbHQgU2NydWJiYWJsZSgxMDA6MTA6MjAwKQplbmSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJGJlMmE3ODIwLWUxOTQtNDQxMC1iMDBkLWE5MzMyYjIzNGFkNoSnY2VsbF9pZNkkYmUyYTc4MjAtZTE5NC00NDEwLWIwMGQtYTkzMzJiMjM0YWQ2pGNvZGWjYWx0qG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ0NjY5OTVhMi1kZmQ0LTQzNzQtODMzOS1iYzAyMzIwMzliMjeEp2NlbGxfaWTZJDQ2Njk5NWEyLWRmZDQtNDM3NC04MzM5LWJjMDIzMjAzOWIyN6Rjb2Rlvm1kIiIiCiMjIHRyYW5zZm9ybWVkX3ZhbHVlCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkMjc5Nzc1MjYtNzVkYy00NGMzLTk5NzYtYzIyZThjYmQ5NGRhhKdjZWxsX2lk2SQyNzk3NzUyNi03NWRjLTQ0YzMtOTk3Ni1jMjJlOGNiZDk0ZGGkY29kZadhdGFudmFsqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SRjNDNjOGE2NS0zZjk0LTQ1ZjktYjYzMy03MWNhZGUwOWI2NjaEp2NlbGxfaWTZJGM0M2M4YTY1LTNmOTQtNDVmOS1iNjMzLTcxY2FkZTA5YjY2NqRjb2Rl2gE5bWQiIiIKV2hlbiBwcm92aWRpbmcgYSBkZXNjcmlwdGlvbiB0aGF0IGlzIG5vdCBhIHN0cmluZywgYnkgZGVmYXVsdCB0aGUgZGVzY3JpcHRpb24gZmllbGQgaW5zaWRlIG9mIHRoZSByZXN1bHRpbmcgYFN0cnVjdEJvbmRgIGlzIHNldCB0byBgIk5vIFN0cmluZyBEZXNjcmlwdGlvbiBQcm92aWRlZCJgLgoKSWYgZm9yIHNvbWUgcmVhc29uIG9uZSB3YW50cyB0byBjdXN0b21pemUgdGhlIHN0cmluZyBkZXNjcmlwdGlvbiwgYSB0dXBsZSB3aXRoIGAoc3RyaW5nX2Rlc2NyaXB0aW9uLCBodG1sX2Rlc2NyaXB0aW9uKWAgY2FuIGJlIHByb3ZpZGVkCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkMDJlNTgwMTItNWFmNi00YjkxLWE5YTQtMDljOWRjMDM4ZjExhKdjZWxsX2lk2SQwMmU1ODAxMi01YWY2LTRiOTEtYTlhNC0wOWM5ZGMwMzhmMTGkY29kZdoCAkBiaW5kIHRyYW5zZm9ybV9zaW5nbGVfZmllbGQgQE5UQm9uZCAiRmllbGQgTGV2ZWwgVHJhbnNmb3JtZWQgVmFsdWUiIGJlZ2luCglhID0gKCJBbmdsZSBbwrBdIiwgQHR2IGRlZzJyYWQgU2xpZGVyKDA6OTA7IGRlZmF1bHQgPSA2MCwgc2hvd192YWx1ZT10cnVlKSkgIyBUaGlzIHRyYW5zZm9ybXMgdGhlIGFuZ2xlIGludG8gcmFkaWFucwoJYiA9IEB0diB4IC0+IHggKyAzIHNpbXBsZV9zbGlkZXIgIyBZb3UgY2FuIGVpdGhlciB1c2UgdGhlIGZ1bGwgYW5vbnltb3VzIGZ1bmN0aW9uIHN5bnRoYXgsIG9yIHRoZSBjb252ZW5pZW5jZSBmb3JtIHdoZXJlIF8gaXMgYXV0b21hdGljYWxseSBpbnRlcnByZXRlZCBhcyB0aGUgdmFyaWFibGUgb2YgdGhlIGFub255bW91cyBmdW5jdGlvbiBsaWtlIGJlbG93CgljID0gQHR2IF9eMiBTbGlkZXIoMToxMDsgZGVmYXVsdCA9IDMpICMgRmlyc3QgYXJndW1lbnQgdHJhbnNmb3JtZWQgdG8gdGhlIGFub24gZnVuYyB4IC0+IHheMgoJZCA9IFNsaWRlcigxOjEwKQplbmSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDU2NDk2OGZlLTBhNjgtNDhiYy05ZTExLWM3NzMyZTJiYWUwNISnY2VsbF9pZNkkNTY0OTY4ZmUtMGE2OC00OGJjLTllMTEtYzc3MzJlMmJhZTA0pGNvZGXZJHR1cGxlX2Rlc2NyaXB0aW9uX250Ym9uZC5kZXNjcmlwdGlvbqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMzZmYWYxOGMtMTFjMy00MDEyLWE5OTYtNTVjN2NkYWU3MWE4hKdjZWxsX2lk2SQzNmZhZjE4Yy0xMWMzLTQwMTItYTk5Ni01NWM3Y2RhZTcxYTikY29kZdoBFm1hdGhfbnRib25kID0gQGJpbmQgYXRhbnZhbCBATlRCb25kIG1kIlRoaXMgaXMgbWF0aCE6IGBgXDthdGFuKHgseSkgKyAzYGAiIGJlZ2luCgl4ID0gKG1kImBgeGBgIiwgU2xpZGVyKDE6MTA7IHNob3dfdmFsdWU9dHJ1ZSkpCgl5ID0gKG1kImBgeWBgIiwgU2xpZGVyKDE6MTA7IHNob3dfdmFsdWU9dHJ1ZSkpCmVuZCBtYXJrZG93bl9mdW5jdGlvbiAjIFdlIGNhbiBhbHNvIGRpcmVjdGx5IHVzZSBmdW5jdGlvbnMgaW4gdGhlIGNhbGxlciBzY29wZSB0byB0cmFuc2Zvcm0gdGhlIHZhbHVlqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ3ODUzY2M3Zi00ZTU4LTQ0ZDEtOGQzYi1mOGQ0NzQ1NTY0ZTaEp2NlbGxfaWTZJDc4NTNjYzdmLTRlNTgtNDRkMS04ZDNiLWY4ZDQ3NDU1NjRlNqRjb2Rlo3Nic6htZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkY2RjMGE3YWQtYTNhYy00MjcwLWI3MDctMzViMTkzOWRhMjc2hKdjZWxsX2lk2SRjZGMwYTdhZC1hM2FjLTQyNzAtYjcwNy0zNWIxOTM5ZGEyNzakY29kZaNhc2SobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDc4NTU4MjZlLWNjYWEtNGMyNy1hMDYwLWY1Y2ViOTI3YmJlOISnY2VsbF9pZNkkNzg1NTgyNmUtY2NhYS00YzI3LWEwNjAtZjVjZWI5MjdiYmU4pGNvZGXZ+0BiaW5kIHRyYW5zZm9ybWVkX3ZhbHVlX2V4YW1wbGUgQE5UQm9uZCBtZCJUcmFuc2Zvcm1lZCEiIGJlZ2luCglhID0gU2xpZGVyKDE6MTApCgliID0gU2xpZGVyKDE6MTApCmVuZCBfLmEgKyBfLmIgIyBUaGlzIGZ1bmN0aW9uIGlzIHJlcGxhY2VkIHdpdGhpbiB0aGUgbWFjcm8gdG8gYmUgYG50IC0+IG50LmEgKyBudC5iYCwgd2hpY2ggY291bGQgaGF2ZSBhbHNvIGJlZW4gcHJvdmlkZWQgYXMgYW5vbnltb3VzIGZ1bmN0aW9uIGRpcmVjdGx5qG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SRmNjViMzIzMS1mMmIyLTQ1ZGMtYjcyZS0xYWQzMTA3MDgzZmOEp2NlbGxfaWTZJGY2NWIzMjMxLWYyYjItNDVkYy1iNzJlLTFhZDMxMDcwODNmY6Rjb2RlvG1kIiIiCiMgU3RydWN0Qm9uZFNlbGVjdAoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJDkwM2ZlZTY3LTZiMjMtNDFkYy1hMDNkLWYxMDQwYjY5NmJlNoSnY2VsbF9pZNkkOTAzZmVlNjctNmIyMy00MWRjLWEwM2QtZjEwNDBiNjk2YmU2pGNvZGXZYkJvbmRUYWJsZShbCglhc2RfYm9uZCwKCW50X2JvbmQsCglibCwKCWJsYwpdOyBkZXNjcmlwdGlvbiA9ICJNeSBCb25kcyIpIHw+IHNob3dfb3V0cHV0X3doZW5faGlkZGVuqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ5ZTM2MDFmNS1lZmMyLTQ0ZTktODNkOC01YjY1Y2U3ZTljY2aEp2NlbGxfaWTZJDllMzYwMWY1LWVmYzItNDRlOS04M2Q4LTViNjVjZTdlOWNjZqRjb2Rl2gLjYmVnaW4KIiIiCglzdHJ1Y3QgQVNECiIiIgpCYXNlLkBrd2RlZiBzdHJ1Y3QgQVNECglhOjpJbnQgCgliOjpJbnQKCWM6OlN0cmluZwoJIlRoaXMgZmllbGQgaXMgX3NwZWNpYWxfIgoJZDo6U3RyaW5nCgllOjpJbnQKZW5kCkB0eXBlYXNmaWVsZCBTdHJpbmcgPSBUZXh0RmllbGQoKSAjIFN0cmluZyBmaWVsZHMgd2l0aCBubyBzdHJ1Y3Qtc3BlY2lmaWMgZGVmYXVsdCB3aWxsIHVzZSB0aGlzIApAZmllbGRkYXRhIEFTRCBiZWdpbgoJYSA9IChtZCJNYXJrZG93biBkZXNjcmlwdGlvbiwgaW5jbHVkaW5nIGBgTGFUZVhgYCIsIFNsaWRlcigxOjEwKSkKCWIgPSAoQGh0bCgiPHNwYW4+RmllbGQgd2l0aCA8Yj5IVE1MPC9iPiBkZXNjcmlwdGlvbjwvc3Bhbj4iKSwgU2NydWJiYWJsZSgxOjEwKSkKCWMgPSAoIk5vcm1hbCBTdHJpbmcgRGVzY3JpcHRpb24iLCBUZXh0RmllbGQoKSkKCSMgZCBoYXMgbm8gQVNELXNwZWNpZmljIGN1c3RvbSBib25kLCBzbyBpdCB3aWxsIHVzZSB0aGUgZmllbGQgZG9jc3RyaW5nIGFzIGRlc2NyaXB0aW9uIGFuZCB0aGUgZGVmYXVsdCBTdHJpbmcgd2lkZ2V0IGFzIHdpZGdldAoJZSA9IFNsaWRlcigyMDoyNSkgIyBObyBkZXNjcmlwdGlvbiwgZGVmYXVsdHMgdG8gdGhlIGZpZWxkbmFtZSBhcyBubyBkb2NzdHJpbmcgaXMgcHJlc2VudAplbmQKYXNkX2JvbmQgPSBAYmluZCBhc2QgU3RydWN0Qm9uZChBU0Q7IGRlc2NyaXB0aW9uID0gIkN1c3RvbSBEZXNjcmlwdGlvbiIpCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMDNlOWQ3NWUtZTZjOS00MTk5LTkzM2ItMmJlMzA2ZGFmOTc4hKdjZWxsX2lk2SQwM2U5ZDc1ZS1lNmM5LTQxOTktOTMzYi0yYmUzMDZkYWY5NzikY29kZaNhc2SobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDA2NWJhZDczLTVmYTgtNDQ5Ni1iYTMzLTllNjY5NDBiNTgwNoSnY2VsbF9pZNkkMDY1YmFkNzMtNWZhOC00NDk2LWJhMzMtOWU2Njk0MGI1ODA2pGNvZGWnbG9sX3BvcKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkMjZkMTE2MDAtMjgyNy00ZTA4LTkxOTUtMTA5YzhhOGJkZGMzhKdjZWxsX2lk2SQyNmQxMTYwMC0yODI3LTRlMDgtOTE5NS0xMDljOGE4YmRkYzOkY29kZaRmcmVxqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SRhODk5NTIyNC04M2M2LTRmODItYjVhNS04N2E2Zjg2ZmM3YTCEp2NlbGxfaWTZJGE4OTk1MjI0LTgzYzYtNGY4Mi1iNWE1LTg3YTZmODZmYzdhMKRjb2Rl2gGKbWQiIiIKR2VuZXJhdGluZyBhdXRvbWF0aWMgd2lkZ2V0cyBmb3IgY3VzdG9tIHN0cnVjdHMgaXMgcXVpdGUgc3RyYWlnaHRmb3J3YXJkIHdpdGggdGhlIGFpZCBvZiB0aGUgYEBmaWVsZGRhdGFgIG1hY3JvIGFuZCB0aGUgYFN0cnVjdEJvbmRgIHR5cGUuCgpUaGUgdG9wLWxlZnQgYXJyb3cgY2FuIGJlIHVzZWQgdG8gc2hvdy1oaWRlIHRoZSBmaWVsZCBlbGVtZW50cyAodXNlZnVsIGluc2lkZSBhIGBCb25kVGFibGVgLCBzaG93biBiZWxvdyksIHdoaWxlIHRoZSBncmVlbiB0b2dnbGUgb24gdGhlIHRvcC1yaWdodCBjYW4gYmUgdXNlZCB0byBkaXNhYmxlIHRlbXBvcmFyaWx5IHRoZSBzeW5jaCBiZXR3ZWVuIHRoZSBKUyB3aWRnZXRzIGFuZCB0aGUgYm9uZCB2YWx1ZXMgaW4gUGx1dG8uCiIiIqhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkw9kkY2Y4MDdjYjMtNWQ3NS00MDQwLWJmZDEtMDVmZTcwZDI2ZTg5hKdjZWxsX2lk2SRjZjgwN2NiMy01ZDc1LTQwNDAtYmZkMS0wNWZlNzBkMjZlODmkY29kZdl5dHVwbGVfZGVzY3JpcHRpb25fbnRib25kID0gQE5UQm9uZCAoIlBsYWluIGRlc2NyaXB0aW9uIiwgaHRtbCI8c3Bhbj5IVE1MIERlc2NyaXB0aW9uPC9zcGFuPiIpIGJlZ2luCglhID0gU2xpZGVyKDE6MTApCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkZmU4OTFiNGUtZjQ0MC00ODIzLWI0M2ItNzI1NzJmNmE2YzEyhKdjZWxsX2lk2SRmZTg5MWI0ZS1mNDQwLTQ4MjMtYjQzYi03MjU3MmY2YTZjMTKkY29kZdkhbWQiIiIKIyMgRGVmYXVsdCBUeXBlIFdpZGdldHMKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ5ZDQ0NTVhZi05NmYxLTQ2ZDctYTRmMy00MzQ0OTViMTFjOGGEp2NlbGxfaWTZJDlkNDQ1NWFmLTk2ZjEtNDZkNy1hNGYzLTQzNDQ5NWIxMWM4YaRjb2RltG1kIiIiCiMgUGFja2FnZXMKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ3OWJlYmE4OC05MzJmLTQxNDctYjNhMC1kODIxZWYxYmMxZTKEp2NlbGxfaWTZJDc5YmViYTg4LTkzMmYtNDE0Ny1iM2EwLWQ4MjFlZjFiYzFlMqRjb2Rl2gMzbWQiIiIKVGhlIHN0cnVjdHVyZXMgYWJvdmUgY2FuIGFsc28gYmUgdXNlZCBuZXN0ZWQgd2l0aGluIG9uZSBhbm90aGVyLiBUbyBmYWNpbGl0YXRlIGFjY2Vzc2luZyBuZXN0ZWQgc3RydWN0dXJlcywgb25lIGNhbiB1c2UgdGhlIGBQb3BvdXRgIHR5cGUuCgpJbiBpdHMgc2ltcGxlIGZvcm0sIHlvdSBjYW4gZ2l2ZSBhbiBpbnN0YW5jZSBvZiBhIFN0cnVjdEJvbmQsIGEgYm9uZCB3cmFwcGluZyBhIFN0cnVjdEJvbmQgb3IgYSBCb25kc0xpc3QgYXMgaW5wdXQgdG8gUG9wb3V0IHRvIGNyZWF0ZSBhIHRhYmxlIHRoYXQgaXMgaGlkZGVuIGJlaGluZCBhIHBvcHVwIHdpbmRvdy4KSWYgYW4gaW5zdGFuY2UgcHJlc2VudCwgYnV0IHlvdSB3YW50IGEgY3VzdG9tIHR5cGUgZm9yIHdoaWNoIHlvdSBoYXZlIGRlZmluZWQgY3VzdG9tIGJvbmRzIGFuZCBkZXNjcmlwdGlvbnMgd2l0aCBgQGZpZWxkZGF0YWAgdG8gYXBwZWFyIGFzIHBvcG91dCwgeW91IGNhbiB1c2UgdGhlIGZ1bmN0aW9uIGBwb3BvdXR3cmFwKFRZUEUpYCB0byBnZW5lcmF0ZSBhIHNtYWxsIGljb24gd2hpY2ggaGlkZXMgYSBwb3B1cCBjb250YWluaW5nIHRoZSBgU3RydWN0Qm9uZGAgb2YgdGhlIHByb3ZpZGVkIHR5cGUgYFRZUEVgLgoKVGhlIFN0cnVjdEJvbmQgdGFibGUgYXBwZWFycyBvbiBob3ZlciB1cG9uIHRoZSBpY29uLCBjYW4gYmUgbWFkZSBmaXhlZCBieSBjbGlja2luZyBvbiB0aGUgaWNvbiBhbmQgY2FuIHRoZW4gYmUgbW92ZWQgYXJvdW5kIG9yIHJlc2l6ZWQuCkEgZG91YmxlIGNsaWNrIG9uIHRoZSBoZWFkZXIgb2YgdGhlIHBvcG91dCBoaWRlcyBpdCBhZ2FpbjoKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ4ZGI4MmU5NC01YzgxLTRjNTItOTIyOC03ZTIyMzk1ZmI2OGaEp2NlbGxfaWTZJDhkYjgyZTk0LTVjODEtNGM1Mi05MjI4LTdlMjIzOTVmYjY4ZqRjb2Rl2TNiZWdpbgoJdXNpbmcgUGx1dG9EZXZNYWNyb3MKCXVzaW5nIExhVGVYU3RyaW5ncwplbmSobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDg2YTgwMjI4LWY0OTUtNDNlOC1iMWQ0LWM5M2I3YjUyYzhkOISnY2VsbF9pZNkkODZhODAyMjgtZjQ5NS00M2U4LWIxZDQtYzkzYjdiNTJjOGQ4pGNvZGXaATxiZWdpbgoJQGt3ZGVmIHN0cnVjdCBNQUgKCQlhOjpJbnQKCWVuZAoJQGt3ZGVmIHN0cnVjdCBCT0gKCQltYWg6Ok1BSAoJZW5kCgkKCSMgVGhpcyB3aWxsIG1ha2UgdGhlIGRlZmF1bHQgd2lkZ2V0IGZvciBhbiBJbnQgYSBTbGlkZXIKCUB0eXBlYXNmaWVsZCBJbnQgPSBTbGlkZXIoMToxMCkKCSMgVGhpcyB3aWxsIG1ha2UgdGhlIGRlZmF1bHQgd2lkZ2V0IGZvciBmaWVsZHMgb2YgdHlwZSBBU0QgYSBwb3BvdXQgdGhhdCB3cmFwcyBhIFN0cnVjdEJvbmR7QVNEfQoJQHBvcG91dGFzZmllbGQgTUFICgkKCUBiaW5kIGJvaCBTdHJ1Y3RCb25kKEJPSCkKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQxZDU1NzNlZS04NzJlLTRkZmItYTc4NS0xYWM5ZTgzNmFkOTiEp2NlbGxfaWTZJDFkNTU3M2VlLTg3MmUtNGRmYi1hNzg1LTFhYzllODM2YWQ5OKRjb2RluXRyYW5zZm9ybWVkX3ZhbHVlX2V4YW1wbGWobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMLZJDNhMDY2YmY0LTM0NjYtNDY5ZS05MGQwLTZiMTRiZTNlZDhkNYSnY2VsbF9pZNkkM2EwNjZiZjQtMzQ2Ni00NjllLTkwZDAtNmIxNGJlM2VkOGQ1pGNvZGW1bWQiIiIKIyBCb25kVGFibGUKIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTD2SQ4MTFjZjc4Yi1lODcwLTQ1YmItOTE3My04OWEzYjNkNDk1ZjWEp2NlbGxfaWTZJDgxMWNmNzhiLWU4NzAtNDViYi05MTczLTg5YTNiM2Q0OTVmNaRjb2Rl2ZhibGMgPSBAQm9uZHNMaXN0ICJQb3BvdXQgQ29udGFpbmVyIiBiZWdpbgoJIlN0cnVjdHVyZSBBU0QiID0gUG9wb3V0KGFzZF9ib25kKQoJIk5hbWVkVHVwbGUiID0gUG9wb3V0KG50X2JvbmQpCgkiU3RydWN0Qm9uZFNlbGVjdCIgPSBQb3BvdXQoc2JzX2JvbmQpCmVuZKhtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNjNkNmMyZGYtYTQxMS00MDdjLWFmMTEtNGY1ZDA5ZmJiMzIyhKdjZWxsX2lk2SQ2M2Q2YzJkZi1hNDExLTQwN2MtYWYxMS00ZjVkMDlmYmIzMjKkY29kZdmlYmVnaW4KQmFzZS5Aa3dkZWYgc3RydWN0IExPTAoJYTo6SW50IAoJYjo6SW50CmVuZApAZmllbGRkYXRhIExPTCBiZWdpbgoJYSA9IChtZCJXb25kZXIhIiwgU2xpZGVyKDE6MTApKQoJYiA9IChAaHRsKCI8c3Bhbj5GaWVsZCBCPC9zcGFuPiIpLCBTY3J1YmJhYmxlKDE6MTApKQplbmQKZW5kqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTC2SQ0ODQzOTgzYy1kZjY0LTRiOTQtODYzNC03YTEwZDk0MjNhNzCEp2NlbGxfaWTZJDQ4NDM5ODNjLWRmNjQtNGI5NC04NjM0LTdhMTBkOTQyM2E3MKRjb2Rltm1kIiIiCiMgU3RydWN0Qm9uZAoiIiKobWV0YWRhdGGDqXNob3dfbG9nc8OoZGlzYWJsZWTCrnNraXBfYXNfc2NyaXB0wqtjb2RlX2ZvbGRlZMPZJGE1NDkwYTZiLWRjMTEtNDJiNy04N2UwLWQzODg3MGZjNTVlNISnY2VsbF9pZNkkYTU0OTBhNmItZGMxMS00MmI3LTg3ZTAtZDM4ODcwZmM1NWU0pGNvZGWkZnJlcahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNTQzOGU5ZTctYzBmNy00NTIzLTg2ODItZmZiODIyMzU5ZDUwhKdjZWxsX2lk2SQ1NDM4ZTllNy1jMGY3LTQ1MjMtODY4Mi1mZmI4MjIzNTlkNTCkY29kZb1zaW1wbGVfc2xpZGVyID0gU2xpZGVyKDE6MTApO6htZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkYmIwNGFjMTItMjBhMC00NjdhLWFmMWEtYzI5ODMwMWU0ODM4hKdjZWxsX2lk2SRiYjA0YWMxMi0yMGEwLTQ2N2EtYWYxYS1jMjk4MzAxZTQ4MzikY29kZdkubWFya2Rvd25fZnVuY3Rpb24gPSBudCAtPiBhdGFuKG50LngsIG50LnkpICsgM6htZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkNjMzMDI5YWYtOGNhYy00MjZlLWIzNWMtYzlmYjM5MzhiNzg0hKdjZWxsX2lk2SQ2MzMwMjlhZi04Y2FjLTQyNmUtYjM1Yy1jOWZiMzkzOGI3ODSkY29kZb1AYmluZCBsb2xfcG9wIHBvcG91dHdyYXAoTE9MKahtZXRhZGF0YYOpc2hvd19sb2dzw6hkaXNhYmxlZMKuc2tpcF9hc19zY3JpcHTCq2NvZGVfZm9sZGVkwtkkZGEzYWUzNDgtMDgzZC00YTdkLWFhYmQtZDBiYzI1YjNjYTE3hKdjZWxsX2lk2SRkYTNhZTM0OC0wODNkLTRhN2QtYWFiZC1kMGJjMjViM2NhMTekY29kZdkkbWQiIiIKIyMgQ3VzdG9tIEhUTUwgZGVzY3JpcHRpb24KIiIiqG1ldGFkYXRhg6lzaG93X2xvZ3PDqGRpc2FibGVkwq5za2lwX2FzX3NjcmlwdMKrY29kZV9mb2xkZWTDq25vdGVib29rX2lk2SQxYjNhZTJiZS05YWE0LTExZjAtYmZmMS01ZGMzZmMwM2Y0NzKraW5fdGVtcF9kaXLCqG1ldGFkYXRhgaxjdXN0b21fYXR0cnORrGhpZGUtZW5hYmxlZA==";
window.pluto_preamble_html = undefined;
window.pluto_recording_url = undefined;
window.pluto_recording_audio_url = undefined;
</script>

<meta name="pluto-insertion-spot-parameters">
<script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/editor.2df7c5ec.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/index.11569726.js"></script><link rel="pluto-external-source" id="MathJax-script" href="https://cdn.jsdelivr.net/gh/fonsp/Pluto.jl@0.20.17/frontend-dist/tex-svg-full.f72d1ae1.js" type="text/javascript">
<meta name="pluto-insertion-spot-preload">
</head><body class="no-MŒ±Œ∏Jax"> <div style="min-height:100vh;display:flex"> <pluto-editor class="fullscreen loading" translate="no"> <progress style="filter:grayscale()" class="delete-me-when-live statefile-fetch-progress" max="100"></progress> </pluto-editor> </div> </body></html>